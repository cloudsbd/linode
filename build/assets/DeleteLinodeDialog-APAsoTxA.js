import{r as u,aW as H,dp as dt,dq as Vt,j as e,T as R,a1 as W,J as Ut,ad as G,cQ as De,s as D,aa as ct,B as q,ba as re,dr as le,cx as ee,c as te,ds as qt,dt as Nt,du as Wt,dv as Ht,ao as ie,dw as Gt,dx as Qt,q as ge,dy as Yt,dz as _e,dA as Kt,bH as me,f as X,c3 as Y,dB as Xt,dC as Jt,ap as ut,dD as Zt,dE as ne,ag as he,G as V,c4 as Re,b9 as Pe,an as fe,$ as Ee,dF as pt,ab as gt,dG as en,cW as tn,dH as nn,dI as sn,dJ as an,bp as Ae,bI as mt,cH as on,af as rn,dK as ln,b8 as dn,dL as cn,ca as un,bj as pn,E as Ue,cb as gn,cP as mn,d0 as qe,aq as Ne,dM as hn,dN as fn,cS as We,dO as ht,bt as He,V as we,dP as ft,c1 as de,a8 as xt,a9 as bt,av as Be,b0 as xn,a4 as bn,C as yn,m as jn,da as Le,dQ as yt,dR as jt,dS as St,dT as Sn,W as ue,cn as Ge,dh as vn,dU as kn,dV as wn,dW as Ln,bm as Cn,bn as Tn,dX as In}from"./index-Eksrs3uK.js";import{r as Ce,I as vt,U as Dn,S as _n,a as Rn,b as Pn,c as En,L as kt}from"./LinodeActionMenu-bV6ckFLX.js";import{u as Me}from"./disks-ZTjtBBb6.js";import{g as An,R as Bn,a as Mn}from"./RegionSelect-_Z8IGlox.js";import{s as ae}from"./scrollErrorIntoView-6n4Cku1Y.js";import{a as zn}from"./LinodeDisks-jJddYOGd.js";import{F as Fn}from"./Flag-kVTQNGw3.js";import{g as On}from"./backups-brLSog0e.js";import{P as $n}from"./constants-KokzTiEs.js";import{i as Vn,g as Qe}from"./linodes-orSDvVk7.js";import{D as xe}from"./DisplayPrice-SNYRHKEX.js";import{L as ze}from"./LinodePermissionsError-htxzmi5m.js";import{F as wt,u as Un}from"./formik.esm-Kap5lsIh.js";import{A as Lt}from"./AccessPanel-rD0WgXZZ.js";import{T as Fe}from"./TypeToConfirm-koQ3u5up.js";import{h as Ct,a as Tt}from"./formikErrorUtils-jhqfCjwU.js";import{e as It}from"./validatePassword-C5jRG3TY.js";import{a as qn,b as Nn}from"./assocPath-nNkv7F8U.js";import{f as Wn}from"./image.helpers-5SOq-oMg.js";import{l as Dt}from"./lishUtils-OjFanRCH.js";import{u as Hn}from"./firewalls-zJDfBkPC.js";import{D as Gn,c as Qn}from"./DeviceSelection-JvpNAIro.js";import{P as Yn}from"./PlansPanel-EH5ViSTx.js";import{g as Kn}from"./linodes--kIa80QO.js";import{F as Xn}from"./FormControl-CNHz4Ctl.js";import{R as Ye}from"./Radio-HudVgwMW.js";import{R as Jn}from"./RadioGroup-zpRjMzXK.js";import{D as Zn}from"./Drawer-A9yKjC3Z.js";import{T as es,S as ts}from"./TagsPanel-CYEBNrGy.js";import{p as ns,g as ss,E as as,a as is}from"./utils-x4yn563A.js";import{u as os,a as rs}from"./tags-kBUFHmv1.js";import{C as ls}from"./CopyTooltip-mIyzAQ7E.js";import{c as ds,a as K,T as cs}from"./TableRow-phXfWUGW.js";import{P as us}from"./PublicIpsUnassignedTooltip-A07mEsGp.js";import{S as Te,a as ps,b as gs,c as ms,d as hs,e as fs,f as xs,g as bs,h as ys,i as js,j as Ss,k as be,l as J,m as Z,s as _t,n as Ke,o as Xe,u as vs,p as ks,q as ws}from"./LinodeIPAddresses-BzUB11OC.js";import{D as Ls}from"./DateTimeDisplay-bXC9mIcz.js";import{S as Je}from"./StatusIcon-RuV8PvAV.js";import{u as Rt}from"./recentEventForLinode-oZMi36YZ.js";import{I as Cs}from"./IPAddress-ZmG9OcMn.js";import{R as Ts}from"./RegionIndicator-N3gnZFRh.js";import{V as Is}from"./constants-jI3mcPVd.js";import{T as Ds}from"./TypeToConfirmDialog-9yjZCCL0.js";import{u as _s}from"./configs-3PoBJaCX.js";import{v as ye,s as Rs}from"./vpcs-qp5yIH1u.js";const Ps=u.memo(t=>{var o;const n=H(),{data:i}=dt(t.linodeId??-1,{page_size:Vt},{},t.linodeId!==void 0),s=(i==null?void 0:i.results)??0;return e.jsxs(Es,{children:[e.jsx(R,{sx:{marginLeft:n.spacing(2),marginTop:n.spacing(2)},children:e.jsx("strong",{children:"Caution:"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"You’ll be assigned new IPv4 and IPv6 addresses, which will be accessible once your migration is complete."}),e.jsx("li",{children:"Any existing backups with the Linode Backup Service will not be migrated. Once your migration is complete, your backups will start over on their existing schedule."}),e.jsxs("li",{children:["Any DNS records (including Reverse DNS) will need to be updated. You can use the ",e.jsx(W,{to:"/domains",children:"DNS Manager"})," or"," ",e.jsx(W,{to:"https://linode.com/docs/networking/dns/configure-your-linode-for-reverse-dns/",children:"Configure Your Linode for Reverse DNS (rDNS)."})]}),e.jsxs("li",{children:["Any attached VLANs will be inaccessible if the destination region does not support VLANs."," ",e.jsx(W,{to:"https://linode.com/docs/products/networking/vlans/",children:"Check VLAN region compatibility."})]}),e.jsx("li",{children:"Your Linode will be powered off."}),e.jsxs("li",{children:["Block Storage can’t be migrated to other regions."," ",s>0&&e.jsxs(u.Fragment,{children:["The following",s>1?" volumes":" volume"," will be detached from this Linode:",e.jsx(As,{children:i==null?void 0:i.data.map(r=>e.jsx("li",{children:r.label},r.id))})]})]}),e.jsxs("li",{children:["When this migration begins, we estimate it will take approximately"," ",(o=Ut.local().plus({minutes:t.migrationTimeInMins}).toRelative())==null?void 0:o.replace("in","")," ","to complete."]}),t.metadataWarning?e.jsx("li",{children:t.metadataWarning}):null]}),t.error&&e.jsx(G,{text:t.error,variant:"error"}),e.jsx(De,{sx:{marginLeft:n.spacing(2)},checked:t.hasConfirmed,onChange:()=>t.setConfirmed(!t.hasConfirmed),text:"Accept"})]})}),Es=D("div",{label:"StyledRootDiv"})(({theme:t})=>({"& ul:first-of-type":{"& li":{fontSize:"0.875rem",marginBottom:t.spacing()},fontFamily:t.font.normal},backgroundColor:t.bg.bgPaper,borderLeft:`5px solid ${t.palette.warning.dark}`,marginBottom:t.spacing(2),marginTop:24,padding:`${t.spacing(.5)} ${t.spacing(2)}`})),As=D("ul",{label:"StyledVolumeUl"})(({theme:t})=>({"& li":{fontFamily:t.font.bold},marginTop:t.spacing()})),Bs=D(ct,{label:"StyledPaper"})(({theme:t})=>({"& > p:first-of-type":{color:t.color.label,fontFamily:t.font.bold,marginBottom:t.spacing(),marginTop:t.spacing(2)},marginTop:t.spacing(4),padding:0})),Ms=D("div",{label:"StyledDiv"})(({theme:t})=>({alignItems:"center",display:"flex",flexDirection:"row",gap:t.spacing(),marginBottom:t.spacing(2)})),Pt=D("span",{label:"StyledSpan"})(({theme:t})=>({color:t.color.label,display:"block",fontFamily:t.font.bold,fontSize:t.typography.body1.fontSize,lineHeight:"1.43rem",marginBottom:t.spacing(1),marginTop:t.spacing(2)})),zs=D(q,{label:"StyledMigrationContainer"})(({theme:t})=>({[t.breakpoints.up("md")]:{display:"flex",justifyContent:"space-between"}})),Ze=D(q,{label:"StyledMigrationBox"})(({theme:t})=>({[t.breakpoints.up("md")]:{width:"50%"},width:"100%"})),et=t=>{const{backups:n,hourly:i,monthly:s,panelType:o}=t,r=o==="current",a=H(),l=`${a.typography.body1.fontSize}`;return s&&i&&n?e.jsxs(Fs,{panelType:o,children:[e.jsxs(Pt,{children:[r?"Current":"New"," Price"]}),e.jsxs(q,{alignItems:"baseline","data-testid":`${o}-price-panel`,display:"inline-flex",children:[e.jsx(xe,{fontSize:l,interval:"month",price:s}),", ",e.jsx(xe,{decimalPlaces:3,fontSize:l,interval:"hour",price:i}),n!=="disabled"&&(n==null?void 0:n.monthly)&&e.jsxs(e.Fragment,{children:[" ",e.jsx(R,{fontFamily:a.font.bold,fontSize:l,children:"| Backups "}),e.jsx(xe,{fontSize:l,interval:"month",price:n.monthly})]})]})]}):null},Fs=D(q,{label:"MigrationPricingContainer",shouldForwardProp:t=>t!=="panelType"})(({panelType:t,theme:n})=>({marginBottom:n.spacing(2),...t==="current"&&{[n.breakpoints.up("md")]:{marginTop:24}}})),Os=u.memo(t=>{var j;const{backupEnabled:n,currentRegion:i,errorText:s,handleSelectRegion:o,helperText:r,linodeType:a,selectedRegion:l}=t,{data:d}=re(),{data:c}=le(a||"",!!a),m=d==null?void 0:d.find(y=>y.id===i),g=((j=d==null?void 0:d.find(y=>y.id==i))==null?void 0:j.country)??"us",h=!!(l&&Vn({regionA:i,regionB:l,type:c})),f=Qe(c,i),S=Qe(c,l),b=u.useCallback((y,p,w)=>({backups:(v=>c&&n?On(c,v):"disabled")(y),hourly:p==null?void 0:p.hourly,monthly:p==null?void 0:p.monthly,panelType:w}),[n,c]);return e.jsxs(Bs,{children:[e.jsx(R,{variant:"h3",children:"Configure Migration"}),e.jsxs(zs,{children:[e.jsxs(Ze,{children:[e.jsx(Pt,{children:"Current Region"}),e.jsxs(Ms,{children:[e.jsx(Fn,{country:g}),e.jsx(R,{children:`${An(m)}: ${(m==null?void 0:m.label)??i}`})]}),h&&e.jsx(et,{...b(i,f,"current")})]}),e.jsxs(Ze,{children:[e.jsx(Bn,{regions:(d==null?void 0:d.filter(y=>y.id!==i))??[],textFieldProps:{helperText:r},currentCapability:"Linodes",errorText:s,handleSelection:o,label:"New Region",selectedId:l}),h&&l&&e.jsx(et,{...b(l,S,"new")})]})]}),!f&&l&&e.jsx(G,{spacingBottom:16,spacingTop:8,text:$n,variant:"error"})]})}),Ei=u.memo(t=>{const{linodeId:n,onClose:i,open:s}=t,o=H(),{enqueueSnackbar:r}=ee(),{data:a}=te(n??-1,n!==void 0&&s),{data:l}=le((a==null?void 0:a.type)??"",!!(a!=null&&a.type)),{data:d}=qt((a==null?void 0:a.image)??"",a!==void 0&&s),{data:c}=Me(n??-1,n!==void 0&&s),{events:m}=Nt(),g=n?m.filter(x=>Wt(x,n)):[],{error:h,isLoading:f,mutateAsync:S,reset:b}=Ht(n??-1),{data:j}=ie(),{data:y}=Gt(s),{mutateAsync:p}=Qt(),{data:w}=re(),E=ge(),[v,P]=u.useState(null),[L,k]=u.useState(!1),[A,C]=u.useState(!1),{showGDPRCheckbox:T}=Mn({agreements:y,profile:j,regions:w,selectedRegionId:v??""});u.useEffect(()=>{h&&ae()},[h]),u.useEffect(()=>{s&&(b(),k(!1),P(null))},[s]);const M=u.useMemo(()=>{if(!E.metadata||!v||!a)return;const x=Ce(w??[],a.region),_=Ce(w??[],v);return x&&!_?"The selected Data Center does not support Metadata. If your Linode is rebuilt, it will boot without using any associated User Data.":void 0},[E.metadata,a,w,v]);if(!a)return null;const F=a.region,B=()=>{if(b(),!(!v||!L))return S({region:v}).then(()=>{ne(),Jt(F,v,+ut(new Date().toISOString(),{format:"H",timezone:j==null?void 0:j.timezone})),r("Your Linode has entered the migration queue and will begin migration shortly.",{variant:"success"}),A&&p({eu_model:!0,privacy_policy:!0}).catch(Zt),i()})},z=Yt(l?_e(l.label):a.type??"Unknown Type",a.specs.memory,a.specs.disk,a.specs.vcpus,(d==null?void 0:d.label)??a.image??"Unknown Image"),O=Vs(g,a.status),U=Math.ceil(zn(c??[])/Kt/60);return e.jsxs(me,{fullHeight:!0,fullWidth:!0,maxWidth:"md",onClose:i,open:s,title:`Migrate Linode ${a.label??""} to another region`,children:[h&&e.jsx(G,{text:h==null?void 0:h[0].reason,variant:"error"}),e.jsx(R,{sx:{marginTop:o.spacing(2)},variant:"h2",children:z}),e.jsx(Ps,{hasConfirmed:L,linodeId:n,metadataWarning:M,migrationTimeInMins:U,setConfirmed:k}),e.jsx(Os,{backupEnabled:a.backups.enabled,currentRegion:F,handleSelectRegion:P,linodeType:a.type,selectedRegion:v}),e.jsxs(q,{sx:{marginTop:o.spacing(3),[o.breakpoints.down("md")]:{flexWrap:"wrap",justifyContent:"flex-end"}},alignItems:"center",display:"flex",justifyContent:T?"space-between":"flex-end",children:[T?e.jsx($s,{centerCheckbox:!0,checked:A,onChange:x=>C(x.target.checked)}):null,e.jsx(X,{disabled:!!O||!L||!v||T&&!A,sx:{[o.breakpoints.down("md")]:{marginTop:o.spacing(2)}},buttonType:"primary",loading:f,onClick:B,children:"Enter Migration Queue"}),!!O&&e.jsx(Y,{status:"help",text:O})]})]})}),$s=D(Xt,{label:"StyledAgreementCheckbox"})(({theme:t})=>({maxWidth:"70%",[t.breakpoints.down("md")]:{maxWidth:"unset"}})),Vs=(t,n,i)=>{var s,o;return((s=t[0])==null?void 0:s.action)==="linode_migrate_datacenter"&&((o=t[0])==null?void 0:o.percent_complete)!==100?"Your Linode is currently being migrated.":""},Et=()=>e.jsx(G,{text:"This action is unavailable while your Linode’s host is undergoing maintenance.",variant:"warning"}),Us=D(G,{label:"StyledNotice"})({marginBottom:"0px !important",padding:"8px !important"}),qs=D(he,{label:"StyledActionPanel"})({"& button":{alignSelf:"flex-end"},justifyContent:"flex-start",marginTop:0,paddingTop:0}),Ns=D(V,{label:"StyledGrid"})(({theme:t})=>({paddingTop:t.spacing(3)})),Ws={authorized_users:[],image:"",metadata:{user_data:""},root_pass:""},Hs=t=>{const{disabled:n,handleRebuildError:i,linodeId:s,linodeLabel:o,linodeRegion:r,onClose:a,passwordHelperText:l}=t,{data:d,isLoading:c}=Re(),{enqueueSnackbar:m}=ee(),g=ge(),{data:h,error:f,isLoading:S}=Pe(),{data:b,isLoading:j}=re(),y=c||S||j,p=()=>It(en),[w,E]=u.useState(""),[v,P]=u.useState(""),[L,k]=u.useState(!1),A=B=>{P(B)},C=()=>{k(B=>!B)};u.useEffect(()=>{L&&P("")},[L]);const T=(d==null?void 0:d.type_to_confirm)!==!1&&w!==o,M=({authorized_users:B,image:z,root_pass:O},{setErrors:U,setStatus:x,setSubmitting:_})=>{_(!0),x(void 0);const I={authorized_users:B,image:z,metadata:{user_data:v?window.btoa(v):!v&&!L?null:""},root_pass:O};L&&delete I.metadata,pt(s,I).then($=>{ne(),_(!1),m("Linode rebuild started",{variant:"info"}),a()}).catch($=>{const Q="There was an issue rebuilding your Linode.",ce=N=>x({generalError:N});_(!1),Ct(U,$),Tt(ce,$,Q),ae()})},F=f?fe(f,"Unable to load Images")[0].reason:void 0;return e.jsx(wt,{initialValues:Ws,onSubmit:M,validateOnChange:!1,validationSchema:p,children:({errors:B,handleSubmit:z,setFieldValue:O,status:U,validateForm:x,values:_})=>{var Q,ce;const I=()=>{x().then(N=>{gt(N)?z():ae()})};U&&i(U.generalError);const $=g.metadata&&Ce(b??[],r??"")&&!!(_.image&&((ce=(Q=h==null?void 0:h.find(N=>N.id===_.image))==null?void 0:Q.capabilities)!=null&&ce.includes("cloud-init")));return e.jsx(Ns,{children:e.jsxs("form",{children:[e.jsx(vt,{handleSelectImage:N=>O("image",N),"data-qa-select-image":!0,disabled:n,error:F||B.image,images:h??[],selectedImageID:_.image,title:"Select Image",variant:"all"}),e.jsx(Lt,{setAuthorizedUsers:N=>O("authorized_users",N),authorizedUsers:_.authorized_users,"data-qa-access-panel":!0,disabled:n,error:B.root_pass,handleChange:N=>O("root_pass",N),password:_.root_pass,passwordHelperText:l}),$?e.jsxs(e.Fragment,{children:[e.jsx(Ee,{spacingTop:40}),e.jsx(Dn,{renderCheckbox:e.jsx(q,{children:e.jsx(De,{checked:L,onChange:C,sxFormLabel:{paddingLeft:"2px"},text:`Reuse user data previously provided for ${o}`})}),renderNotice:e.jsx(Us,{text:"Adding new user data is recommended as part of the rebuild process.",variant:"success"}),disabled:L,onChange:A,userData:v})]}):null,e.jsxs(V,{sx:{marginTop:"16px"},children:[e.jsx(Fe,{confirmationText:e.jsxs("span",{children:["To confirm these changes, type the label of the Linode (",e.jsx("strong",{children:o}),") in the field below:"]}),onChange:N=>{E(N)},hideLabel:!0,label:"Linode Label",textFieldStyle:{marginBottom:16},title:"Confirm",typographyStyle:{marginBottom:8},value:w,visible:d==null?void 0:d.type_to_confirm}),e.jsx(qs,{primaryButtonProps:{"data-testid":"rebuild-button","data-qa-form-data-loading":y,disabled:T||n,label:"Rebuild Linode",onClick:I}})]})]})})}})},Gs=t=>{const[n,i]=u.useState(tt);return[n,(a,l,d,c,m)=>{i({id:a,images:Qs(t,c),label:l,udf_data:Ys(m),user_defined_fields:m,username:d})},(a,l)=>{i(d=>{const c=qn([a],l,d.udf_data);return{...d,udf_data:{...d.udf_data,...c}}})},()=>i(tt)]},tt={id:void 0,images:[],label:"",udf_data:[],user_defined_fields:[],username:""},Qs=(t,n)=>t.filter(i=>n.includes(i.id)),Ys=t=>{const n={};return t.forEach(i=>{i.default&&(n[i.name]=i.default)}),n},Ks={authorized_users:[],image:"",root_pass:"",stackscript_id:""},nt=t=>{const{handleRebuildError:n,linodeId:i,linodeLabel:s,onClose:o,passwordHelperText:r}=t,{data:a,isLoading:l}=Re(),d=H(),{enqueueSnackbar:c}=ee(),{data:m,isLoading:g}=Pe(),h=tn(m??[]),f=l||g,S=()=>It(an),[b,j]=u.useState(""),y=(a==null?void 0:a.type_to_confirm)!==!1&&b!==s,[p,w,E,v]=Gs(Object.keys(h).map(C=>h[C])),[P,L]=u.useState(void 0),k=({authorized_users:C,image:T,root_pass:M},{setErrors:F,setStatus:B,setSubmitting:z})=>{z(!0),pt(i,{authorized_users:C,image:T,root_pass:M,stackscript_data:p.udf_data,stackscript_id:p.id}).then(O=>{ne(),z(!1),c("Linode rebuild started",{variant:"info"}),o()}).catch(O=>{const U=fe(O);L(Xs(U));const x="There was an issue rebuilding your Linode.",_=$=>B({generalError:$});z(!1);const I=U.map($=>$.field==="script"?{field:"stackscript_id",reason:$.reason.match(/invalid stackscript/i)?"The selected StackScript is invalid.":$.reason}:$);Ct(F,I),Tt(_,I,x),ae()})},A=()=>{const C=[];return p.user_defined_fields.forEach(T=>{Js(T)&&!p.udf_data[T.name]&&C.push({field:T.name,reason:`A value for the ${T.name} is required.`})}),C};return e.jsx(wt,{initialValues:Ks,onSubmit:k,validateOnChange:!1,validationSchema:S,children:({errors:C,handleSubmit:T,setFieldValue:M,status:F,validateForm:B,values:z})=>{const O=()=>{B().then(x=>{const _=A();L(_),gt(x)&&_.length===0?T():ae()})},U=(x,_,I,$,Q)=>{w(x,_,I,$,Q),M("stackscript_id",x),M("image","")};return F&&n(F.generalError),e.jsxs(V,{sx:{paddingTop:d.spacing(3)},children:[e.jsxs("form",{children:[e.jsx(_n,{request:t.type==="account"?nn:sn,category:t.type,"data-qa-select-stackscript":!0,error:C.stackscript_id,header:"Select StackScript",onSelect:U,publicImages:Wn(h,"public"),resetSelectedStackScript:v,selectedId:p.id,selectedUsername:p.username,updateFor:[p.id,C]}),p.user_defined_fields&&p.user_defined_fields.length>0&&e.jsx(Rn,{updateFor:[p.user_defined_fields,p.udf_data,P],errors:P,handleChange:E,selectedLabel:p.label,selectedUsername:p.username,udf_data:p.udf_data,userDefinedFields:p.user_defined_fields}),p.images&&p.images.length>0?e.jsx(vt,{handleSelectImage:x=>M("image",x),error:C.image,images:p.images,selectedImageID:z.image,title:"Choose Image",variant:"public"}):e.jsx(Pn,{sx:{padding:d.spacing(3)},errorText:C.image}),e.jsx(Lt,{setAuthorizedUsers:x=>M("authorized_users",x),authorizedUsers:z.authorized_users,"data-qa-access-panel":!0,error:C.root_pass,handleChange:x=>M("root_pass",x),password:z.root_pass,passwordHelperText:r}),e.jsx(Fe,{confirmationText:e.jsxs("span",{children:["To confirm these changes, type the label of the Linode (",e.jsx("strong",{children:s}),") in the field below:"]}),onChange:x=>{j(x)},hideLabel:!0,label:"Linode Label",textFieldStyle:{marginBottom:16},title:"Confirm",typographyStyle:{marginBottom:8},value:b,visible:a==null?void 0:a.type_to_confirm}),e.jsx(he,{primaryButtonProps:{"data-testid":"rebuild","data-qa-form-data-loading":f,disabled:y,label:"Rebuild Linode",onClick:O},sx:{"& button":{alignSelf:"flex-end"},flexDirection:"column"}})]}),e.jsx(En,{})]})}})},Xs=t=>{const n=["stackscript_id","root_pass","image","none"];return t?t.filter(i=>{const s=n.some(o=>o===i.field);return!!i.field&&!s}):void 0},Js=t=>!t.hasOwnProperty("default"),st=[{label:"From Image",value:"fromImage"},{label:"From Community StackScript",value:"fromCommunityStackScript"},{label:"From Account StackScript",value:"fromAccountStackScript"}],je="Set a password for your rebuilt Linode.",Ai=t=>{var y;const{linodeId:n,onClose:i,open:s}=t,{data:o}=ie(),{data:r}=Ae(),{data:a}=te(n??-1,n!==void 0&&s),l=!!(o!=null&&o.restricted)&&((y=r==null?void 0:r.linode.find(p=>p.id===n))==null?void 0:y.permissions)==="read_only",d=(a==null?void 0:a.status)==="stopped",c=l,m=d||c,g=H(),[h,f]=u.useState("fromImage"),[S,b]=u.useState("");u.useEffect(()=>{s&&b("")},[s]);const j=p=>{b(p)};return e.jsxs(me,{fullHeight:!0,fullWidth:!0,maxWidth:"md",onClose:i,open:s,title:`Rebuild Linode ${(a==null?void 0:a.label)??""}`,children:[e.jsxs(Zs,{children:[c&&e.jsx(ze,{}),d&&e.jsx(Et,{}),S&&e.jsx(G,{variant:"error",children:S}),e.jsxs(R,{sx:{paddingBottom:g.spacing(2)},"data-qa-rebuild-desc":!0,children:["If you can’t rescue an existing disk, it’s time to rebuild your Linode. There are a couple of different ways you can do this: either restore from a backup or start over with a fresh Linux distribution. ",e.jsx("strong",{children:"Rebuilding will destroy all data on all existing disks on this Linode."})]}),e.jsx(mt,{onChange:p=>{f(p.value),b("")},defaultValue:st.find(p=>p.value===h),disabled:m,hideLabel:!0,isClearable:!1,label:"From Image",options:st})]}),h==="fromImage"&&e.jsx(Hs,{disabled:m,handleRebuildError:j,linodeId:n??-1,linodeLabel:a==null?void 0:a.label,linodeRegion:a==null?void 0:a.region,onClose:i,passwordHelperText:je}),h==="fromCommunityStackScript"&&e.jsx(nt,{disabled:m,handleRebuildError:j,linodeId:n??-1,linodeLabel:a==null?void 0:a.label,onClose:i,passwordHelperText:je,type:"community"}),h==="fromAccountStackScript"&&e.jsx(nt,{disabled:m,handleRebuildError:j,linodeId:n??-1,linodeLabel:a==null?void 0:a.label,onClose:i,passwordHelperText:je,type:"account"})]})},Zs=D("div",{label:"StyledDiv"})(({theme:t})=>({"& + div":{"& .MuiPaper-root":{"& .MuiTableCell-head":{top:t.spacing(11)},"& > div":{padding:0},padding:0},"& .notice":{padding:t.spacing(2)},padding:0},paddingBottom:t.spacing(2)})),Se={firewallWarning:"Cloud Firewall rules are not enabled when booting into Rescue Mode.",link:"https://www.linode.com/docs/guides/rescue-and-rebuild/",text:"If you suspect that your primary filesystem is corrupt, use the Linode Manager to boot your Linode into Rescue Mode. This is a safe environment for performing many system recovery and disk management tasks."},At=t=>{const{isBareMetal:n,linodeId:i}=t,s=H(),{data:o}=Hn(i),a=((o==null?void 0:o.data)??[]).length>0;return e.jsxs(u.Fragment,{children:[a?e.jsx(G,{spacingBottom:16,spacingTop:0,text:Se.firewallWarning,variant:"warning"}):null,e.jsxs(R,{children:[Se.text," ",e.jsx(W,{to:Se.link,children:"Learn more."})]}),i&&n?e.jsxs(R,{sx:{marginTop:s.spacing(1)},children:["When your Linode has successfully rebooted into Rescue Mode, use the ",e.jsx(on,{onClick:()=>Dt(i),children:"LISH Console"})," to access it."]}):null]})},ea=t=>{const{isOpen:n,linodeId:i,onClose:s}=t,[o,r]=u.useState(!1),[a,l]=u.useState(void 0),{enqueueSnackbar:d}=ee(),{data:c,isLoading:m}=te(i??-1,i!==void 0&&n);u.useEffect(()=>{n&&(l(void 0),r(!1))},[n]);const g=()=>{l(void 0),r(!0),ln(i??-1).then(()=>{r(!1),d("Linode rescue started.",{variant:"info"}),ne(),s()}).catch(f=>{r(!1),l(fe(f,"Error booting into rescue mode.")[0].reason)})},h=()=>e.jsx(he,{primaryButtonProps:{label:"Reboot into Rescue Mode","data-qa-form-data-loading":o||m,loading:o,onClick:g},secondaryButtonProps:{"data-testid":"cancel",label:"Cancel",onClick:s}});return e.jsx(rn,{actions:h,error:a,onClose:s,open:n,title:`Rescue Linode ${(c==null?void 0:c.label)??""}`,children:i?e.jsx(At,{isBareMetal:!0,linodeId:i}):null})},ta=t=>{const n=t.map(o=>o._id),i=n.reduce((o,r)=>r?o+1:o,0);return[{sda:n[0],sdb:n[1],sdc:n[2],sdd:n[3],sde:n[4],sdf:n[5],sdg:n[6]},i]},na=t=>{var _;const{linodeId:n,onClose:i,open:s}=t,o=H(),{data:r,isLoading:a}=te(n??-1,n!==void 0&&s),{data:l,error:d,isLoading:c}=Me(n??-1,n!==void 0&&s),{data:m,error:g,isLoading:h}=dn({},{region:r==null?void 0:r.region},s),f=a||c||h,{data:S}=ie(),{data:b}=Ae(),j=!!(S!=null&&S.restricted)&&((_=b==null?void 0:b.linode.find(I=>I.id===n))==null?void 0:_.permissions)==="read_only",y=l==null?void 0:l.map(I=>Nn("_id",`disk-${I.id}`,I)),p=(m==null?void 0:m.filter(I=>{const $=I.linode_id===null;return I.linode_id===n||$}))??[],[w,E]=ta(y??[]),{mutateAsync:v}=cn(n??-1),P=un(w),[L,k]=u.useState(E),[A,C]=u.useState(w),{enqueueSnackbar:T}=ee(),[M,F]=u.useState("");u.useEffect(()=>{pn(w,P)||(k(E),C(w),F(""))},[s,E,w,P]);const B={disks:y??[],volumes:p.map(I=>({...I,_id:`volume-${I.id}`}))??[]},z=j,O=()=>{v(Qn(A)).then(I=>{T("Linode rescue started.",{variant:"info"}),ne(),i()}).catch(I=>{F(I[0].reason)})},U=()=>{k(mn(1,6,L+1))},x=(I,$)=>C(Q=>({...Q,[I]:$}));return e.jsxs(me,{onClose:()=>{F(""),i()},fullHeight:!0,fullWidth:!0,maxWidth:"md",open:s,title:`Rescue Linode ${(r==null?void 0:r.label)??""}`,children:[M&&e.jsx(G,{text:M,variant:"error"}),d?e.jsx("div",{children:e.jsx(Ue,{errorText:"There was an error retrieving Disks information."})}):g?e.jsx("div",{children:e.jsx(Ue,{errorText:"There was an error retrieving Volumes information."})}):e.jsx("div",{children:e.jsxs(sa,{children:[j&&e.jsx(ze,{}),n?e.jsx(At,{linodeId:n}):null,e.jsx(Gn,{counter:L,devices:B,disabled:z,getSelected:I=>gn("",[I],A),onChange:x,rescue:!0,slots:["sda","sdb","sdc","sdd","sde","sdf","sdg"]}),e.jsx(X,{sx:{marginTop:o.spacing()},buttonType:"secondary",compactX:!0,disabled:z||L>=6,onClick:U,children:"Add Disk"}),e.jsx(he,{primaryButtonProps:{"data-testid":"submit","data-qa-form-data-loading":f,disabled:z,label:"Reboot into Rescue Mode",onClick:O}})]})})]})},sa=D(ct,{label:"StyledPaper"})(({theme:t})=>({"& .iconTextLink":{display:"inline-flex",margin:`${t.spacing(3)} 0 0 0`},padding:`${t.spacing(3)} 0 ${t.spacing(1)}`})),Bi=t=>{const{linodeId:n,onClose:i,open:s}=t,{data:o}=te(n??-1,n!==void 0&&s),{data:r}=le((o==null?void 0:o.type)??"",!!(o!=null&&o.type));return(r==null?void 0:r.class)==="metal"?e.jsx(ea,{isOpen:s,linodeId:n,onClose:i}):e.jsx(na,{linodeId:n,onClose:i,open:s})},aa=t=>{var i;if(!t)return null;const n=(i=t==null?void 0:t[0])==null?void 0:i.reason;return typeof n=="string"&&n.match(/allocated more disk/i)?e.jsxs(R,{children:["The current disk size of your Linode is too large for the new service plan. Please resize your disk to accommodate the new plan. You can read our"," ",e.jsx(W,{to:"https://www.linode.com/docs/platform/disk-images/resizing-a-linode/",children:"Resize Your Linode"})," ","guide for more detailed instructions."]}):n},ve=t=>{const n=t.reduce((r,a)=>a.filesystem==="ext3"||a.filesystem==="ext4"?[...r,a.label]:r,[]),i=n.length===1,s=t.reduce((r,a)=>a.filesystem==="swap"?[...r,a.filesystem]:r,[]).length===1,o=t.length===1&&i||t.length===2&&s&&i;return[n[0],o]},at=(t,n,i)=>{const s=i.find(r=>r.id===n),o=i.find(r=>r.id===t);return s&&o?s.disk>o.disk:!1},it="resize-migration-types",ia=t=>{const{formik:n,isLinodeOffline:i,migrationTypeOptions:s}=t,o=H();return e.jsxs(q,{children:[e.jsx(R,{id:it,variant:"h2",children:"Resize Type"}),e.jsx(Xn,{children:e.jsxs(Jn,{"aria-labelledby":it,onChange:(r,a)=>n.setFieldValue("migration_type",a),row:!0,sx:{marginTop:"0 !important"},value:n.values.migration_type,children:[e.jsxs(q,{alignItems:"center",display:"flex",width:"100%",children:[e.jsx(qe,{control:e.jsx(Ye,{}),"data-qa-radio":s.warm,disabled:i,label:`${Ne(s.warm)} resize`,value:s.warm},s.warm),e.jsx(q,{sx:{marginLeft:"-10px"},children:e.jsx("strong",{children:"(Recommended)"})}),e.jsx(Y,{text:e.jsxs(e.Fragment,{children:["During a ",e.jsx("strong",{children:"warm resize"}),", your Linode will remain up and running for the duration of the process and will be rebooted to complete the resize."," ",e.jsx(W,{to:"https://www.linode.com/docs/products/compute/compute-instances/guides/resize/",children:"Learn more."})]}),interactive:!0,status:"help",tooltipPosition:"right",width:(o.breakpoints.up("sm"),375)})]}),e.jsxs(q,{width:"100%",children:[e.jsx(qe,{control:e.jsx(Ye,{}),"data-qa-radio":s.cold,disabled:i,label:`${Ne(s.cold)} resize`,value:s.cold},s.cold),e.jsx(Y,{sxTooltipIcon:{marginLeft:"-15px"},text:e.jsxs(e.Fragment,{children:["During a ",e.jsx("strong",{children:"cold resize"}),", your Linode will be shut down, migrated to a new host machine, and restored to its previous state (booted or powered off) once the resize is complete."," ",e.jsx(W,{to:"https://www.linode.com/docs/products/compute/compute-instances/guides/resize/",children:"Learn more."})]}),interactive:!0,status:"help",tooltipPosition:"right",width:(o.breakpoints.up("sm"),450)})]})]})}),e.jsx(Ee,{})]})},ke={cold:"cold",warm:"warm"},Mi=t=>{const{linodeId:n,onClose:i,open:s}=t,o=ge(),r=H(),{data:a}=te(n??-1,n!==void 0&&s),{data:l,error:d}=Me(n??-1,n!==void 0&&s),{data:c}=hn(s),{data:m}=Ae(),{data:g}=Re(s),{enqueueSnackbar:h}=ee(),[f,S]=u.useState(""),[b,j]=u.useState(!1),{error:y,isLoading:p,mutateAsync:w}=fn(n??-1),{data:E}=re(),v=(a==null?void 0:a.status)==="stopped",P=(a==null?void 0:a.status)==="offline",L=Kn(m,n||0)==="read_only",k=Un({initialValues:{allow_auto_disk_resize:ve(l??[])[1],migration_type:o.unifiedMigrations?ke.warm:void 0,type:""},async onSubmit(x){const _=at(x.type,(a==null?void 0:a.type)??null,c??[]);await w({allow_auto_disk_resize:x.allow_auto_disk_resize&&!_,migration_type:o.unifiedMigrations?x.migration_type:void 0,type:x.type}),ne(),h("Linode queued for resize.",{variant:"info"}),i()}});u.useEffect(()=>{P&&k.setFieldValue("migration_type",ke.cold)},[P,s]),u.useEffect(()=>{const x=ve(l??[])[1];x!==k.values.allow_auto_disk_resize&&k.setFieldValue("allow_auto_disk_resize",x)},[l]),u.useEffect(()=>{s||(k.resetForm(),S(""),j(!1))},[s]),u.useEffect(()=>{y&&(j(!0),ae(void 0,{block:"end"}))},[y]);const A=v||L,C=(g==null?void 0:g.type_to_confirm)!==!1&&f!==(a==null?void 0:a.label),T=c==null?void 0:c.find(x=>x.id===(a==null?void 0:a.type)),[M,F]=ve(l??[]),B=at(k.values.type,(a==null?void 0:a.type)||"",c??[]),z=(c==null?void 0:c.filter(x=>!x.successor))??[],O=aa(y),U=o.unifiedMigrations&&k.values.migration_type==="warm"&&!P?{onClick:()=>k.handleSubmit()}:{loading:p,type:"submit"};return e.jsx(me,{fullHeight:!0,fullWidth:!0,maxWidth:"md",onClose:i,open:s,title:`Resize Linode ${a==null?void 0:a.label}`,children:e.jsxs("form",{onSubmit:k.handleSubmit,children:[L&&e.jsx(ze,{}),v&&e.jsx(Et,{}),d&&e.jsx(G,{text:"There was an error loading your Linode’s Disks.",variant:"error"}),b&&e.jsx(G,{variant:"error",children:O}),e.jsxs(R,{"data-qa-description":!0,children:["If you’re expecting a temporary burst of traffic to your website, or if you’re not using your Linode as much as you thought, you can temporarily or permanently resize your Linode to a different plan."," ",e.jsx(W,{to:"https://www.linode.com/docs/platform/disk-images/resizing-a-linode/",children:"Learn more."})]}),e.jsx(q,{sx:{"& > div":{padding:0},marginBottom:r.spacing(3),marginTop:r.spacing(5)},children:e.jsx(Yn,{currentPlanHeading:T?We(T).heading:void 0,disabled:A,onSelect:x=>k.setFieldValue("type",x),regionsData:E,selectedId:k.values.type,selectedRegionID:a==null?void 0:a.region,types:z.map(We)})}),o.unifiedMigrations&&e.jsx(ia,{formik:k,isLinodeOffline:P,migrationTypeOptions:ke}),e.jsxs(R,{sx:{alignItems:"center",display:"flex",minHeight:"44px"},variant:"h2",children:["Auto Resize Disk",d?e.jsx(Y,{sxTooltipIcon:{marginLeft:"-2px"},status:"help",text:"There was an error loading your Linode&rsquo; disks."}):B?e.jsx(Y,{sxTooltipIcon:{marginLeft:"-2px"},status:"help",text:"Your disks cannot be automatically resized when moving to a smaller plan."}):F?null:e.jsx(Y,{sxTooltipIcon:{marginLeft:"-2px"},text:`Your ext disk can only be automatically resized if you have one ext
                    disk or one ext disk and one swap disk on this Linode.`,status:"help"})]}),e.jsx(De,{checked:!F||B?!1:k.values.allow_auto_disk_resize,onChange:(x,_)=>k.setFieldValue("allow_auto_disk_resize",_),text:e.jsxs(R,{children:["Would you like"," ",F?e.jsx("strong",{children:M}):"your disk"," ","to be automatically scaled with this Linode’s new size?"," ",e.jsx("br",{}),"We recommend you keep this option enabled when available."]}),disabled:!F||B}),e.jsx(Ee,{sx:{marginTop:r.spacing(2)}}),e.jsx(q,{marginTop:2,children:e.jsx(Fe,{confirmationText:e.jsxs("span",{children:["To confirm these changes, type the label of the Linode (",e.jsx("strong",{children:a==null?void 0:a.label}),") in the field below:"]}),hideLabel:!0,label:"Linode Label",onChange:S,textFieldStyle:{marginBottom:16},title:"Confirm",typographyStyle:{marginBottom:8},value:f,visible:g==null?void 0:g.type_to_confirm})}),e.jsx(q,{display:"flex",justifyContent:"flex-end",children:e.jsx(X,{disabled:!k.values.type||ht((a==null?void 0:a.status)||"")||A||C,buttonType:"primary","data-qa-resize":!0,...U,children:"Resize Linode"})})]})})},zi=t=>{const{entityLabel:n,onClose:i,open:s,tags:o,updateTags:r}=t;return e.jsx(Zn,{onClose:i,open:s,title:`Tags (${n})`,children:e.jsx(es,{tags:o,updateTags:r})})};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ie=function(){return Ie=Object.assign||function(n){for(var i,s=1,o=arguments.length;s<o;s++){i=arguments[s];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n},Ie.apply(this,arguments)};function oa(t,n){var i={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&n.indexOf(s)<0&&(i[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(t);o<s.length;o++)n.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(t,s[o])&&(i[s[o]]=t[s[o]]);return i}var se="",oe=null,pe=null,Bt=null;function Oe(){se="",oe!==null&&oe.disconnect(),pe!==null&&(window.clearTimeout(pe),pe=null)}function ot(t){var n=["BUTTON","INPUT","SELECT","TEXTAREA"],i=["A","AREA"];return n.includes(t.tagName)&&!t.hasAttribute("disabled")||i.includes(t.tagName)&&t.hasAttribute("href")}function rt(){var t=null;if(se==="#")t=document.body;else{var n=se.replace("#","");t=document.getElementById(n),t===null&&se==="#top"&&(t=document.body)}if(t!==null){Bt(t);var i=t.getAttribute("tabindex");return i===null&&!ot(t)&&t.setAttribute("tabindex",-1),t.focus({preventScroll:!0}),i===null&&!ot(t)&&(t.blur(),t.removeAttribute("tabindex")),Oe(),!0}return!1}function ra(t){window.setTimeout(function(){rt()===!1&&(oe===null&&(oe=new MutationObserver(rt)),oe.observe(document,{attributes:!0,childList:!0,subtree:!0}),pe=window.setTimeout(function(){Oe()},t||1e4))},0)}function Mt(t){return He.forwardRef(function(n,i){var s="";typeof n.to=="string"&&n.to.includes("#")?s="#"+n.to.split("#").slice(1).join("#"):typeof n.to=="object"&&typeof n.to.hash=="string"&&(s=n.to.hash);var o={};t===ft&&(o.isActive=function(l,d){return l&&l.isExact&&d.hash===s});function r(l){Oe(),se=n.elementId?"#"+n.elementId:s,n.onClick&&n.onClick(l),se!==""&&!l.defaultPrevented&&l.button===0&&(!n.target||n.target==="_self")&&!(l.metaKey||l.altKey||l.ctrlKey||l.shiftKey)&&(Bt=n.scroll||function(d){return n.smooth?d.scrollIntoView({behavior:"smooth"}):d.scrollIntoView()},ra(n.timeout))}var a=oa(n,["scroll","smooth","timeout","elementId"]);return He.createElement(t,Ie({},o,a,{onClick:r,ref:i}),n.children)})}var la=Mt(we);Mt(ft);const da=t=>{const{body:n,footer:i,header:s}=t;return e.jsxs(e.Fragment,{children:[s,n!==void 0&&e.jsx(ca,{xs:12,children:n}),e.jsx(ua,{body:n,xs:12,children:i})]})},ca=D(V)(({theme:t})=>({backgroundColor:t.bg.bgPaper,borderBottom:`1px solid ${t.borderColors.borderTable}`,borderTop:`1px solid ${t.borderColors.borderTable}`,paddingBottom:t.spacing(),paddingRight:t.spacing()})),ua=D(V,{label:"EntityDetailGridFooter",shouldForwardProp:de(["body"])})(({theme:t,...n})=>({alignItems:"center",backgroundColor:t.bg.bgPaper,borderTop:n.body===void 0?`1px solid ${t.borderColors.borderTable}`:void 0,display:"flex",flexDirection:"row",padding:`${t.spacing(1)} ${t.spacing(2)}`}));var $e={},pa=bt;Object.defineProperty($e,"__esModule",{value:!0});var zt=$e.default=void 0,ga=pa(xt()),ma=e,ha=(0,ga.default)((0,ma.jsx)("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreHoriz");zt=$e.default=ha;const fa=t=>{const{addTag:n,fixedMenu:i,label:s,onClose:o,tags:r}=t,a=Be(),[l,d]=u.useState(!1),{data:c}=ie(),{data:m,isLoading:g}=os(!(c!=null&&c.restricted)),h=m==null?void 0:m.filter(b=>!r.includes(b.label)).map(b=>({label:b.label,value:b.label})),f=b=>{b!=null&&b.value&&(d(!0),n(b.value).then(()=>{m&&rs([...m,b],a),o&&o()}).finally(()=>d(!1)))},S=g||l;return e.jsx(xa,{autoFocus:!0,creatable:!0,createOptionPosition:"first",escapeClearsValue:!0,hideLabel:!s,isLoading:S,label:s??"Add a tag",menuPosition:i?"fixed":"absolute",onBlur:o,onChange:f,options:h,placeholder:"Create or Select a Tag",small:!0})},xa=D(mt,{shouldForwardProp:de(["fixedMenu","inDetailsContext"])})(({...t})=>({padding:"0px",width:"100%",...t.fixedMenu&&{"& .react-select__menu":{margin:"2px 0 0 0"}},...t.inDetailsContext&&{display:"flex",flexBasis:"100%",justifyContent:"flex-end",width:"415px"}})),ba=t=>{const n=t.style.overflow;(!n||n==="visible")&&(t.style.overflow="hidden");const i=t.clientWidth<t.scrollWidth;return t.style.overflow=n,i},ya=t=>{const{sx:n,tags:i,updateTags:s}=t,[o,r]=u.useState(!1),[a,l]=u.useState(!1),[d,c]=u.useState(!1),m=u.useCallback(f=>{f!==null&&r(ba(f))},[i]),g=async f=>{await s([...i,f])},h=f=>{c(!0),s(i.filter(S=>S!==f)).finally(()=>c(!1))};return e.jsxs(ja,{alignItems:"center",container:!0,direction:"row",sx:n,wrap:"nowrap",children:[d?e.jsx(Sa,{children:e.jsx(yn,{mini:!0})}):null,a?e.jsx(fa,{addTag:g,inDetailsContext:!0,onClose:()=>l(!1),tags:i}):e.jsxs(e.Fragment,{children:[e.jsx(va,{hasOverflow:o,ref:m,children:i.map(f=>e.jsx(ka,{colorVariant:"lightBlue",label:f,loading:d,onDelete:()=>h(f)},`tag-item-${f}`))}),o?e.jsx(wa,{"aria-label":"Display all tags",disableRipple:!0,onClick:()=>t.listAllTags(i),onKeyPress:()=>t.listAllTags(i),size:"large",children:e.jsx(zt,{})}):null,e.jsxs(La,{onClick:()=>l(!0),title:"Add a tag",children:["Add a tag",e.jsx(ts,{})]})]})]})},ja=D(V)({justifyContent:"flex-end",minHeight:40,position:"relative"}),Sa=D("div")({alignItems:"center",display:"flex",height:"100%",justifyContent:"center",position:"absolute",width:"100%",zIndex:2}),va=D("div",{shouldForwardProp:de(["hasOverflow"])})(({...t})=>({"& .MuiChip-root:last-child":{marginRight:4},display:"flex",flexWrap:"nowrap",overflow:"hidden",position:"relative",whiteSpace:"nowrap",...t.hasOverflow&&{maskImage:"linear-gradient(to right, rgba(0, 0, 0, 1.0) 75%, transparent)"}})),ka=D(xn,{shouldForwardProp:de(["loading"])})(({...t})=>({...t.loading&&{opacity:.4}})),wa=D(bn)(({theme:t})=>({"&:hover":{backgroundColor:t.palette.primary.main,color:"#ffff"},backgroundColor:t.color.tagButton,borderRadius:0,color:t.color.tagIcon,height:30,marginLeft:t.spacing(.5),marginRight:t.spacing(.5),padding:0,[t.breakpoints.down("lg")]:{marginLeft:0},width:"40px"})),La=D("button")(({theme:t})=>({"& svg":{color:t.color.tagIcon,height:10,marginLeft:10,width:10},alignItems:"center",backgroundColor:t.color.tagButton,border:"none",borderRadius:3,color:t.textColors.linkActiveLight,cursor:"pointer",display:"flex",fontFamily:t.font.bold,fontSize:14,height:30,paddingLeft:10,paddingRight:10,whiteSpace:"nowrap"})),lt=u.memo(t=>{const{footer:n,gridProps:i,isVPCOnlyLinode:s,rows:o,sx:r,title:a}=t;return e.jsxs(V,{container:!0,direction:"column",md:6,spacing:1,sx:r,...i,children:[e.jsxs(Te,{children:[a," ",s&&a.includes("Public IP Address")&&us]}),e.jsxs(ps,{children:[e.jsx(gs,{children:e.jsx(ds,{children:o.map(l=>l.text?e.jsxs(ms,{disabled:s,children:[l.heading?e.jsx(K,{component:"th",scope:"row",children:l.heading}):null,e.jsxs(hs,{children:[e.jsx(fs,{children:e.jsx(ls,{copyableText:!0,disabled:s,text:l.text})}),e.jsx(xs,{disabled:s,text:l.text})]})]},l.text):null)})}),n?e.jsx(V,{sx:{padding:0},children:n}):null]})]})}),Ca=t=>u.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 60 60",style:{enableBackground:"new 0 0 60 60"},xmlSpace:"preserve",width:"24px",height:"24px",...t},u.createElement("rect",{x:16.5,y:31,style:{fill:"#606469"},width:10,height:6}),u.createElement("path",{style:{fill:"#606469"},d:"M3.5,0c-0.552,0-1,0.447-1,1v3v55c0,0.553,0.448,1,1,1s1-0.447,1-1V4V1C4.5,0.447,4.052,0,3.5,0z"}),u.createElement("rect",{x:4.5,y:4,style:{fill:"#4D99F1"},width:22,height:29}),u.createElement("path",{style:{fill:"#3683DC"},d:"M26.5,9v24h-6c-2.209,0-4,1.791-4,4c0,2.209,1.791,4,4,4h4h33l-11-16l11-16H26.5z"}),u.createElement("path",{style:{fill:"#5F88EA"},d:"M16.5,37c0,2.209,1.791,4,4,4h4h2v-8h-6C18.291,33,16.5,34.791,16.5,37z"}));var Ve={},Ta=bt;Object.defineProperty(Ve,"__esModule",{value:!0});var Ft=Ve.default=void 0,Ia=Ta(xt()),Da=e,_a=(0,Ia.default)((0,Da.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"}),"Backup");Ft=Ve.default=_a;const Ra=jn()((t,n,i)=>({backupLink:{"&:hover":{[`& .${i.icon}`]:{fill:t.palette.primary.main}},display:"flex"},backupNotApplicable:{marginRight:t.spacing()},backupScheduledOrNever:{marginRight:t.spacing()},backupText:{whiteSpace:"nowrap"},icon:{fill:t.color.grey1,fontSize:18},tooltip:{maxWidth:275},withTooltipIcon:{alignItems:"center",display:"flex"},wrapper:{alignContent:"center",display:"flex"}})),Pa=t=>{const{backupsEnabled:n,isBareMetalInstance:i,linodeId:s,mostRecentBackup:o}=t,{classes:r}=Ra(),a=e.jsxs(R,{children:["Backups are unavailable for Bare Metal instances. See our"," ",e.jsx(W,{to:"https://www.linode.com/docs/guides/backing-up-your-data/",children:"data backup guide"})," ","for other options to keep your data safe."]});return o?e.jsx(R,{className:r.backupText,variant:"body1",children:e.jsx(Ls,{displayTime:!0,value:o})}):n?e.jsx("div",{className:r.wrapper,children:e.jsx(Le,{placement:"right",title:"Edit Backups",children:e.jsx(we,{"aria-label":"Edit Backups",className:r.backupLink,to:`/linodes/${s}/backup`,children:e.jsx(R,{className:r.backupScheduledOrNever,variant:"body1",children:"Scheduled"})})})}):i?e.jsxs("div",{className:r.withTooltipIcon,children:[e.jsx(R,{className:r.backupNotApplicable,variant:"body1",children:"N/A"}),e.jsx(Y,{sxTooltipIcon:{padding:0},classes:{tooltip:r.tooltip},interactive:!0,status:"help",text:a})]}):e.jsx("div",{className:r.wrapper,children:e.jsx(Le,{placement:"right",title:"Enable Backups",children:e.jsxs(we,{"aria-label":"Enable Backups",className:r.backupLink,to:`/linodes/${s}/backup`,children:[e.jsx(R,{className:r.backupScheduledOrNever,variant:"body1",children:"Never"}),e.jsx(Ft,{className:`${r.icon} backupIcon`})]})})})},Ea=t=>({"& p":{color:t.textColors.linkActiveLight,fontFamily:t.font.bold},backgroundColor:"transparent",border:"none",cursor:"pointer",padding:0}),Aa=D("button",{label:"StyledButton"})(({theme:t})=>({...Ea(t)})),Ba=D(K,{label:"StyledIpTableCell"})({"& *":{fontSize:".875rem",paddingBottom:0,paddingTop:0},"& button:hover":{backgroundColor:"transparent"}}),Ma=D(K,{label:"StyledMaintenanceTableCell",shouldForwardProp:de(["maintenance"])})(({maintenance:t,theme:n})=>({...t?{"& .data":{alignItems:"center",display:"flex",lineHeight:1.2,marginRight:-12,[n.breakpoints.up("md")]:{minWidth:200}},"& button":{color:n.textColors.linkActiveLight,padding:"0 6px",position:"relative"},[n.breakpoints.up("md")]:{width:"20%"}}:{}})),Fi=t=>{const{backups:n,handlers:i,id:s,ipv4:o,label:r,maintenance:a,region:l,status:d,type:c}=t,m=u.useContext(yt),{data:g}=le(c??"",c!==null),h=Rt(s),f=(g==null?void 0:g.class)==="metal",S=ht(d,h),b=ns(a==null?void 0:a.when),j=()=>e.jsxs(e.Fragment,{children:["This Linode’s maintenance window opens at"," ",b,". For more information, see your"," ",e.jsx(W,{to:"/support/tickets?type=open",children:"open support tickets."})]}),y=ss(d),[p,w]=u.useState(!1),E=u.useCallback(()=>{w(!0)},[]),v=u.useCallback(()=>{w(!1)},[]);return e.jsxs(cs,{ariaLabel:r,"data-qa-linode":r,"data-qa-loading":!0,onMouseEnter:E,onMouseLeave:v,sx:{height:"auto"},children:[e.jsx(K,{noWrap:!0,children:e.jsx(W,{tabIndex:0,to:`/linodes/${s}`,children:r})}),e.jsx(Ma,{"data-qa-status":!0,maintenance:!!a,statusCell:!0,children:a?e.jsxs("div",{style:{alignItems:"center",display:"flex"},children:[e.jsx("strong",{children:"Maintenance Scheduled"}),e.jsx(Y,{interactive:!0,status:"help",sx:{tooltip:{maxWidth:300}},text:e.jsx(j,{}),tooltipPosition:"top"})]}):S?e.jsxs(e.Fragment,{children:[e.jsx(Je,{status:y}),e.jsx(Aa,{onClick:m.openMenu,children:e.jsx($t,{progress:jt(h),sx:{display:"inline-block"},text:St(d,s,h)})})]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{status:y}),Sn(d.replace("_"," "))]})}),e.jsxs(ue,{smDown:!0,children:[e.jsx(K,{noWrap:!0,children:g?_e(g.label):c}),e.jsx(Ba,{"data-qa-ips":!0,children:e.jsx(Cs,{ips:o,isHovered:p})}),e.jsx(ue,{lgDown:!0,children:e.jsx(K,{"data-qa-region":!0,children:e.jsx(Ts,{region:l})})})]}),e.jsx(ue,{lgDown:!0,children:e.jsx(K,{children:e.jsx(Pa,{backupsEnabled:n.enabled,isBareMetalInstance:f,linodeId:s,mostRecentBackup:n.last_successful})})}),e.jsxs(K,{actionCell:!0,"data-qa-notifications":!0,children:[e.jsx(Ot,{mutationAvailable:g!==void 0&&(g==null?void 0:g.successor)!==null}),e.jsx(kt,{linodeBackups:n,linodeId:s,linodeLabel:r,linodeRegion:l,linodeStatus:d,linodeType:g,...i,inListView:!0})]})]},s)},Ot=t=>{const{mutationAvailable:n}=t;return n?e.jsx(Le,{title:"There is a free upgrade available for this Linode",children:e.jsx(Ca,{})}):null};Ot.displayName="RenderFlag";const $t=t=>{const{className:n,progress:i,sx:s,text:o}=t,r=i?`${i}%`:"scheduled";return e.jsxs(R,{className:n,sx:s,variant:"body1",children:[o," ",r==="scheduled"?"(0%)":`(${r})`]})},za=t=>`ssh root@${t}`,Fa=(t,n,i)=>`ssh -t ${t}@lish-${n}.linode.com ${i}`,Oi=t=>{var k,A,C;const{handlers:n,isSummaryView:i,linode:s,openTagDrawer:o,variant:r}=t,a=u.useContext(yt),l=Rt(s.id),{data:d}=Pe({},{}),{data:c}=le(s.type??"",!!s.type),{data:m}=dt(s.id),g=(m==null?void 0:m.results)??0,{data:h}=re(),{configInterfaceWithVPC:f,configs:S,isVPCOnlyLinode:b,showVPCs:j,vpcLinodeIsAssignedTo:y}=vs(s.id),p=((k=d==null?void 0:d.find(T=>T.id===s.image))==null?void 0:k.vendor)??null,w=c?_e(c.label):s.type,E=((A=h==null?void 0:h.find(T=>T.id===s.region))==null?void 0:A.label)??s.region;let v,P;l&&kn(l,s.id)&&(v=jt(l),P=St(s.status,s.id,l));const L=((C=s.ipv6)==null?void 0:C.replace("/128",""))||null;return e.jsx(da,{body:e.jsx($a,{configInterfaceWithVPC:f,displayVPCSection:j,gbRAM:s.specs.memory/1024,gbStorage:s.specs.disk/1024,ipv4:s.ipv4,ipv6:L,isVPCOnlyLinode:b,linodeId:s.id,linodeLabel:s.label,numCPUs:s.specs.vcpus,numVolumes:g,region:s.region,vpcLinodeIsAssignedTo:y}),footer:e.jsx(Va,{linodeCreated:s.created,linodeId:s.id,linodeLabel:s.label,linodePlan:w,linodeRegionDisplay:E,linodeTags:s.tags,openTagDrawer:o}),header:e.jsx(Oa,{backups:s.backups,configs:S,enableVPCLogic:j,handlers:n,image:s.image??"Unknown Image",imageVendor:p,isSummaryView:i,linodeId:s.id,linodeLabel:s.label,linodeRegionDisplay:E,linodeStatus:s.status,openNotificationMenu:a.openMenu,progress:v,transitionText:P,type:c??null,variant:r})})},Oa=t=>{const n=H(),i=Be(),{backups:s,configs:o,enableVPCLogic:r,handlers:a,isSummaryView:l,linodeId:d,linodeLabel:c,linodeRegionDisplay:m,linodeStatus:g,openNotificationMenu:h,progress:f,transitionText:S,type:b,variant:j}=t,y=g==="running",p=g==="stopped"||g==="offline",w=!["offline","running","stopped"].includes(g),E=T=>{Ln("Launch Console"),Dt(T)},v=r&&y&&(o==null?void 0:o.some(T=>T.interfaces.some(M=>M.purpose==="vpc"&&!M.active)));u.useEffect(()=>{y&&r&&i.invalidateQueries([wn,"linode",d,"configs"])},[d,r,y,i]);const P=v?"REBOOT NEEDED":g.replace("_"," ").toUpperCase(),L=(S??"").toUpperCase(),k=typeof f<"u"&&typeof S<"u"&&L!==P,A={"&:hover":{backgroundColor:n.color.blueDTwhite,color:n.color.white},color:n.textColors.linkActiveLight,fontFamily:n.font.normal,fontSize:"0.875rem",height:n.spacing(5),minWidth:"auto"},C={alignItems:"center",display:"flex"};return e.jsxs(as,{isSummaryView:l,title:e.jsx(ks,{to:`linodes/${d}`,children:c}),variant:j,children:[e.jsxs(q,{sx:C,children:[e.jsx(ws,{"aria-label":`Linode status ${g}`,component:"span","data-qa-linode-status":!0,hasSecondaryStatus:k,isOffline:p,isOther:w,isRunning:y,isSummaryView:l,label:P,pill:!0}),v&&e.jsx(Y,{status:"help",sxTooltipIcon:{padding:0},text:Is}),k?e.jsx(X,{buttonType:"secondary",onClick:h,sx:{minWidth:"64px"},children:e.jsx($t,{progress:f??0,sx:{color:"primary.main",fontFamily:n.font.bold},text:L})}):null]}),e.jsxs(q,{sx:C,children:[e.jsxs(ue,{mdDown:!0,children:[e.jsx(X,{onClick:()=>a.onOpenPowerDialog(y?"Power Off":"Power On"),buttonType:"secondary",disabled:!(y||p),sx:A,children:y?"Power Off":"Power On"}),e.jsx(X,{buttonType:"secondary",disabled:p,onClick:()=>a.onOpenPowerDialog("Reboot"),sx:A,children:"Reboot"}),e.jsx(X,{onClick:()=>{E(d)},buttonType:"secondary",sx:A,children:"Launch LISH Console"})]}),e.jsx(kt,{linodeBackups:s,linodeId:d,linodeLabel:c,linodeRegion:m,linodeStatus:g,linodeType:b??void 0,...a})]})]})},$a=u.memo(t=>{var v;const{configInterfaceWithVPC:n,displayVPCSection:i,gbRAM:s,gbStorage:o,ipv4:r,ipv6:a,isVPCOnlyLinode:l,linodeId:d,linodeLabel:c,numCPUs:m,numVolumes:g,region:h,vpcLinodeIsAssignedTo:f}=t,{data:S}=ie(),b=(S==null?void 0:S.username)??"none",j=H(),y=f==null?void 0:f.subnets.filter(P=>P.linodes.some(L=>L.id===d)),p=r.length+(a?1:0),w=r[0],E=a||(r.length>1?r[1]:null);return e.jsxs(e.Fragment,{children:[e.jsxs(bs,{container:!0,direction:"row",spacing:2,children:[e.jsxs(V,{sx:{flexBasis:"25%"},container:!0,direction:"column",spacing:2,children:[e.jsx(Te,{children:"Summary"}),e.jsxs(ys,{container:!0,direction:"row",spacing:2,children:[e.jsx(V,{children:e.jsx(R,{children:Ge("CPU Core","CPU Cores",m)})}),e.jsx(V,{children:e.jsxs(R,{children:[o," GB Storage"]})}),e.jsx(V,{children:e.jsxs(R,{children:[s," GB RAM"]})}),e.jsx(V,{children:e.jsx(R,{children:Ge("Volume","Volumes",g)})})]})]}),e.jsxs(js,{container:!0,direction:"row",justifyContent:"space-between",spacing:2,children:[e.jsx(lt,{footer:p>2?e.jsx(R,{variant:"body1",children:e.jsx(la,{to:`/linodes/${d}/networking#${Ss}`,children:"View all IP Addresses"})}):void 0,sx:{[j.breakpoints.up("md")]:{paddingRight:j.spacing(2.5)}},gridProps:{md:5},isVPCOnlyLinode:l,rows:[{text:w},{text:E}],title:`Public IP Address${p>1?"es":""}`}),e.jsx(lt,{rows:[{heading:"SSH Access",text:za(r[0])},{heading:"LISH Console via SSH",text:Fa(b,h,c)}],sx:{[j.breakpoints.up("md")]:{paddingLeft:j.spacing(2.5)}},gridProps:{md:7},isVPCOnlyLinode:l,title:"Access"})]})]}),i&&f&&e.jsxs(V,{sx:{borderTop:`1px solid ${j.borderColors.borderTable}`,padding:`${j.spacing(1)} ${j.spacing(2)}`},container:!0,direction:"column",spacing:2,children:[e.jsx(Te,{"data-testid":"vpc-section-title",children:"VPC"}),e.jsxs(V,{sx:{margin:0,padding:"0 0 8px 0",[j.breakpoints.down("md")]:{display:"flex",flexDirection:"column",paddingLeft:"8px"}},container:!0,direction:"row",spacing:2,children:[e.jsx(be,{children:e.jsxs(J,{children:[e.jsx(Z,{component:"span",children:"Label:"})," ",e.jsx(W,{"data-testid":"assigned-vpc-label",to:`/vpcs/${f.id}`,children:f.label})]})}),e.jsx(be,{children:e.jsxs(J,{children:[e.jsx(Z,{component:"span","data-testid":"subnets-string",children:"Subnets:"})," ",Ua(y??[])]})}),e.jsx(be,{children:e.jsxs(J,{sx:{..._t},children:[e.jsx(Z,{component:"span","data-testid":"vpc-ipv4",children:"VPC IPv4:"})," ",(v=n==null?void 0:n.ipv4)==null?void 0:v.vpc]})})]})]})]})}),Va=u.memo(t=>{const n=H(),{data:i}=ie(),{linodeCreated:s,linodeId:o,linodePlan:r,linodeRegionDisplay:a,linodeTags:l,openTagDrawer:d}=t,{mutateAsync:c}=vn(o),{enqueueSnackbar:m}=ee(),g=u.useCallback(h=>c({tags:h}).catch(f=>m(fe(f,"Error updating tags")[0].reason,{variant:"error"})),[c,m]);return e.jsxs(V,{sx:{flex:1,padding:0},alignItems:"center",container:!0,direction:"row",justifyContent:"space-between",spacing:2,children:[e.jsxs(V,{sx:{display:"flex",padding:0,[n.breakpoints.down("lg")]:{padding:"8px"},[n.breakpoints.down("md")]:{display:"grid",gridTemplateColumns:"50% 2fr"}},alignItems:"flex-start",lg:8,xs:12,children:[e.jsxs(Ke,{children:[r&&e.jsxs(J,{sx:{...Xe,[n.breakpoints.down("lg")]:{paddingLeft:0}},children:[e.jsx(Z,{component:"span",children:"Plan: "})," ",r]}),a&&e.jsxs(J,{children:[e.jsx(Z,{component:"span",children:"Region:"})," ",a]})]}),e.jsxs(Ke,{children:[e.jsxs(J,{sx:{...Xe},children:[e.jsx(Z,{component:"span",children:"Linode ID:"})," ",o]}),e.jsxs(J,{sx:{..._t},children:[e.jsx(Z,{component:"span",children:"Created:"})," ",ut(s,{timezone:i==null?void 0:i.timezone})]})]})]}),e.jsx(V,{sx:{[n.breakpoints.down("lg")]:{display:"flex",justifyContent:"flex-start"}},lg:4,xs:12,children:e.jsx(ya,{sx:{[n.breakpoints.down("lg")]:{"& > button":{marginRight:n.spacing(.5)},flexDirection:"row-reverse"}},listAllTags:d,tags:l,updateTags:g})})]})}),Ua=t=>{const s=t.slice(0,3).map(o=>o.label).join(", ");return t.length>3?s.concat(`, plus ${t.length-3} more.`):s},$i=t=>{const n=Be(),i=ge(),{data:s}=Cn(),o=Tn("VPCs",!!i.vpc,(s==null?void 0:s.capabilities)??[]),{linodeId:r,onClose:a,onSuccess:l,open:d}=t,{data:c}=te(r??-1,r!==void 0&&d),{data:m}=_s(r??-1,r!==void 0&&d&&o),{error:g,isLoading:h,mutateAsync:f,reset:S}=In(r??-1);u.useEffect(()=>{d&&S()},[d]);const b=async()=>{await f();const j=o?is(m??[]):[];j.length>0&&(n.invalidateQueries([ye,"paginated"]),j.forEach(y=>{n.invalidateQueries([ye,"vpc",y]),n.invalidateQueries([ye,"vpc",y,Rs])})),a(),ne(),l&&l()};return e.jsx(Ds,{entity:{action:"deletion",name:c==null?void 0:c.label,primaryBtnText:"Delete",type:"Linode"},errors:g,label:"Linode Label",loading:h,onClick:b,onClose:a,open:d,title:`Delete ${(c==null?void 0:c.label)??""}?`,children:e.jsx(G,{variant:"warning",children:e.jsxs(R,{style:{fontSize:"0.875rem"},children:[e.jsx("strong",{children:"Warning:"})," Deleting your Linode will result in permanent data loss."]})})})};export{$i as D,Oi as L,Ei as M,Bi as R,zi as T,Fi as a,Mi as b,Ai as c};
