import{cx as E,u as D,r as C,j as r,ao as j,bp as T,kD as S,ak as v,ba as R,ad as P,bB as y,ag as k}from"./index-Eksrs3uK.js";import{T as F}from"./TypeToConfirmDialog-9yjZCCL0.js";import{g as B,h as L}from"./vpcs-qp5yIH1u.js";import{u as w}from"./formik.esm-Kap5lsIh.js";import{D as M}from"./Drawer-A9yKjC3Z.js";import{R as O}from"./RegionSelect-_Z8IGlox.js";const q=m=>{const{id:l,label:n,onClose:e,open:s}=m,{enqueueSnackbar:o}=E(),{error:d,isLoading:i,mutateAsync:c,reset:u}=B(l??-1),b=D();C.useEffect(()=>{s&&u()},[s,u]);const p=()=>{c().then(()=>{o("VPC deleted successfully.",{variant:"success"}),e(),b.location.pathname!=="/vpcs"&&b.push("/vpcs")})};return r.jsx(F,{entity:{action:"deletion",name:n,primaryBtnText:"Delete",type:"VPC"},errors:d,label:"VPC Label",loading:i,onClick:p,onClose:e,open:s,title:`Delete VPC ${n}`})},A="Region cannot be changed during beta.",z=m=>{const{onClose:l,open:n,vpc:e}=m,{data:s}=j(),{data:o}=T(),d=o==null?void 0:o.vpc.find(a=>a.id===(e==null?void 0:e.id)),i=!!(s!=null&&s.restricted)&&((d==null?void 0:d.permissions)==="read_only"||(o==null?void 0:o.vpc.length)===0),{error:c,isLoading:u,mutateAsync:b,reset:p}=L((e==null?void 0:e.id)??-1),t=w({enableReinitialize:!0,initialValues:{description:e==null?void 0:e.description,label:e==null?void 0:e.label},async onSubmit(a){await b(a),l()},validateOnChange:!1,validationSchema:S}),g=(a,f)=>{t.setFieldValue(a,f),t.errors[a]&&t.setFieldError(a,void 0)};C.useEffect(()=>{n&&(t.resetForm(),p())},[n]),C.useEffect(()=>{if(c){const a=v(["label","description"],c);for(const[f,V]of Object.entries(a))t.setFieldError(f,V)}},[c]);const{data:x,error:h}=R();return r.jsxs(M,{onClose:l,open:n,title:"Edit VPC",children:[t.errors.none&&r.jsx(P,{text:t.errors.none,variant:"error"}),i&&r.jsx(P,{important:!0,text:`You don't have permissions to edit ${e==null?void 0:e.label}. Please contact an account administrator for details.`,variant:"error"}),r.jsxs("form",{onSubmit:t.handleSubmit,children:[r.jsx(y,{disabled:i,errorText:t.errors.label,label:"Label",name:"label",onChange:a=>g("label",a.target.value),value:t.values.label}),r.jsx(y,{disabled:i,errorText:t.errors.description,label:"Description",multiline:!0,onChange:a=>g("description",a.target.value),rows:1,value:t.values.description}),x&&r.jsx(O,{currentCapability:"VPCs",disabled:!0,errorText:h&&h[0].reason||void 0,handleSelection:()=>null,helperText:A,regions:x,selectedId:(e==null?void 0:e.region)??null}),r.jsx(k,{primaryButtonProps:{"data-testid":"save-button",disabled:!t.dirty||i,label:"Save",loading:u,type:"submit"},secondaryButtonProps:{label:"Cancel",onClick:l}})]})]})};export{q as V,z as a};
