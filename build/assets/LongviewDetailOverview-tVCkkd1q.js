import{j as e,aW as E,G as x,T as w,r as i,s as M,m as ae,f as re,V as J,cb as h,co as B,jW as ne,aa as X,B as se,Q as oe}from"./index-Eksrs3uK.js";import{C as ie,R as le,S as ce,L as de,N as pe,a as me,f as xe,b as he}from"./formatUptime-T2o8loDP.js";import{O as A}from"./OrderBy-H-bWJCPy.js";import{P as Y}from"./Paginate-XLm_-WxT.js";import{P as ee}from"./PaginationFooter-NHWf7fW2.js";import{T,a as k,b as V,c as O}from"./TableRow-phXfWUGW.js";import{T as W}from"./TableRowEmpty-aXmC67-Z.js";import{T as _}from"./TableRowError-8gKmGX7P.js";import{T as K}from"./TableRowLoading-iP7zIRHG.js";import{T as C}from"./TableSortCell-hcsagFzN.js";import{T as F}from"./TableHead-Si_pzkLK.js";import{u as G,p as ue,c as R,L as q,f as z,T as ge,i as ve,S as je,a as $,b as be}from"./LongviewDetail-icjx983y.js";import{i as we,n as Q,k as fe,o as ye,p as N,q as ke,l as Ce,r as Se,e as Me,f as Le}from"./utilities-JekaXHyt.js";import"./Drawer-A9yKjC3Z.js";import"./useClientLastUpdated-a0PNleVi.js";import"./longview.container-N5k_O7w1.js";import"./splitAt-pbTnq2Oi.js";import"./Skeleton-iwmO4Yae.js";import"./LandingHeader-JXAVBhqg.js";import"./SafeTabPanel-S0Pp8CVT.js";import"./TabList-4PWL4GSj.js";import"./TabLinkList-BrXtJznm.js";import"./useAPIRequest-UcK5fafY.js";import"./immer.esm--MpJ8fpr.js";import"./LineGraph-UgU3EQj3.js";import"./visuallyHidden-DVicuktI.js";import"./over-27tc0FF7.js";import"./assocPath-nNkv7F8U.js";import"./set-2Chj4B2I.js";import"./sortBy-avzW26A0.js";import"./useWindowDimensions-Dnr94FWA.js";const Ee=t=>{const{connection:a}=t;return e.jsxs(T,{ariaLabel:a.name,"data-testid":"longview-connection-row",children:[e.jsx(k,{"data-qa-active-connection-name":!0,parentColumn:"Name",children:a.name}),e.jsx(k,{"data-qa-active-connection-user":!0,parentColumn:"User",children:a.user}),e.jsx(k,{"data-qa-active-connection-count":!0,parentColumn:"Count",children:a.count})]})},De=t=>{const{connections:a,connectionsError:r,connectionsLoading:s}=t,o=E();return e.jsxs(x,{md:4,xs:12,children:[e.jsx(w,{sx:{[o.breakpoints.down("lg")]:{marginLeft:o.spacing(),marginRight:o.spacing()}},variant:"h2",children:"Active Connections"}),e.jsx(Pe,{connections:a,connectionsError:r,connectionsLoading:s})]})},Pe=t=>{const{connections:a,connectionsError:r,connectionsLoading:s}=t;return e.jsx(A,{data:a,order:"asc",orderBy:"process",preferenceKey:"active-connections",children:({data:o,handleOrderChange:c,order:n,orderBy:p})=>e.jsx(Y,{data:o,pageSize:25,children:({count:d,data:l,handlePageChange:m,handlePageSizeChange:g,page:v,pageSize:u})=>e.jsxs(e.Fragment,{children:[e.jsxs(V,{spacingTop:16,children:[e.jsx(F,{children:e.jsxs(T,{children:[e.jsx(C,{active:p==="name","data-qa-table-header":"Name",direction:n,handleClick:c,label:"name",children:"Name"}),e.jsx(C,{active:p==="user","data-qa-table-header":"User",direction:n,handleClick:c,label:"user",children:"User"}),e.jsx(C,{active:p==="count","data-qa-table-header":"Count",direction:n,handleClick:c,label:"count",children:"Count"})]})}),e.jsx(O,{children:Te(s,l,r)})]}),e.jsx(ee,{count:d,eventCategory:"Longview active connections",handlePageChange:m,handleSizeChange:g,page:v,pageSize:u})]})})})},Te=(t,a,r)=>r?e.jsx(_,{colSpan:12,message:r}):t?e.jsx(K,{columns:3}):a.length===0?e.jsx(W,{colSpan:12,message:"No active connections."}):a.map((s,o)=>e.jsx(Ee,{connection:s},`longview-active-connection-${o}`)),Ue=i.memo(t=>e.jsxs(Ie,{container:!0,md:5,spacing:2,xs:12,children:[e.jsx(D,{xs:4,children:e.jsx(ie,{clientID:t.clientID,lastUpdatedError:t.lastUpdatedError})}),e.jsx(D,{xs:4,children:e.jsx(le,{clientID:t.clientID,lastUpdatedError:t.lastUpdatedError})}),e.jsx(D,{xs:4,children:e.jsx(ce,{clientID:t.clientID,lastUpdatedError:t.lastUpdatedError})}),e.jsx(D,{xs:4,children:e.jsx(de,{clientID:t.clientID,lastUpdatedError:t.lastUpdatedError})}),e.jsx(D,{xs:4,children:e.jsx(pe,{clientID:t.clientID,lastUpdatedError:t.lastUpdatedError})}),e.jsx(D,{xs:4,children:e.jsx(me,{clientID:t.clientID,lastUpdatedError:t.lastUpdatedError})})]})),D=M(x,{label:"StyledGaugeContainerGrid"})(({theme:t})=>({marginBottom:t.spacing(6),boxSizing:"border-box"})),Ie=M(x,{label:"StyledOuterGrid"})(({theme:t})=>({[t.breakpoints.down("lg")]:{marginBottom:t.spacing(2)},[t.breakpoints.up("lg")]:{maxWidth:450}})),Ge=t=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:32,height:32,viewBox:"0 0 32 32",...t},i.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"#666",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5},i.createElement("path",{d:"M6.182 4h19.636C27.023 4 28 4.977 28 6.182v19.636A2.183 2.183 0 0 1 25.818 28H6.182A2.183 2.183 0 0 1 4 25.818V6.182C4 4.977 4.977 4 6.182 4zM16 4V.727M8.364 4V.727M23.636 4V.727M16 31.273V28M8.364 31.273V28M23.636 31.273V28M31.273 16H28M31.273 23.636H28M31.273 8.364H28M4 16H.727M4 23.636H.727M4 8.364H.727"}),i.createElement("path",{d:"M10.545 8.364h10.91c1.204 0 2.181.977 2.181 2.181v10.91a2.183 2.183 0 0 1-2.181 2.181h-10.91a2.183 2.183 0 0 1-2.181-2.181v-10.91c0-1.204.977-2.181 2.181-2.181zM19.273 19.273H16"}))),Re=t=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:30,viewBox:"0 0 26 32",...t},i.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"#666",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5},i.createElement("path",{d:"M6.6 18a8 8 0 1 1 10.332 1.877M12.839 12.5a.5.5 0 1 0 0 1 .5.5 0 0 0 0-1"}),i.createElement("path",{d:"M3 1h20a2 2 0 0 1 2 2v26a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2z"}),i.createElement("path",{d:"M5.867 22.577a2.342 2.342 0 1 0 3.213 3.214l4.82-8.035-8.033 4.821zM21 26v-2M17 26v-2"}))),Z=t=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:31,height:21,viewBox:"0 0 32 21",...t},i.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"#666",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5},i.createElement("path",{d:"M18 11.16v9.013H8a2 2 0 0 1-2-2v-17M29 8.173v10a2 2 0 0 1-2 2h-9M5 1.173l-3.895 5.92a.696.696 0 0 0-.009.719.74.74 0 0 0 .64.361H6"}),i.createElement("path",{d:"M18.241 1.173L20.8 7.557c.156.374.52.616.924.616h8.543a.736.736 0 0 0 .684-1.009l-2.491-6M5 1.173l23.457-.013"}))),qe=t=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:34,height:35,viewBox:"0 0 34 35",...t},i.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"#666",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5},i.createElement("path",{d:"M30.908 33.419H3.092a2.133 2.133 0 0 1-2.14-2.14v-8.558a2.133 2.133 0 0 1 2.128-2.14h11.781l.355.543a2.14 2.14 0 0 0 3.564-.003l.355-.544 11.773.004a2.133 2.133 0 0 1 2.14 2.14v8.558a2.133 2.133 0 0 1-2.128 2.14h-.012z"}),i.createElement("path",{d:"M5.232 27v2.14h4.28L9.51 27M24.49 27l-.001 2.14h4.28V27M13.79 27v2.14h6.42V27M5.232 20.582L5.23 22.72M9.511 20.58v2.14M24.489 20.58v2.14M28.768 20.582l.001 2.139"}),i.createElement("g",null,i.createElement("path",{d:"M30.908 14.419H3.092a2.133 2.133 0 0 1-2.14-2.14V3.721A2.133 2.133 0 0 1 3.08 1.58h11.781l.355.543a2.14 2.14 0 0 0 3.564-.003l.355-.544 11.773.004a2.133 2.133 0 0 1 2.14 2.14v8.558a2.133 2.133 0 0 1-2.128 2.14h-.012z"}),i.createElement("path",{d:"M5.232 8v2.14h4.28L9.51 8M24.49 8l-.001 2.14h4.28V8M13.79 8v2.14h6.42V8M5.232 1.582L5.23 3.72M9.511 1.58v2.14M24.489 1.58v2.14M28.768 1.582l.001 2.139"})))),ze=t=>i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:31,height:18,viewBox:"0 0 34 20",...t},i.createElement("g",{fill:"none",fillRule:"evenodd",stroke:"#666",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5},i.createElement("path",{d:"M27.133 5.622a.534.534 0 1 0 0 1.067.534.534 0 0 0 0-1.067"}),i.createElement("path",{d:"M3.133 1.356h27.734C32.044 1.356 33 2.63 33 4.2v11.378c0 1.57-.956 2.844-2.133 2.844H3.133C1.956 18.422 1 17.148 1 15.578V4.2c0-1.57.956-2.844 2.133-2.844zM27.667 9.889H6.333M27.667 13.8H6.333"}))),$e=ae()(t=>({active:{color:"#1f64b6"},disabled:{"& $icon":{borderColor:"#939598",color:"#939598"},color:"#939598",pointerEvents:"none"},icon:{"& .border":{transition:"none"},color:"inherit",fontSize:18,marginRight:t.spacing(.5),transition:"none"},label:{position:"relative",top:-1,whiteSpace:"nowrap"},left:{left:`-${t.spacing(1.5)}`},linkWrapper:{"&:hover, &:focus":{textDecoration:"none"},display:"flex",justifyContent:"center"},root:{"&:focus":{outline:"1px dotted #999"},"&:hover":{"& .border":{color:t.palette.primary.light},backgroundColor:"transparent",color:t.palette.primary.light},alignItems:"flex-start",borderRadius:0,cursor:"pointer",display:"flex",margin:`0 ${t.spacing(1)} 2px 0`,minHeight:"auto",padding:t.spacing(1.5),transition:"none"}})),Be=t=>{const{classes:a,cx:r}=$e(),{SideIcon:s,active:o,className:c,disabled:n,hideText:p,left:d,onClick:l,text:m,title:g,to:v}=t,u=e.jsxs(re,{className:r(a.root,{[a.active]:o,[a.disabled]:n,[a.left]:d},c),"data-qa-icon-text-link":g,disableRipple:!0,onClick:l,title:g,children:[e.jsx(s,{className:r(a.icon,{m0:p})}),e.jsx("span",{className:r(a.label,{"visually-hidden":p}),children:m})]});return v!==void 0&&!n?e.jsx(J,{className:a.linkWrapper,to:v,children:u}):u},te={boxSizing:"border-box",display:"flex",flexWrap:"wrap",width:"100%",wrap:"nowrap"},He=M(x,{label:"StyledHeaderGrid"})({...te,alignItems:"flex-start"}),P=M(x,{label:"StyledIconContainerGrid"})({"&:last-of-type":{marginBottom:0},alignItems:"center",...te}),U=M(x,{label:"StyledIconGrid"})({"& svg":{display:"block",margin:"0 auto"}}),Ne=M(Be,{label:"StyledIconTextLink"})(({theme:t})=>({"& g":{stroke:t.palette.primary.main},"& svg":{marginRight:18},fontSize:"0.875rem",padding:0})),Ae=M(x,{label:"StyledPackageGrid"})({alignSelf:"center",boxSizing:"border-box"}),Ve=i.memo(t=>{const a=h("Hostname not available",["SysInfo","hostname"],t.longviewClientData),r=h("Distro information not available",["SysInfo","os","dist"],t.longviewClientData),s=h("",["SysInfo","os","distversion"],t.longviewClientData),o=h("",["SysInfo","kernel"],t.longviewClientData),c=h("CPU information not available",["SysInfo","cpu","type"],t.longviewClientData),n=h(null,["Uptime"],t.longviewClientData),p=n!==null?`Up ${xe(n)}`:"Uptime not available",d=h("",["SysInfo","cpu","cores"],t.longviewClientData),l=d&&d>1?"Cores":"Core",m=h(null,["Packages"],t.longviewClientData),g=we(m),v=h(0,["Memory","real","used",0,"y"],t.longviewClientData),u=h(0,["Memory","real","free",0,"y"],t.longviewClientData),j=h(0,["Memory","swap","free",0,"y"],t.longviewClientData),b=h(0,["Memory","swap","used",0,"y"],t.longviewClientData),f=Q(v,u),y=Q(b,j),L=fe(t.longviewClientData.Disk);return e.jsxs(x,{lg:3,md:6,xs:12,children:[e.jsx(He,{container:!0,spacing:2,children:e.jsxs(x,{children:[e.jsx(w,{sx:{wordBreak:"break-all"},variant:"h3",children:t.client}),e.jsx(w,{children:a}),e.jsx(w,{children:p})]})}),e.jsxs(P,{container:!0,spacing:2,children:[e.jsx(U,{md:2,sm:1,xs:2,children:e.jsx(ze,{})}),e.jsx(x,{xs:10,children:e.jsxs(w,{children:[r," ",s," ",o&&`(${o})`]})})]}),e.jsxs(P,{container:!0,spacing:2,children:[e.jsx(U,{md:2,sm:1,xs:2,children:e.jsx(Ge,{})}),e.jsxs(x,{xs:10,children:[e.jsx(w,{children:c}),d&&e.jsx(w,{children:`${d} ${l}`})]})]}),e.jsxs(P,{container:!0,spacing:2,children:[e.jsx(U,{md:2,sm:1,xs:2,children:e.jsx(qe,{})}),f.value!==0&&y.value!==0?e.jsxs(x,{xs:10,children:[e.jsx(w,{children:`${f.value} ${f.unit} RAM`}),e.jsx(w,{children:`${y.value} ${y.unit} Swap`})]}):e.jsx(x,{xs:10,children:e.jsx(w,{children:"RAM information not available"})})]}),e.jsxs(P,{container:!0,spacing:2,children:[e.jsx(U,{md:2,sm:1,xs:2,children:e.jsx(Re,{})}),L.total!==0?e.jsxs(x,{xs:10,children:[e.jsx(w,{children:`${B(L.total,{unit:"GB"}).formatted} Storage`}),e.jsx(w,{children:`${B(L.free,{unit:"GB"}).formatted} Available`})]}):e.jsx(x,{xs:10,children:e.jsx(w,{children:"Storage information not available"})})]}),m&&m.length>0?e.jsx(P,{container:!0,spacing:2,children:e.jsx(Ae,{md:2,sm:1,xs:2,children:e.jsx(Ne,{SideIcon:Z,onClick:t.openPackageDrawer,text:g,title:g,children:g})})}):e.jsxs(P,{container:!0,spacing:2,children:[e.jsx(U,{md:2,sm:1,xs:2,children:e.jsx(Z,{})}),e.jsx(x,{xs:10,children:e.jsx(w,{children:g})})]})]})}),Oe=t=>{const{service:a}=t;return e.jsxs(T,{ariaLabel:a.name,"data-testid":"longview-service-row",children:[e.jsx(k,{"data-qa-service-process":!0,parentColumn:"Process",children:a.name}),e.jsx(k,{"data-qa-service-user":!0,parentColumn:"User",children:a.user}),e.jsx(k,{"data-qa-service-protocol":!0,parentColumn:"Protocol",children:a.type}),e.jsx(k,{"data-qa-service-port":!0,parentColumn:"Port",children:a.port}),e.jsx(k,{"data-qa-service-ip":!0,parentColumn:"IP",children:a.ip})]})},We=t=>{const{services:a,servicesError:r,servicesLoading:s}=t;return e.jsxs(x,{md:8,xs:12,children:[e.jsx(w,{sx:o=>({[o.breakpoints.down("lg")]:{marginLeft:o.spacing()}}),variant:"h2",children:"Listening Services"}),e.jsx(_e,{services:a,servicesError:r,servicesLoading:s})]})},_e=t=>{const{services:a,servicesError:r,servicesLoading:s}=t;return e.jsx(A,{data:a,order:"asc",orderBy:"process",preferenceKey:"listening-services",children:({data:o,handleOrderChange:c,order:n,orderBy:p})=>e.jsx(Y,{data:o,pageSize:25,children:({count:d,data:l,handlePageChange:m,handlePageSizeChange:g,page:v,pageSize:u})=>e.jsxs(e.Fragment,{children:[e.jsxs(V,{spacingTop:16,children:[e.jsx(F,{children:e.jsxs(T,{children:[e.jsx(C,{active:p==="name","data-qa-table-header":"Process",direction:n,handleClick:c,label:"name",style:{width:"25%"},children:"Process"}),e.jsx(C,{active:p==="user","data-qa-table-header":"User",direction:n,handleClick:c,label:"user",style:{width:"25%"},children:"User"}),e.jsx(C,{active:p==="type","data-qa-table-header":"Protocol",direction:n,handleClick:c,label:"type",style:{width:"15%"},children:"Protocol"}),e.jsx(C,{active:p==="port","data-qa-table-header":"Port",direction:n,handleClick:c,label:"port",style:{width:"10%"},children:"Port"}),e.jsx(C,{active:p==="ip","data-qa-table-header":"IP",direction:n,handleClick:c,label:"ip",style:{width:"25%"},children:"IP"})]})}),e.jsx(O,{children:Ke(s,l,r)})]}),e.jsx(ee,{count:d,eventCategory:"Longview active connections",handlePageChange:m,handleSizeChange:g,page:v,pageSize:u})]})})})},Ke=(t,a,r)=>r?e.jsx(_,{colSpan:12,message:r}):t?e.jsx(K,{columns:5}):a.length===0?e.jsx(W,{colSpan:12,message:"No listening services."}):a.map((s,o)=>e.jsx(Oe,{service:s},`longview-service-${o}`)),Fe=t=>{const{clientAPIKey:a,end:r,isToday:s,lastUpdated:o,lastUpdatedError:c,start:n,timezone:p}=t,d=E(),{data:l,error:m,loading:g,request:v}=G(["cpu"],a,n,r),u=i.useMemo(()=>{const b=ye(l.CPU);return ue(b,n,[["system"],["user"],["wait"]])},[l.CPU]);i.useEffect(()=>{v()},[n,r,a,o,c]);const j=i.useCallback(R,[l,n,r]);return e.jsx(q,{data:[{backgroundColor:d.graphs.cpu.system,borderColor:"transparent",data:j(u.system,n,r),label:"System"},{backgroundColor:d.graphs.cpu.user,borderColor:"transparent",data:j(u.user,n,r),label:"User"},{backgroundColor:d.graphs.cpu.wait,borderColor:"transparent",data:j(u.wait,n,r),label:"Wait"}],ariaLabel:"CPU Usage Graph",error:m,loading:g,nativeLegend:!0,showToday:s,subtitle:"%",timezone:p,title:"CPU",unit:"%"})},Qe=t=>{const{clientAPIKey:a,end:r,isToday:s,lastUpdated:o,lastUpdatedError:c,start:n,timezone:p}=t,d=E(),{data:l,error:m,loading:g,request:v}=G(["disk","sysinfo"],a,n,r);i.useEffect(()=>{v()},[n,r,a,o,c]);const u=i.useCallback(R,[l,n,r]),{error:j,read:b,swap:f,write:y}=i.useMemo(()=>Ze(h({},["Disk"],l),h("kvm",["SysInfo","type"],l)),[l.Disk,l.SysInfo]);return e.jsx(q,{data:[{backgroundColor:d.graphs.diskIO.swap,borderColor:"transparent",data:u(f,n,r),label:"Swap"},{backgroundColor:d.graphs.diskIO.write,borderColor:"transparent",data:u(y,n,r),label:"Write"},{backgroundColor:d.graphs.diskIO.read,borderColor:"transparent",data:u(b,n,r),label:"Read"}],ariaLabel:"Disk I/O Graph",error:!l.Disk&&m||j,loading:g,nativeLegend:!0,showToday:s,subtitle:"ops/second",timezone:p,title:"Disk I/O",unit:" ops/second"})},I={read:[],swap:[],write:[]},Ze=(t,a)=>{if(!t)return I;if(a.toLowerCase()==="openvz")return{...I,error:"Disk I/O not available for OpenVZ systems."};const r=Object.values(t);return r.length===0?I:r.some(s=>s.childof!==0)?{...I,error:"Disk I/O is not applicable for this type of device."}:r.reduce((s,o)=>(o.isswap===1?s.swap=N(h([],["reads"],o),h([],["writes"],o)):(s.read=N(s.read,h([],["reads"],o)),s.write=N(s.write,h([],["writes"],o))),s),{...I})},Je=t=>{const{clientAPIKey:a,end:r,isToday:s,lastUpdated:o,lastUpdatedError:c,start:n,timezone:p}=t,d=E(),{data:l,error:m,loading:g,request:v}=G(["load"],a,n,r);i.useEffect(()=>{v()},[n,r,a,o,c]);const u=i.useCallback(R,[l,n,r]);return e.jsx(q,{data:[{backgroundColor:d.graphs.load,borderColor:"transparent",data:u(l.Load||[],n,r),label:"Load"}],ariaLabel:"Load Graph",error:m,loading:g,nativeLegend:!0,showToday:s,subtitle:"Target < 1.00",timezone:p,title:"Load"})},Xe=t=>{const{clientAPIKey:a,end:r,isToday:s,lastUpdated:o,lastUpdatedError:c,start:n,timezone:p}=t,d=E(),{data:l,error:m,loading:g,request:v}=G(["memory"],a,n,r);i.useEffect(()=>{v()},[n,r,a,o,c]);const u=i.useCallback(R,[l,n,r]),j=h([],["Memory","real","buffers"],l),b=h([],["Memory","real","cache"],l),f=Ye(h([],["Memory","real","used"],l),b,j),y=h([],["Memory","swap","used"],l),L=i.useMemo(()=>ke([j,b,f,y]),[j,b,f,y]);return e.jsx(q,{data:[{backgroundColor:d.graphs.memory.swap,borderColor:"transparent",data:u(y,n,r,z),label:"Swap"},{backgroundColor:d.graphs.memory.buffers,borderColor:"transparent",data:u(j,n,r,z),label:"Buffers"},{backgroundColor:d.graphs.memory.cache,borderColor:"transparent",data:u(b,n,r,z),label:"Cache"},{backgroundColor:d.graphs.memory.used,borderColor:"transparent",data:u(f,n,r,z),label:"Used"}],ariaLabel:"Memory Usage Graph",error:m,formatData:H=>ne(L,H),formatTooltip:H=>B(H).formatted,loading:g,nativeLegend:!0,showToday:s,subtitle:L,timezone:p,title:"Memory"})},Ye=(t,a,r)=>{const s=[],o=t.length;let c=0;for(c;c<o;c++){const n=h({},[c],t),p=h(0,[c,"y"],a),d=h(0,[c,"y"],r),l=Ce(n.y,d,p);s.push({x:n.x,y:l})}return s},et=i.memo(t=>{const{clientAPIKey:a,end:r,isToday:s,lastUpdated:o,lastUpdatedError:c,start:n,timezone:p}=t,d=E(),{data:l,error:m,loading:g,request:v}=G(["network"],a,n,r),u=i.useMemo(()=>Se(h({},["Interface"],l.Network)),[l.Network]);i.useEffect(()=>{v()},[n,r,a,o,c]);const j=i.useCallback(R,[l,n,r]),{rx_bytes:b,tx_bytes:f}=u,{formatNetwork:y,maxUnit:L}=Me(b,f);return e.jsx(q,{data:[{backgroundColor:d.graphs.network.inbound,borderColor:"transparent",data:j(b,n,r),label:"Inbound"},{backgroundColor:d.graphs.network.outbound,borderColor:"transparent",data:j(f,n,r),label:"Outbound"}],ariaLabel:"Network Usage Graph",error:m,formatData:y,formatTooltip:Le,loading:g,nativeLegend:!0,showToday:s,subtitle:L+"/s",timezone:p,title:"Network",unit:"/s"})}),tt=t=>{const a=E(),{clientAPIKey:r,lastUpdated:s,lastUpdatedError:o,timezone:c}=t,[n,p]=i.useState({end:0,start:0}),d=(g,v)=>{p({end:v,start:g})},l=ve(n.start,n.end),m={clientAPIKey:r,end:n.end,isToday:l,lastUpdated:s,lastUpdatedError:o,start:n.start,timezone:c};return e.jsxs(x,{container:!0,sx:{...S,padding:"8px"},children:[e.jsxs(rt,{xs:12,children:[e.jsx(x,{sx:{...S},children:e.jsx(je,{variant:"h2",children:"Resource Allocation History"})}),e.jsx(x,{sx:{...S,[a.breakpoints.down("lg")]:{marginLeft:a.spacing(),marginRight:a.spacing()}},children:e.jsx(at,{defaultValue:"Past 30 Minutes",handleStatsChange:d,hideLabel:!0,label:"Select Time Range"})})]}),e.jsx(x,{sx:{...S}}),e.jsx(x,{sx:{...S},xs:12,children:e.jsx(X,{sx:{marginBottom:`calc(${a.spacing(1)} + 3px)`,padding:`calc(${a.spacing(3)} + 1px)`},children:e.jsxs(x,{alignItems:"center",container:!0,direction:"row",justifyContent:"space-between",spacing:4,children:[e.jsx(x,{sx:{...S},sm:6,xs:12,children:e.jsx(Fe,{...m})}),e.jsx(x,{sx:{...S},sm:6,xs:12,children:e.jsx(Xe,{...m})}),e.jsx(x,{sx:{...S},sm:6,xs:12,children:e.jsx(et,{...m})}),e.jsx(x,{sx:{...S},sm:6,xs:12,children:e.jsx(Qe,{...m})}),e.jsx(x,{sx:{...S},sm:6,xs:12,children:e.jsx(Je,{...m})})]})})})]})},at=M(ge,{label:"StyledTimeRangeSelect"})({width:150}),rt=M(x,{label:"StyledGrid"})(({theme:t})=>({alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"space-between",marginBottom:t.spacing(1.25),boxSizing:"border-box"})),S={boxSizing:"border-box",margin:"0"},nt=M(J,{label:"StyledLink"})(({theme:t})=>({fontFamily:t.font.bold,fontSize:16,position:"relative",top:3})),st=i.memo(t=>{const{clientID:a,lastUpdatedError:r,topProcessesData:s,topProcessesError:o,topProcessesLoading:c}=t,n=o||r?"There was an error getting Top Processes.":void 0;return e.jsxs($,{lg:4,xs:12,children:[e.jsxs(se,{display:"flex",flexDirection:"row",justifyContent:"space-between",children:[e.jsx(w,{variant:"h2",children:"Top Processes"}),e.jsx(nt,{to:`/longview/clients/${a}/processes`,children:"View Details"})]}),e.jsx(A,{data:lt(s),order:"desc",orderBy:"cpu",preferenceKey:"top-processes",children:({data:p,handleOrderChange:d,order:l,orderBy:m})=>e.jsxs(V,{"aria-label":"List of Top Processes",spacingTop:16,children:[e.jsx(F,{children:e.jsxs(T,{children:[e.jsx(C,{active:m==="name","data-qa-table-header":"Process",direction:l,handleClick:d,label:"name",style:{width:"40%"},children:"Process"}),e.jsx(C,{active:m==="cpu","data-qa-table-header":"CPU",direction:l,handleClick:d,label:"cpu",style:{width:"25%"},children:"CPU"}),e.jsx(C,{active:m==="mem","data-qa-table-header":"Memory",direction:l,handleClick:d,label:"mem",style:{width:"15%"},children:"Memory"})]})}),e.jsx(O,{children:ot(p,c,n)})]})})]})}),ot=(t,a,r)=>r&&t.length===0?e.jsx(_,{colSpan:4,message:r}):a&&t.length===0?e.jsx(K,{columns:4}):t.length===0?e.jsx(W,{colSpan:4}):t.slice(0,6).map((s,o)=>e.jsx(it,{cpu:s.cpu,mem:s.mem,name:s.name},`longview-top-process-${o}`)),it=i.memo(t=>{const{cpu:a,mem:r,name:s}=t,o=r*1024;return e.jsxs(T,{ariaLabel:s,"data-testid":"longview-top-process-row",children:[e.jsx(k,{"data-qa-top-process-process":!0,parentColumn:"Process",children:s}),e.jsx(k,{"data-qa-top-process-cpu":!0,parentColumn:"CPU",children:be(a)}),e.jsx(k,{"data-qa-top-process-memory":!0,parentColumn:"Memory",children:B(o,{round:0}).formatted})]})}),lt=t=>{if(!t||!t.Processes)return[];const a=[];return Object.keys(t.Processes).forEach(r=>{Object.values(t.Processes[r]).forEach(s=>{a.push({...s,name:r})})}),a},ct=t=>{const{client:a,clientAPIKey:r,clientID:s,lastUpdated:o,lastUpdatedError:c,listeningPortsData:n,listeningPortsError:p,listeningPortsLoading:d,longviewClientData:l,timezone:m,topProcessesData:g,topProcessesError:v,topProcessesLoading:u}=t,[j,b]=i.useState(!1),f=p||c,y=f?h("Error retrieving data",[0,"reason"],f):void 0;return e.jsxs(i.Fragment,{children:[e.jsx(oe,{segment:"Overview"}),e.jsxs(x,{container:!0,spacing:2,children:[e.jsx($,{xs:12,children:e.jsx(X,{children:e.jsxs($,{alignItems:"flex-start",container:!0,justifyContent:"space-between",spacing:0,xs:12,children:[e.jsx(Ve,{client:a,longviewClientData:l,openPackageDrawer:()=>b(!0)}),e.jsx(Ue,{clientID:s,lastUpdatedError:c}),e.jsx(st,{clientID:s,lastUpdatedError:c,topProcessesData:g,topProcessesError:v,topProcessesLoading:u})]})})}),e.jsx(tt,{clientAPIKey:r,lastUpdated:o,lastUpdatedError:!!c,timezone:m}),e.jsxs($,{container:!0,justifyContent:"space-between",sx:{paddingLeft:0,paddingRight:0},xs:12,children:[e.jsx(We,{services:h([],["Ports","listening"],n),servicesError:y,servicesLoading:d&&!o}),e.jsx(De,{connections:h([],["Ports","active"],n),connectionsError:y,connectionsLoading:d&&!o})]})]}),e.jsx(he,{clientID:s,clientLabel:a,isOpen:j,onClose:()=>b(!1)})]})},Nt=i.memo(ct);export{ct as LongviewDetailOverview,Nt as default};
