import{ek as G,el as f,au as P,aN as _,em as k,s as u,B as v,r as p,q,j as l,da as H,a1 as U}from"./index-Eksrs3uK.js";import{d as W,A as $}from"./Autocomplete-XvrzKoAo.js";import{F as O}from"./Flag-kVTQNGw3.js";import{L as I}from"./ListItem-joIHQeyv.js";import{v as K}from"./visuallyHidden-DVicuktI.js";const R=e=>{if(!e)return"Other";const a=G[e.country.toUpperCase()];return a?f[a]??"Other":"Other"},L=(e,a)=>e.find(o=>a===o.id),Q=(e,a)=>{const o=L(e,a);if(o)return R(o)},z=e=>e===f.EU,se=({agreements:e,profile:a,regions:o,selectedRegionId:s})=>{if(o===void 0)return{selectedRegionGroup:void 0,showGDPRCheckbox:!1};const t=Q(o,s),n=!(a!=null&&a.restricted)&&!(e!=null&&e.eu_model)&&z(t);return{selectedRegionGroup:t,showGDPRCheckbox:n}},V="account-availability",Y=(e=!0)=>P([V,"unpaginated"],J,{enabled:e,keepPreviousData:!0}),J=()=>_((e,a)=>k(e,a))().then(e=>e.data),X=u(v,{label:"RegionSelect"})(({theme:e})=>({"& .MuiAutocomplete-groupLabel":{color:e.color.headline,fontFamily:e.font.bold,fontSize:"1rem",lineHeight:1,padding:"16px 4px 8px 10px",textTransform:"initial"},"& .MuiAutocomplete-listbox":{"& li:first-of-type .MuiAutocomplete-groupLabel":{marginTop:-8}}})),S=u("div",{label:"RegionSelectFlagContainer"})(({theme:e})=>({marginRight:e.spacing(1)}));u(I,{label:"RegionSelectParentListItem"})(()=>({"&.MuiListItem-root":{"&:first-of-type > div":{paddingTop:10},display:"block",padding:0}}));const Z=u(I,{label:"RegionSelectListItem"})(()=>({"&.Mui-disabled":{cursor:"not-allowed"},"&.MuiAutocomplete-option":{minHeight:"auto !important",padding:"8px 10px !important"},'&.MuiListItem-root[aria-disabled="true"]:active':{pointerEvents:"none !important"}})),ee=u(W,{label:"RegionSelectSelectedIcon",shouldForwardProp:e=>e!="visible"})(({visible:e})=>({height:17,marginLeft:"-2px",marginRight:"5px",visibility:e?"visible":"hidden",width:17})),b=f.NA,te=({accountAvailabilityData:e,currentCapability:a,regions:o})=>(a?o.filter(t=>t.capabilities.includes(a)):o).map(t=>{const n=R(t);return{data:{country:t.country,region:n},label:`${t.label} (${t.id})`,unavailable:N({accountAvailabilityData:e,currentCapability:a,region:t}),value:t.id}}).sort((t,n)=>t.data.region===b&&n.data.region!==b?-1:t.data.region!==b&&n.data.region===b?1:t.data.region<n.data.region?-1:t.data.region>n.data.region||t.data.country<n.data.country?1:t.data.country>n.data.country||t.label<n.label?-1:1),ae=({accountAvailabilityData:e,currentCapability:a,regions:o,selectedRegionId:s})=>{const t=L(o,s);if(!t)return;const n=R(t);return{data:{country:t==null?void 0:t.country,region:n},label:`${t.label} (${t.id})`,unavailable:N({accountAvailabilityData:e,currentCapability:a,region:t}),value:t.id}},N=({accountAvailabilityData:e,currentCapability:a,region:o})=>{if(!e||!a)return!1;const s=e.find(t=>t.region===o.id);return s?s.unavailable.includes(a):!1},de=p.memo(e=>{const{currentCapability:a,disabled:o,errorText:s,handleSelection:t,helperText:n,isClearable:D,label:j,regions:m,required:w,selectedId:h,width:E}=e,y=q(),{data:x,isLoading:F}=Y(y.dcGetWell),T=ae({accountAvailabilityData:x,currentCapability:a,regions:m,selectedRegionId:h??""})??null,[c,g]=p.useState(T),M=i=>{g(i),t(i==null?void 0:i.value)};p.useEffect(()=>{g(h?T:null)},[h]);const B=p.useMemo(()=>te({accountAvailabilityData:x,currentCapability:a,regions:m}),[x,a,m]);return l.jsx(X,{sx:{width:E},children:l.jsx($,{getOptionDisabled:i=>!!y.dcGetWell&&!!i.unavailable,isOptionEqualToValue:(i,{value:r})=>i.value===r,onChange:(i,r)=>{M(r)},onKeyDown:()=>{g(null)},renderOption:(i,r,{selected:A})=>{const d=!!y.dcGetWell&&!!r.unavailable;return l.jsx(H,{PopperProps:{sx:{"& .MuiTooltip-tooltip":{minWidth:215}}},title:d?l.jsxs(l.Fragment,{children:["There may be limited capacity in this region."," ",l.jsx(U,{to:"https://www.linode.com/global-infrastructure/availability",children:"Learn more"}),"."]}):"",disableFocusListener:!d,disableHoverListener:!d,disableTouchListener:!d,enterDelay:200,enterNextDelay:200,enterTouchDelay:200,children:l.jsx(Z,{...i,className:d?`${i.className} Mui-disabled`:i.className,componentsProps:{root:{"data-qa-option":r.value,"data-testid":r.value}},onClick:C=>d?C.preventDefault():i.onClick?i.onClick(C):null,"aria-disabled":void 0,children:l.jsxs(l.Fragment,{children:[l.jsxs(v,{alignItems:"center",display:"flex",flexGrow:1,children:[l.jsx(S,{children:l.jsx(O,{country:r.data.country})}),r.label,d&&l.jsx(v,{sx:K,children:"Disabled option - There may be limited capacity in this region. Learn more at https://www.linode.com/global-infrastructure/availability."})]}),A&&l.jsx(ee,{visible:A})]})})},r.value)},textFieldProps:{InputProps:{required:w,startAdornment:c&&l.jsx(S,{children:l.jsx(O,{country:c==null?void 0:c.data.country})})},tooltipText:n},autoHighlight:!0,clearOnBlur:!0,"data-testid":"region-select",disableClearable:!D,disabled:o,errorText:s,groupBy:i=>i.data.region,label:j??"Region",loading:F,loadingText:"Loading regions...",noOptionsText:"No results",options:B,placeholder:"Select a Region",value:c})})});export{de as R,se as a,Q as b,R as g,z as i};
