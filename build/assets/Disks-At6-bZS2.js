import{s as D,r as u,aW as C,j as t,T as O,cb as G,Q as F,E as M,eN as z}from"./index-Eksrs3uK.js";import{L as E}from"./LandingLoading-jDJ3d7aA.js";import{G as R,L,c as j,i as V,u as Y,d as B,e as N}from"./LongviewDetail-icjx983y.js";import"./LandingHeader-JXAVBhqg.js";import"./SafeTabPanel-S0Pp8CVT.js";import"./TabList-4PWL4GSj.js";import"./TabLinkList-BrXtJznm.js";import"./longview.container-N5k_O7w1.js";import"./useClientLastUpdated-a0PNleVi.js";import"./useAPIRequest-UcK5fafY.js";import"./immer.esm--MpJ8fpr.js";import"./LineGraph-UgU3EQj3.js";import"./utilities-JekaXHyt.js";import"./TableRow-phXfWUGW.js";import"./visuallyHidden-DVicuktI.js";import"./TableHead-Si_pzkLK.js";import"./over-27tc0FF7.js";import"./assocPath-nNkv7F8U.js";import"./set-2Chj4B2I.js";import"./sortBy-avzW26A0.js";import"./OrderBy-H-bWJCPy.js";import"./splitAt-pbTnq2Oi.js";import"./TableRowEmpty-aXmC67-Z.js";import"./TableRowError-8gKmGX7P.js";import"./TableRowLoading-iP7zIRHG.js";import"./Skeleton-iwmO4Yae.js";import"./TableSortCell-hcsagFzN.js";import"./useWindowDimensions-Dnr94FWA.js";const U=D("div",{label:"StyledDiv"})(({theme:r})=>({"& > div":{flexGrow:1,[r.breakpoints.down("lg")]:{marginTop:r.spacing(),width:"60%"},width:"33%"},display:"flex",flexFlow:"row wrap",justifyContent:"space-around",marginTop:r.spacing()})),Z=u.memo(r=>{var S,v;const{childOf:a,diskLabel:o,endTime:s,free:i,iFree:e,iTotal:n,isMounted:m,isSwap:f,loading:b,reads:g,startTime:p,sysInfoType:y,timezone:d,total:l,writes:h}=r,c=C(),x=V(p,s),T=H(y,f,m),k=u.useMemo(()=>A(i,l),[i,l]),w=u.useMemo(()=>_(e,n),[e,n]);return a?t.jsxs(O,{variant:"subtitle1",children:[t.jsx("strong",{children:o}),t.jsxs(u.Fragment,{children:[" ","Longview doesn't gather data on this type of device."]})]}):t.jsx(R,{helperText:T,title:o,children:t.jsxs(U,{children:[y.toLowerCase()!=="openvz"&&t.jsx("div",{"data-testid":"diskio-graph",children:t.jsx(L,{data:[{backgroundColor:c.graphs.diskIO.write,borderColor:"transparent",data:j(h,p,s,I),label:"Write"},{backgroundColor:c.graphs.diskIO.read,borderColor:"transparent",data:j(g,p,s,I),label:"Read"}],ariaLabel:"Disk I/O Graph",loading:b,nativeLegend:!0,showToday:x,subtitle:"ops/s",timezone:d,title:"Disk I/O"})}),!f&&m&&t.jsxs(u.Fragment,{children:[t.jsx("div",{"data-testid":"space-graph",children:t.jsx(L,{data:[{backgroundColor:c.graphs.space,borderColor:"transparent",data:j(k,p,s),label:"Space"}],ariaLabel:"Disk Space Graph",nativeLegend:!0,showToday:x,subtitle:"GB",suggestedMax:((S=l[0])==null?void 0:S.y)/1024/1024/1024,timezone:d,title:"Space"})}),t.jsx("div",{"data-testid":"inodes-graph",children:t.jsx(L,{data:[{backgroundColor:c.graphs.inodes,borderColor:"transparent",data:j(w,p,s),label:"Inodes"}],ariaLabel:"Inodes Graph",nativeLegend:!0,showToday:x,suggestedMax:(v=n[0])==null?void 0:v.y,timezone:d,title:"Inodes"})})]})]})})}),_=(r,a)=>a.map((o,s)=>{const{x:i,y:e}=o,{y:n}=G({x:0,y:null},[s],r),m=typeof e=="number"&&typeof n=="number"?+(e-n).toFixed(2):null;return{x:i,y:m}}),A=(r,a)=>r.map((o,s)=>{var n;const i=(n=a[s])==null?void 0:n.y,e=typeof o.y=="number"&&typeof i=="number"?+((i-o.y)/1024/1024/1024).toFixed(2):null;return{x:o.x,y:e}}),I=r=>typeof r=="number"?+r.toFixed(2):null,H=(r,a,o)=>r.toLowerCase()==="openvz"?"Longview doesn't gather Disk I/O on OpenVZ Linodes.":a?"Longview doesn't gather Space and Inode data on Swap disks.":o?"":"Longview doesn't gather Space and Inode data on unmounted disks.",W=r=>{var x,T,k,w;const{diskLabel:a,endTime:o,loading:s,startTime:i,stats:e,sysInfoType:n,timezone:m}=r,f=(e==null?void 0:e.isswap)??0,b=(e==null?void 0:e.childof)??0,g=(e==null?void 0:e.mounted)??0,p=((x=e==null?void 0:e.fs)==null?void 0:x.ifree)??[],y=((T=e==null?void 0:e.fs)==null?void 0:T.itotal)??[],d=((k=e==null?void 0:e.fs)==null?void 0:k.free)??[],l=((w=e==null?void 0:e.fs)==null?void 0:w.total)??[],h=(e==null?void 0:e.reads)??[],c=(e==null?void 0:e.writes)??[];return t.jsx(Z,{childOf:b!==0,diskLabel:a,endTime:o,free:d,iFree:p,iTotal:y,isMounted:g!==0,isSwap:f!==0,loading:s,reads:h,startTime:i,sysInfoType:n,timezone:m,total:l,writes:c})},$=r=>{const{clientAPIKey:a,clientLastUpdated:o,lastUpdated:s,lastUpdatedError:i}=r,[e,n]=u.useState({end:0,start:0}),m=(d,l)=>{n({end:l,start:d})},{data:f,error:b,loading:g,request:p}=Y(["disk","sysinfo"],a,e.start,e.end);u.useEffect(()=>{p()},[e.start,e.end,a,o,i,s]);const y=()=>{const d=f.Disk??{};if(b||i)return t.jsx(M,{errorText:"There was an error fetching statistics for your Disks."});if(g&&Object.keys(d).length===0)return t.jsx(E,{});const l=Object.keys(d).sort();return!g&&l.length===0?t.jsx(z,{renderAsSecondary:!0,title:"No disks detected",children:"The Longview agent has not detected any disks that it can monitor."}):l.map(h=>{var c;return t.jsx(W,{diskLabel:h,endTime:e.end,loading:g,startTime:e.start,stats:d[h],sysInfoType:((c=f.SysInfo)==null?void 0:c.type)??"",timezone:r.timezone},h)})};return t.jsxs("div",{children:[t.jsx(F,{segment:"Disks"}),t.jsx(B,{display:"flex",flexDirection:"row",justifyContent:"flex-end",children:t.jsx(N,{defaultValue:"Past 30 Minutes",handleStatsChange:m,hideLabel:!0,label:"Select Time Range",small:!0})}),y()]})},we=u.memo($);export{we as default};
