import{cc as ce,f4 as le,c9 as de,lb as ae,s as B,T as y,cg as A,cA as Y,cC as ue,d3 as ge,J as pe,ba as fe,aW as Z,j as s,aa as q,f as me,ad as ee,eM as O,bC as H,$ as he,a1 as J,ag as Se,r as x,_ as W,b as ke,u as xe,O as ye,e as be,N as je,c as Le,h as Ce,ak as De,Q as Ie,G as z,B as V,cb as ve,bq as _e,lc as Te,ld as Ee,dE as Pe}from"./index-Eksrs3uK.js";import{p as Ae,K as Q}from"./immer.esm--MpJ8fpr.js";import{_ as Be}from"./_contains-91K6xqrF.js";import{u as Ne,a as we}from"./uniq-xa8_MmzW.js";import{S as K}from"./SafeTabPanel-S0Pp8CVT.js";import{T as Re}from"./TabLinkList-BrXtJznm.js";import{a as Me,T as Oe}from"./TabList-4PWL4GSj.js";import{u as ze}from"./configs-3PoBJaCX.js";import{u as Qe}from"./disks-ZTjtBBb6.js";import{M as $e,N as qe}from"./Notifications-N8OobC9R.js";import{L as We}from"./LinodeSelect-y7DOgXsC.js";import{a as Fe}from"./append-Xa6QMsiD.js";import{p as Ge}from"./pickBy-ZiFDTica.js";import{L as $}from"./ListItem-joIHQeyv.js";var He=ce(function(i){return le(i.length,function(o,n){var r=Array.prototype.slice.call(arguments,0);return r[0]=n,r[1]=o,i.apply(this,r)})}),Je=de(function(i,o){var n,r;return i.length>o.length?(n=i,r=o):(n=o,r=i),Ne(ae(He(Be)(n),r))});const U=B("button",{label:"StyledButton"})(({theme:e})=>({"& path":{fill:e.palette.primary.main},alignItems:"center",backgroundColor:e.color.white,border:"none",cursor:"pointer",display:"flex",paddingBottom:0,paddingTop:0})),Ve=B(y,{label:"StyledTypography"})(({theme:e})=>({"& a":{color:e.color.red,textDecoration:"underline"},color:e.color.red,marginTop:e.spacing(1)})),Ke=B("header",{label:"StyledHeader"})(({theme:e})=>({display:"flex",flexDirection:"row",justifyContent:"space-between",marginBottom:e.spacing(2)})),Ue=B("div",{label:"StyledDiv"})({alignItems:"center",display:"flex",justifyContent:"space-between",width:"100%"}),Xe=(e,i)=>{switch(i.type){case"toggleConfig":if(!e.configSelection[i.id])break;const o=e.configSelection[i.id].isSelected;e.configSelection[i.id].isSelected=!o,e.errors=void 0;break;case"toggleDisk":if(!e.diskSelection[i.id])break;const n=e.diskSelection[i.id].isSelected;e.diskSelection[i.id].isSelected=!n,e.errors=void 0;break;case"setSelectedLinodeId":e.selectedLinodeId=i.id,e.errors=void 0;break;case"setSubmitting":e.isSubmitting=i.value;break;case"setErrors":e.errors=i.errors;break;case"clearAll":e.configSelection=A(u=>({...u,isSelected:!1}),e.configSelection),e.diskSelection=A(u=>({...u,isSelected:!1}),e.diskSelection),e.selectedLinodeId=null,e.errors=void 0;break;case"syncConfigsDisks":const{configs:r,disks:a}=i,l=X(e.configSelection),p=X(e.diskSelection),{configSelection:m,diskSelection:h}=es(r,a,l,p);e.configSelection=m,e.diskSelection=h;break}},Ye=Ae(Xe),Ze={configSelection:{},diskSelection:{},isSubmitting:!1,selectedLinodeId:null},X=e=>Y(A(i=>Number(i)),ue,Ge(i=>i.isSelected))(e),es=(e,i,o=[],n=[])=>{const r={},a={},l={};return e.forEach(p=>{const m=o.includes(p.id),u=se(p,i).map(g=>g.id);u.forEach(g=>{l[g]||(l[g]=[]),l[g].push(p.id)}),r[p.id]={associatedDiskIds:u,isSelected:m}}),i.forEach(p=>{const m=n.includes(p.id),h=l[p.id]||[];a[p.id]={associatedConfigIds:h,isSelected:m}}),{configSelection:r,diskSelection:a}},se=(e,i)=>{const o=[];return Object.keys(e.devices).forEach(n=>{e.devices[n]&&e.devices[n].disk_id&&o.push(e.devices[n].disk_id)}),i.filter(n=>o.includes(n.id))},ss=(e,i)=>e.map(o=>{const n=se(o,i);return{...o,associatedDisks:n}}),ts=(e,i)=>Y(we(o=>o.id),ge,Fe(i),A(o=>o.associatedDisks))(e),is=(e,i)=>{const n=Math.ceil((i==="sameDatacenter"?.75:10)*e/1024),r=pe.utc();let l=r.plus({minutes:n,seconds:n>0?1:0}).toRelative(r.toObject());const p="in ";return l!=null&&l.startsWith(p)&&(l=l==null?void 0:l.substring(p.length)),l},ns=e=>{const{clearAll:i,currentLinodeId:o,errorMap:n,handleCancel:r,handleClone:a,handleSelectLinode:l,handleToggleConfig:p,handleToggleDisk:m,isSubmitting:h,selectedConfigs:u,selectedDisks:g,selectedLinodeId:S,selectedLinodeRegion:N,thisLinodeRegion:C}=e,{data:d}=fe(),f=d==null?void 0:d.find(c=>c.id===C),D=Z(),b=n.none,j=n.disk_size,I=!!(b&&b.match(/free space/));let k=I?b:j;k&&!k.endsWith(".")&&(k+=".");const E={resize:`/linodes/${S}/resize`,shrink:`/linodes/${S}/advanced`},L=u.length>0||g.length>1,v=u.length===0&&g.length===0||!S||L&&S===o,P=ts(u,g).reduce((c,T)=>c+T.size,0),_=is(P,C===N?"sameDatacenter":"differentDatacenter");return s.jsxs(q,{"data-testid":"config-clone-selection-details",sx:{padding:D.spacing(2)},children:[s.jsxs(Ke,{children:[s.jsx(y,{variant:"h2",children:"Selected"}),s.jsx(me,{buttonType:"secondary",compactX:!0,onClick:i,sx:{top:`-${D.spacing(.5)}`},children:"Clear"})]}),b&&!I&&s.jsx(ee,{text:b,variant:"error"}),s.jsx(O,{children:u.map(c=>s.jsxs($,{dense:!0,disableGutters:!0,sx:{flexWrap:"wrap",justifyContent:"space-between"},children:[s.jsxs(Ue,{children:[s.jsx(y,{variant:"h3",children:c.label}),s.jsx(U,{"data-qa-inline-delete":!0,onClick:()=>p(c.id),children:s.jsx(H,{})})]}),s.jsx(O,{sx:{flexBasis:"100%",marginLeft:D.spacing(2)},children:c.associatedDisks.map(T=>s.jsx($,{dense:!0,disableGutters:!0,children:s.jsx(y,{children:T.label})},T.label))})]},c.id))}),s.jsx(O,{children:g.map(c=>s.jsxs($,{dense:!0,disableGutters:!0,sx:{flexWrap:"wrap",justifyContent:"space-between"},children:[s.jsx(y,{variant:"h3",children:c.label}),s.jsx(U,{"data-qa-inline-delete":!0,onClick:()=>m(c.id),children:s.jsx(H,{})})]},c.id))}),(u.length>0||g.length>0)&&s.jsx(he,{spacingBottom:16,spacingTop:16}),s.jsxs(y,{"data-testid":`current-datacenter-${f==null?void 0:f.id}`,children:["Current Data Center: ",(f==null?void 0:f.label)??C]}),!v&&s.jsxs(y,{children:["Estimated time: ",_]}),s.jsx(We,{onSelectionChange:c=>{c!==null&&l(c.id)},optionsFilter:L?c=>c.id!==o:void 0,clearable:!1,errorText:k,placeholder:"Destination",value:S}),k&&s.jsxs(Ve,{variant:"body1",children:[k," ",s.jsx(J,{to:E.shrink,children:"Shrink your existing disks"})," ","or"," ",s.jsx(J,{to:E.resize,children:"resize your Linode to a larger plan."})]}),s.jsx(Se,{primaryButtonProps:{disabled:v,label:"Clone",loading:h,onClick:a},secondaryButtonProps:{label:"Cancel",onClick:r}})]})},os=x.lazy(()=>W(()=>import("./Configs-TmeDL4BF.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),rs=x.lazy(()=>W(()=>import("./Disks-az92205i.js"),__vite__mapDeps([7,1,2,3,4,5,6,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53]))),cs=x.lazy(()=>W(()=>import("./LinodeDetailHeader-DlhTuBJs.js"),__vite__mapDeps([54,1,2,55,56,57,58,9,40,59,60,13,61,45,46,5,6,62,63,29,64,65,66,8,67,68,69,70,71,72,25,73,74,75,76,77,42,78,27,32,22,33,26,34,28,35,36,37,4,23,24,43,79,80,16,81,82,83,84,85,18,19,20,21,3,30,31,38,39,41,44,86,87,88,89,90,91,92,93,94,95,96,97,15,98,99,100,101,102,11,10,103,104,105,106,107,108,109,110,111,112,113,114,115,116,17,47,48,49,50]))),ls=()=>{const{linodeId:e}=ke(),i=xe(),o=ye(),n=be(),r=Z(),a=Number(e),{data:l}=ze(a),{data:p}=Qe(a),{data:m}=je(),{data:h}=Le(a),u=l??[],g=p??[],S=[{routeName:`${o.url}/configs`,title:"Configuration Profiles"},{routeName:`${o.url}/disks`,title:"Disks"}],N=t=>!!_e(t,{path:n.pathname}),C=t=>{i.push(S[t].routeName)},[d,f]=x.useReducer(Ye,Ze),D=JSON.stringify(u.map(t=>t.id)),b=JSON.stringify(g.map(t=>t.id));x.useEffect(()=>{f({configs:u,disks:g,type:"syncConfigsDisks"})},[D,b]);const j=x.useMemo(()=>Ce(n.search),[n.search]);x.useEffect(()=>{const t=Number(j.selectedConfig);if(t&&u)return f({id:t,type:"toggleConfig"})},[j,u]),x.useEffect(()=>{const t=Number(j.selectedDisk);if(t&&g)return f({id:t,type:"toggleDisk"})},[j,g]);const I=t=>f({id:t,type:"toggleConfig"}),k=t=>f({id:t,type:"toggleDisk"}),E=t=>f({id:t,type:"setSelectedLinodeId"}),L=t=>f({type:"setSubmitting",value:t}),v=t=>f({errors:t,type:"setErrors"}),F=()=>f({type:"clearAll"}),P=u.filter(t=>d.configSelection.hasOwnProperty(t.id)),w=P.filter(t=>d.configSelection[t.id].isSelected),_=w.map(t=>t.id),c=g.filter(t=>d.diskSelection.hasOwnProperty(t.id)),R=c.filter(t=>d.diskSelection[t.id].isSelected).map(t=>t.id),te=()=>{if(!d.selectedLinodeId)return;let t;if(d.selectedLinodeId===a){if(R.length!==1)return;t=()=>Te(a,R[0])}else{const M=a,re=d.selectedLinodeId;t=()=>Ee(M,{configs:_,disks:R,linode_id:re})}L(!0),v(void 0),t().then(()=>{L(!1),Pe(),i.push(`/linodes/${a}/configurations`)}).catch(M=>{L(!1),v(M)})},ie=()=>{i.push(`/linodes/${a}/configurations`)},ne=De(["disk_size"],Q(d.errors)),G=m==null?void 0:m.find(t=>t.id===d.selectedLinodeId),oe=G&&G.region;return s.jsxs(x.Fragment,{children:[s.jsx(Ie,{segment:"Clone"}),s.jsx($e,{linodeId:a}),s.jsx(qe,{}),s.jsx(cs,{}),s.jsx(q,{sx:{padding:r.spacing(2)},children:s.jsxs(z,{container:!0,justifyContent:"space-between",sx:{marginTop:r.spacing(1)},children:[s.jsx(z,{md:7,xs:12,children:s.jsxs(q,{sx:{padding:0},children:[s.jsx(y,{"aria-level":2,"data-qa-title":!0,role:"heading",sx:{marginBottom:r.spacing(2)},variant:"h2",children:"Clone"}),s.jsxs(Me,{index:Math.max(S.findIndex(t=>N(t.routeName)),0),onChange:C,children:[s.jsx(Re,{tabs:S}),s.jsxs(Oe,{children:[s.jsx(K,{index:0,children:s.jsx(V,{children:s.jsx(os,{configSelection:Q(d.configSelection),configs:P,handleSelect:I})})}),s.jsx(K,{index:1,children:s.jsxs(V,{children:[s.jsx(ee,{spacingTop:16,variant:"info",children:"You can make a copy of a disk to the same or different Linode. We recommend you power off your Linode first, and keep it powered off until the disk has finished being cloned."}),s.jsx("div",{children:s.jsx(rs,{diskSelection:Q(d.diskSelection),disks:c,handleSelect:k,selectedConfigIds:_})})]})})]})]})]})}),s.jsx(z,{md:4,xs:12,children:s.jsx(ns,{selectedConfigs:ss(w,g),selectedDisks:c.filter(t=>d.diskSelection[t.id].isSelected&&Je(ve([],[t.id,"associatedConfigIds"],d.diskSelection),_).length===0),clearAll:F,currentLinodeId:a,errorMap:ne,handleCancel:ie,handleClone:te,handleSelectLinode:E,handleToggleConfig:I,handleToggleDisk:k,isSubmitting:d.isSubmitting,selectedLinodeId:d.selectedLinodeId,selectedLinodeRegion:oe,thisLinodeRegion:(h==null?void 0:h.region)??""})})]})})]})},Ls=Object.freeze(Object.defineProperty({__proto__:null,default:ls},Symbol.toStringTag,{value:"Module"}));export{Ls as C,Je as i};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/Configs-TmeDL4BF.js","assets/index-Eksrs3uK.js","assets/index-RL6WRErT.css","assets/Paginate-XLm_-WxT.js","assets/PaginationFooter-NHWf7fW2.js","assets/TableRow-phXfWUGW.js","assets/TableRowEmpty-aXmC67-Z.js","assets/Disks-az92205i.js","assets/TableHead-Si_pzkLK.js","assets/immer.esm--MpJ8fpr.js","assets/_contains-91K6xqrF.js","assets/uniq-xa8_MmzW.js","assets/SafeTabPanel-S0Pp8CVT.js","assets/TabList-4PWL4GSj.js","assets/TabLinkList-BrXtJznm.js","assets/configs-3PoBJaCX.js","assets/disks-ZTjtBBb6.js","assets/Notifications-N8OobC9R.js","assets/LinodeDisks-jJddYOGd.js","assets/AddNewLink-LwviGK8c.js","assets/OrderBy-H-bWJCPy.js","assets/splitAt-pbTnq2Oi.js","assets/TableRowError-8gKmGX7P.js","assets/TableRowLoading-iP7zIRHG.js","assets/Skeleton-iwmO4Yae.js","assets/TableSortCell-hcsagFzN.js","assets/formik.esm-Kap5lsIh.js","assets/Autocomplete-XvrzKoAo.js","assets/Drawer-A9yKjC3Z.js","assets/Radio-HudVgwMW.js","assets/RadioGroup-zpRjMzXK.js","assets/formikErrorUtils-jhqfCjwU.js","assets/AccessPanel-rD0WgXZZ.js","assets/CreateSSHKeyDrawer-NnwCGTeL.js","assets/Code-HuerkG4_.js","assets/formikTrimUtil-tfsUpEEv.js","assets/getAPIErrorFor-OfQrArkQ.js","assets/usePagination-Sxr0Tlb7.js","assets/ImageSelect-L2KD_WsZ.js","assets/cond-gNmMu4CH.js","assets/groupBy-7jUcQ2cf.js","assets/LinodePermissionsError-htxzmi5m.js","assets/DateTimeDisplay-bXC9mIcz.js","assets/ActionMenu-4CPisA_2.js","assets/InlineMenuAction-d5mRENST.js","assets/TextTooltip-SPU6hUyt.js","assets/ListItem-joIHQeyv.js","assets/MaintenanceBanner-5tjriDAX.js","assets/accountMaintenance-hC6-dGbb.js","assets/isPast-netbmlWS.js","assets/useDialog-Tn1TxMfw.js","assets/LinodeSelect-y7DOgXsC.js","assets/append-Xa6QMsiD.js","assets/pickBy-ZiFDTica.js","assets/LinodeDetailHeader-DlhTuBJs.js","assets/LandingHeader-JXAVBhqg.js","assets/ProductInformationBanner-NRgFHJLr.js","assets/DeleteLinodeDialog-APAsoTxA.js","assets/LinodeActionMenu-bV6ckFLX.js","assets/PlansPanel-EH5ViSTx.js","assets/TabbedPanel-IicwaI6L.js","assets/PlanInformation-CouBULD4.js","assets/constants-KokzTiEs.js","assets/Currency-No8tnN7b.js","assets/SelectionCard-IyO-o1CU.js","assets/dynamicPricing-n5eCZqTg.js","assets/linodes-orSDvVk7.js","assets/arePropsEqual-WL8SjyyC.js","assets/getSelectedOptionFromGroupedOptions-4YyATpGV.js","assets/RenderGuard-iLW_eACV.js","assets/image.helpers-5SOq-oMg.js","assets/CommonStackScript.styles-tUmBO9fs.js","assets/index-C8Ov-8_e.js","assets/DebouncedSearchTextField-EUZwzd3g.js","assets/ResourcesSection-fJQ13r7x.js","assets/StackScript-_ub41xk0.js","assets/CopyTooltip-mIyzAQ7E.js","assets/index-Y5esPPk-.js","assets/ShowMoreExpansion-5I3PKpip.js","assets/lishUtils-OjFanRCH.js","assets/linodes--kIa80QO.js","assets/RegionSelect-_Z8IGlox.js","assets/Flag-kVTQNGw3.js","assets/Flag-_y0A-gKD.css","assets/visuallyHidden-DVicuktI.js","assets/scrollErrorIntoView-6n4Cku1Y.js","assets/backups-brLSog0e.js","assets/DisplayPrice-SNYRHKEX.js","assets/TypeToConfirm-koQ3u5up.js","assets/validatePassword-C5jRG3TY.js","assets/main-SCnYvbUf.js","assets/assocPath-nNkv7F8U.js","assets/firewalls-zJDfBkPC.js","assets/DeviceSelection-JvpNAIro.js","assets/FormControl-CNHz4Ctl.js","assets/TagsPanel-CYEBNrGy.js","assets/tags-kBUFHmv1.js","assets/utils-x4yn563A.js","assets/PublicIpsUnassignedTooltip-A07mEsGp.js","assets/LinodeIPAddresses-BzUB11OC.js","assets/vpcs-qp5yIH1u.js","assets/ipaddr-jlottelM.js","assets/remove-KHZAQMPH.js","assets/_isFunction-X3ooR5X_.js","assets/over-27tc0FF7.js","assets/set-2Chj4B2I.js","assets/view-I-40yLKJ.js","assets/StatusIcon-RuV8PvAV.js","assets/recentEventForLinode-oZMi36YZ.js","assets/IPAddress-ZmG9OcMn.js","assets/ShowMore-4P5e_z46.js","assets/ipUtils-P4y3JNCT.js","assets/RegionIndicator-N3gnZFRh.js","assets/constants-jI3mcPVd.js","assets/TypeToConfirmDialog-9yjZCCL0.js","assets/useEditableLabelState-CfKjpK1t.js","assets/EnableBackupsDialog-5TgOa3Ei.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}