import{r as n,m as W,av as k,ao as D,j as a,bI as P,C as z,b0 as $,T as A,bM as C}from"./index-Eksrs3uK.js";import{u as F,a as _}from"./tags-kBUFHmv1.js";const O=t=>n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:19,height:18,viewBox:"0 0 19 18",...t},n.createElement("path",{fill:"currentColor",d:"M21.796 28.868L21.796 21.128 29.14 21.128 29.14 18.698 21.796 18.698 21.796 11.012 19.186 11.012 19.186 18.698 11.878 18.698 11.878 21.128 19.186 21.128 19.186 28.868z",transform:"translate(-11 -11)"})),R=W()(t=>({"@keyframes fadeIn":{from:{opacity:0},to:{opacity:1}},addButtonWrapper:{display:"flex",justifyContent:"flex-start",width:"100%"},addTagButton:{"& svg":{color:t.color.tagIcon,height:10,marginLeft:10,width:10},alignItems:"center",backgroundColor:t.color.tagButton,border:"none",borderRadius:3,color:t.textColors.linkActiveLight,cursor:"pointer",display:"flex",fontFamily:t.font.bold,fontSize:"0.875rem",justifyContent:"center",padding:"7px 10px",whiteSpace:"nowrap"},errorNotice:{"& .noticeText":{fontFamily:'"LatoWeb", sans-serif'},animation:"$fadeIn 225ms linear forwards",borderLeft:`5px solid ${t.palette.error.dark}`,marginTop:20,paddingLeft:10,textAlign:"left"},hasError:{marginTop:0},loading:{opacity:.4},progress:{alignItems:"center",display:"flex",height:"100%",justifyContent:"center",position:"absolute",width:"100%",zIndex:2},selectTag:{"& .error-for-scroll > div":{flexDirection:"row",flexWrap:"wrap-reverse"},"& .input":{"& p":{borderLeft:"none",color:t.color.grey1,fontSize:".9rem"}},"& .react-select__input":{backgroundColor:"transparent",color:t.palette.text.primary,fontSize:".9rem"},"& .react-select__value-container":{padding:"6px"},animation:"$fadeIn .3s ease-in-out forwards",marginTop:-3.5,minWidth:275,position:"relative",textAlign:"left",width:"100%",zIndex:3},tag:{marginRight:4,marginTop:t.spacing(.5)},tagsPanelItemWrapper:{marginBottom:t.spacing(),position:"relative"}})),q=t=>{const{classes:r,cx:x}=R(),{disabled:T,tags:i,updateTags:b}=t,E=k(),[c,o]=n.useState(""),[y,v]=n.useState(!1),[S,d]=n.useState(!1),{data:u}=D(),{data:l,error:j,isLoading:I}=F(!(u!=null&&u.restricted)),L=n.useMemo(()=>l==null?void 0:l.filter(e=>!i.some(g=>g===e.label)).map(e=>({label:e.label,value:e.label})),[l,i]);n.useEffect(()=>{o("")},[y]);const p=()=>{T||v(e=>!e)},w=j?"There was an error retrieving your tags.":"",B=e=>{d(!0);const g=i.filter(s=>s!==e);b(g).then(()=>{o("")}).catch(s=>{const f=C(s,"Error while deleting tag");o(f)}).finally(()=>{d(!1)})},N=(e,g)=>{const s=e&&e.value;if(g.action!=="select-option"&&g.action!=="create-option")return;const f=m=>i.some(h=>h===m);p(),s.length<3||s.length>50?o(`Tag "${s}" length must be 3-50 characters`):f(s)?o(`Tag "${s}" is a duplicate`):(o(""),d(!0),b([...i,e.label].sort()).then(()=>{l&&_([...l,e],E)}).catch(m=>{const h=C(m,"Error while creating tag");o(h)}).finally(()=>{d(!1)}))};return a.jsxs(a.Fragment,{children:[y?a.jsx(P,{autoFocus:!0,blurInputOnSelect:!0,className:r.selectTag,creatable:!0,createOptionPosition:"first",escapeClearsValue:!0,hideLabel:!0,isLoading:I,label:"Create or Select a Tag",onBlur:p,onChange:N,options:L,placeholder:"Create or Select a Tag"}):a.jsx("div",{className:x({[r.addButtonWrapper]:!0,[r.hasError]:c.length>0}),children:a.jsxs("button",{className:r.addTagButton,onClick:p,title:"Add a tag",children:["Add a tag",a.jsx(O,{})]})}),a.jsxs("div",{className:r.tagsPanelItemWrapper,children:[S&&a.jsx("div",{className:r.progress,children:a.jsx(z,{mini:!0})}),i.map(e=>a.jsx($,{className:x({[r.loading]:S,[r.tag]:!0}),colorVariant:"lightBlue",label:e,maxLength:30,onDelete:T?void 0:()=>B(e)},`tag-item-${e}`)),(c.length>0||w.length>0)&&a.jsx(A,{className:r.errorNotice,children:c.length>0?c:w})]})]})};export{O as S,q as T};
