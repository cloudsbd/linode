import{r as b,bP as U,bQ as z,s as k,bT as v,bX as O,bR as q,j as e,bY as N,b_ as G,bU as fe,iQ as Be,bZ as Ce,cf as je,B as te,f as V,a0 as $,T as S,d0 as B,iR as Se,ag as K,iS as Ne,bB as P,iT as De,c1 as Ve,aW as He,bD as Ue,iU as W,fG as ze,b1 as Q,c3 as ee,iV as Te,a1 as Le,bN as D,a4 as ye,bC as Re,aa as ke,iW as Oe,$ as re,bJ as qe,Q as Ge,iX as We}from"./index-Eksrs3uK.js";import{a as _,b as Qe,u as X,y as ie,g as ae,F as Ye,c as Ke}from"./formik.esm-Kap5lsIh.js";import{L as Xe}from"./LandingHeader-JXAVBhqg.js";import{b as Je,A as Ze,a as et}from"./constants--Twc5yrJ.js";import{A as Y,S as tt}from"./Autocomplete-XvrzKoAo.js";import{D as ce}from"./Drawer-A9yKjC3Z.js";import{R as H}from"./Radio-HudVgwMW.js";import{R as de}from"./RadioGroup-zpRjMzXK.js";import{R as ue,g as ot}from"./utils-d72dx4mb.js";import{C as Z,p as he}from"./constants-_Z1avj-R.js";import{A as Ie}from"./ActionMenu-4CPisA_2.js";import{b as Pe,T as oe,a as y,c as $e}from"./TableRow-phXfWUGW.js";import{T as Ae}from"./TableRowEmpty-aXmC67-Z.js";import{T as _e}from"./TableHead-Si_pzkLK.js";import{T as nt}from"./TextTooltip-SPU6hUyt.js";import{i as rt,S as A,p as xe,a as be,E as at,A as st}from"./EndpointTable-tENENXjc.js";import{F as lt}from"./FormLabel-2wEwBKx7.js";import{T as it}from"./Toggle-AbahDP9J.js";import{L as ct}from"./LoadBalancerRegions-YhP1KVZs.js";import"./vpcs-SI1JeFoo.js";import"./stackscripts-7LZsSbBg.js";import"./LoadBalancerRegions-BPkF2TzX.js";import"./Flag-kVTQNGw3.js";const dt=b.createContext({}),J=dt,pt=b.createContext({}),ne=pt;function ut(t){return U("MuiStep",t)}z("MuiStep",["root","horizontal","vertical","alternativeLabel","completed"]);const ht=["active","children","className","component","completed","disabled","expanded","index","last"],xt=t=>{const{classes:o,orientation:r,alternativeLabel:l,completed:a}=t;return G({root:["root",r,l&&"alternativeLabel",a&&"completed"]},ut,o)},bt=k("div",{name:"MuiStep",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:r}=t;return[o.root,o[r.orientation],r.alternativeLabel&&o.alternativeLabel,r.completed&&o.completed]}})(({ownerState:t})=>v({},t.orientation==="horizontal"&&{paddingLeft:8,paddingRight:8},t.alternativeLabel&&{flex:1,position:"relative"})),gt=b.forwardRef(function(o,r){const l=O({props:o,name:"MuiStep"}),{active:a,children:i,className:c,component:s="div",completed:n,disabled:d,expanded:p=!1,index:u,last:h}=l,m=q(l,ht),{activeStep:C,connector:j,alternativeLabel:I,orientation:T,nonLinear:L}=b.useContext(J);let[x=!1,f=!1,g=!1]=[a,n,d];C===u?x=a!==void 0?a:!0:!L&&C>u?f=n!==void 0?n:!0:!L&&C<u&&(g=d!==void 0?d:!0);const R=b.useMemo(()=>({index:u,last:h,expanded:p,icon:u+1,active:x,completed:f,disabled:g}),[u,h,p,x,f,g]),w=v({},l,{active:x,orientation:T,alternativeLabel:I,completed:f,disabled:g,expanded:p,component:s}),F=xt(w),E=e.jsxs(bt,v({as:s,className:N(F.root,c),ref:r,ownerState:w},m,{children:[j&&I&&u!==0?j:null,i]}));return e.jsx(ne.Provider,{value:R,children:j&&!I&&u!==0?e.jsxs(b.Fragment,{children:[j,E]}):E})}),ge=gt,mt=fe(e.jsx("path",{d:"M12 0a12 12 0 1 0 0 24 12 12 0 0 0 0-24zm-2 17l-5-5 1.4-1.4 3.6 3.6 7.6-7.6L19 8l-9 9z"}),"CheckCircle"),vt=fe(e.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}),"Warning");function ft(t){return U("MuiStepIcon",t)}const Ct=z("MuiStepIcon",["root","active","completed","error","text"]),se=Ct;var me;const jt=["active","className","completed","error","icon"],St=t=>{const{classes:o,active:r,completed:l,error:a}=t;return G({root:["root",r&&"active",l&&"completed",a&&"error"],text:["text"]},ft,o)},le=k(Be,{name:"MuiStepIcon",slot:"Root",overridesResolver:(t,o)=>o.root})(({theme:t})=>({display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),color:(t.vars||t).palette.text.disabled,[`&.${se.completed}`]:{color:(t.vars||t).palette.primary.main},[`&.${se.active}`]:{color:(t.vars||t).palette.primary.main},[`&.${se.error}`]:{color:(t.vars||t).palette.error.main}})),Tt=k("text",{name:"MuiStepIcon",slot:"Text",overridesResolver:(t,o)=>o.text})(({theme:t})=>({fill:(t.vars||t).palette.primary.contrastText,fontSize:t.typography.caption.fontSize,fontFamily:t.typography.fontFamily})),Lt=b.forwardRef(function(o,r){const l=O({props:o,name:"MuiStepIcon"}),{active:a=!1,className:i,completed:c=!1,error:s=!1,icon:n}=l,d=q(l,jt),p=v({},l,{active:a,completed:c,error:s}),u=St(p);if(typeof n=="number"||typeof n=="string"){const h=N(i,u.root);return s?e.jsx(le,v({as:vt,className:h,ref:r,ownerState:p},d)):c?e.jsx(le,v({as:mt,className:h,ref:r,ownerState:p},d)):e.jsxs(le,v({className:h,ref:r,ownerState:p},d,{children:[me||(me=e.jsx("circle",{cx:"12",cy:"12",r:"12"})),e.jsx(Tt,{className:u.text,x:"12",y:"12",textAnchor:"middle",dominantBaseline:"central",ownerState:p,children:n})]}))}return n}),we=Lt;function yt(t){return U("MuiStepLabel",t)}const Rt=z("MuiStepLabel",["root","horizontal","vertical","label","active","completed","error","disabled","iconContainer","alternativeLabel","labelContainer"]),M=Rt,kt=["children","className","componentsProps","error","icon","optional","slotProps","StepIconComponent","StepIconProps"],It=t=>{const{classes:o,orientation:r,active:l,completed:a,error:i,disabled:c,alternativeLabel:s}=t;return G({root:["root",r,i&&"error",c&&"disabled",s&&"alternativeLabel"],label:["label",l&&"active",a&&"completed",i&&"error",c&&"disabled",s&&"alternativeLabel"],iconContainer:["iconContainer",l&&"active",a&&"completed",i&&"error",c&&"disabled",s&&"alternativeLabel"],labelContainer:["labelContainer",s&&"alternativeLabel"]},yt,o)},Pt=k("span",{name:"MuiStepLabel",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:r}=t;return[o.root,o[r.orientation]]}})(({ownerState:t})=>v({display:"flex",alignItems:"center",[`&.${M.alternativeLabel}`]:{flexDirection:"column"},[`&.${M.disabled}`]:{cursor:"default"}},t.orientation==="vertical"&&{textAlign:"left",padding:"8px 0"})),$t=k("span",{name:"MuiStepLabel",slot:"Label",overridesResolver:(t,o)=>o.label})(({theme:t})=>v({},t.typography.body2,{display:"block",transition:t.transitions.create("color",{duration:t.transitions.duration.shortest}),[`&.${M.active}`]:{color:(t.vars||t).palette.text.primary,fontWeight:500},[`&.${M.completed}`]:{color:(t.vars||t).palette.text.primary,fontWeight:500},[`&.${M.alternativeLabel}`]:{marginTop:16},[`&.${M.error}`]:{color:(t.vars||t).palette.error.main}})),At=k("span",{name:"MuiStepLabel",slot:"IconContainer",overridesResolver:(t,o)=>o.iconContainer})(()=>({flexShrink:0,display:"flex",paddingRight:8,[`&.${M.alternativeLabel}`]:{paddingRight:0}})),_t=k("span",{name:"MuiStepLabel",slot:"LabelContainer",overridesResolver:(t,o)=>o.labelContainer})(({theme:t})=>({width:"100%",color:(t.vars||t).palette.text.secondary,[`&.${M.alternativeLabel}`]:{textAlign:"center"}})),Fe=b.forwardRef(function(o,r){var l;const a=O({props:o,name:"MuiStepLabel"}),{children:i,className:c,componentsProps:s={},error:n=!1,icon:d,optional:p,slotProps:u={},StepIconComponent:h,StepIconProps:m}=a,C=q(a,kt),{alternativeLabel:j,orientation:I}=b.useContext(J),{active:T,disabled:L,completed:x,icon:f}=b.useContext(ne),g=d||f;let R=h;g&&!R&&(R=we);const w=v({},a,{active:T,alternativeLabel:j,completed:x,disabled:L,error:n,orientation:I}),F=It(w),E=(l=u.label)!=null?l:s.label;return e.jsxs(Pt,v({className:N(F.root,c),ref:r,ownerState:w},C,{children:[g||R?e.jsx(At,{className:F.iconContainer,ownerState:w,children:e.jsx(R,v({completed:x,active:T,error:n,icon:g},m))}):null,e.jsxs(_t,{className:F.labelContainer,ownerState:w,children:[i?e.jsx($t,v({ownerState:w},E,{className:N(F.label,E==null?void 0:E.className),children:i})):null,p]})]}))});Fe.muiName="StepLabel";const wt=Fe;function Ft(t){return U("MuiStepConnector",t)}z("MuiStepConnector",["root","horizontal","vertical","alternativeLabel","active","completed","disabled","line","lineHorizontal","lineVertical"]);const Mt=["className"],Et=t=>{const{classes:o,orientation:r,alternativeLabel:l,active:a,completed:i,disabled:c}=t,s={root:["root",r,l&&"alternativeLabel",a&&"active",i&&"completed",c&&"disabled"],line:["line",`line${Ce(r)}`]};return G(s,Ft,o)},Bt=k("div",{name:"MuiStepConnector",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:r}=t;return[o.root,o[r.orientation],r.alternativeLabel&&o.alternativeLabel,r.completed&&o.completed]}})(({ownerState:t})=>v({flex:"1 1 auto"},t.orientation==="vertical"&&{marginLeft:12},t.alternativeLabel&&{position:"absolute",top:12,left:"calc(-50% + 20px)",right:"calc(50% + 20px)"})),Nt=k("span",{name:"MuiStepConnector",slot:"Line",overridesResolver:(t,o)=>{const{ownerState:r}=t;return[o.line,o[`line${Ce(r.orientation)}`]]}})(({ownerState:t,theme:o})=>{const r=o.palette.mode==="light"?o.palette.grey[400]:o.palette.grey[600];return v({display:"block",borderColor:o.vars?o.vars.palette.StepConnector.border:r},t.orientation==="horizontal"&&{borderTopStyle:"solid",borderTopWidth:1},t.orientation==="vertical"&&{borderLeftStyle:"solid",borderLeftWidth:1,minHeight:24})}),Dt=b.forwardRef(function(o,r){const l=O({props:o,name:"MuiStepConnector"}),{className:a}=l,i=q(l,Mt),{alternativeLabel:c,orientation:s="horizontal"}=b.useContext(J),{active:n,disabled:d,completed:p}=b.useContext(ne),u=v({},l,{alternativeLabel:c,orientation:s,active:n,completed:p,disabled:d}),h=Et(u);return e.jsx(Bt,v({className:N(h.root,a),ref:r,ownerState:u},i,{children:e.jsx(Nt,{className:h.line,ownerState:u})}))}),pe=Dt;function Vt(t){return U("MuiStepContent",t)}z("MuiStepContent",["root","last","transition"]);const Ht=["children","className","TransitionComponent","transitionDuration","TransitionProps"],Ut=t=>{const{classes:o,last:r}=t;return G({root:["root",r&&"last"],transition:["transition"]},Vt,o)},zt=k("div",{name:"MuiStepContent",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:r}=t;return[o.root,r.last&&o.last]}})(({ownerState:t,theme:o})=>v({marginLeft:12,paddingLeft:20,paddingRight:8,borderLeft:o.vars?`1px solid ${o.vars.palette.StepContent.border}`:`1px solid ${o.palette.mode==="light"?o.palette.grey[400]:o.palette.grey[600]}`},t.last&&{borderLeft:"none"})),Ot=k(je,{name:"MuiStepContent",slot:"Transition",overridesResolver:(t,o)=>o.transition})({}),qt=b.forwardRef(function(o,r){const l=O({props:o,name:"MuiStepContent"}),{children:a,className:i,TransitionComponent:c=je,transitionDuration:s="auto",TransitionProps:n}=l,d=q(l,Ht);b.useContext(J);const{active:p,last:u,expanded:h}=b.useContext(ne),m=v({},l,{last:u}),C=Ut(m);let j=s;return s==="auto"&&!c.muiSupportAuto&&(j=void 0),e.jsx(zt,v({className:N(C.root,i),ref:r,ownerState:m},d,{children:e.jsx(Ot,v({as:c,in:p||h,className:C.transition,ownerState:m,timeout:j,unmountOnExit:!0},n,{children:a}))}))}),Gt=qt;function Wt(t){return U("MuiStepper",t)}z("MuiStepper",["root","horizontal","vertical","alternativeLabel"]);const Qt=["activeStep","alternativeLabel","children","className","component","connector","nonLinear","orientation"],Yt=t=>{const{orientation:o,alternativeLabel:r,classes:l}=t;return G({root:["root",o,r&&"alternativeLabel"]},Wt,l)},Kt=k("div",{name:"MuiStepper",slot:"Root",overridesResolver:(t,o)=>{const{ownerState:r}=t;return[o.root,o[r.orientation],r.alternativeLabel&&o.alternativeLabel]}})(({ownerState:t})=>v({display:"flex"},t.orientation==="horizontal"&&{flexDirection:"row",alignItems:"center"},t.orientation==="vertical"&&{flexDirection:"column"},t.alternativeLabel&&{alignItems:"flex-start"})),Xt=e.jsx(pe,{}),Jt=b.forwardRef(function(o,r){const l=O({props:o,name:"MuiStepper"}),{activeStep:a=0,alternativeLabel:i=!1,children:c,className:s,component:n="div",connector:d=Xt,nonLinear:p=!1,orientation:u="horizontal"}=l,h=q(l,Qt),m=v({},l,{alternativeLabel:i,orientation:u,component:n}),C=Yt(m),j=b.Children.toArray(c).filter(Boolean),I=j.map((L,x)=>b.cloneElement(L,v({index:x,last:x+1===j.length},L.props))),T=b.useMemo(()=>({activeStep:a,alternativeLabel:i,connector:d,nonLinear:p,orientation:u}),[a,i,d,p,u]);return e.jsx(J.Provider,{value:T,children:e.jsx(Kt,v({as:n,ownerState:m,className:N(C.root,s),ref:r},h,{children:I}))})}),ve=Jt,Zt=()=>{const{submitForm:t}=_();return e.jsxs(te,{columnGap:1,display:"flex",flexWrap:"wrap",justifyContent:"space-between",rowGap:3,children:[e.jsx(Qe,{name:"configurations",render:({push:o})=>e.jsx(V,{buttonType:"outlined",onClick:()=>o(Me.configurations[0]),children:"Add Another Configuration"})}),e.jsx(V,{buttonType:"primary",onClick:t,sx:{marginLeft:"auto"},type:"submit",children:"Review Load Balancer"})]})},eo=t=>{const{configurationIndex:o,onClose:r,open:l,protocol:a}=t,{setFieldValue:i,values:c}=_(),[s,n]=b.useState("new"),d=ot(a),p=c.configurations.reduce((h,m)=>[...h,...m.routes],[]),u=h=>{i(`configurations[${o}].routes`,[...c.configurations[o].routes,h]),r()};return e.jsxs(ce,{onClose:r,open:l,title:"Add Route",children:[e.jsxs($,{spacing:1,children:[e.jsx(S,{children:ue.Description.main}),e.jsx(S,{children:ue.Description[d]})]}),e.jsxs(de,{onChange:(h,m)=>n(m),value:s,children:[e.jsx(B,{control:e.jsx(H,{}),label:`Create New ${d.toUpperCase()} Route`,value:"new"}),e.jsx(B,{control:e.jsx(H,{}),label:"Add Existing Route",value:"existing"})]}),s==="existing"?e.jsx(to,{existingRoutes:p,onAdd:u,onClose:r}):e.jsx(oo,{existingRoutes:p,onAdd:u,onClose:r,protocol:d})]})},to=t=>{const{existingRoutes:o,onAdd:r,onClose:l}=t,a=X({initialValues:{route:null},onSubmit({route:i}){if(!i)throw new Error("No route selected");r({...i,label:Se(i,o)}),l()},validate(i){return i.route?{}:{route:"Please select an existing route."}}});return e.jsxs("form",{onSubmit:a.handleSubmit,children:[e.jsx(Y,{errorText:a.errors.route,label:"Route",noMarginTop:!0,onChange:(i,c)=>a.setFieldValue("route",c),options:o}),e.jsx(K,{primaryButtonProps:{label:"Add Route",type:"submit"},secondaryButtonProps:{label:"Cancel",onClick:l}})]})},oo=t=>{const{existingRoutes:o,onAdd:r,onClose:l,protocol:a}=t,i=X({initialValues:{label:"",protocol:a,rules:[]},async onSubmit(c){r(c)},validate(c){if(o.some(s=>s.label===c.label))return{label:"Routes must have unique labels."};try{return Ne.validateSync(c,{abortEarly:!1}),{}}catch(s){return ie(s)}}});return e.jsxs("form",{onSubmit:i.handleSubmit,children:[e.jsx(P,{errorText:i.errors.label,label:"Route Label",name:"label",noMarginTop:!0,onChange:i.handleChange,value:i.values.label}),e.jsx(K,{primaryButtonProps:{label:"Add Route",type:"submit"},secondaryButtonProps:{label:"Cancel",onClick:l}})]})},no=t=>{const{configurationIndex:o,onClose:r,open:l,routeIndex:a}=t,{setFieldValue:i,values:c}=_(),s=c.configurations.reduce((p,u,h)=>{const m=u.routes.filter((C,j)=>!(h===o&&j===a));return[...p,...m]},[]),n=X({enableReinitialize:!0,initialValues:a!==void 0&&a>=0&&a<c.configurations[o].routes.length?c.configurations[o].routes[a]:{label:"",protocol:"http",rules:[]},onSubmit(p){i(`configurations[${o}].routes[${a}]`,p),d()},validate(p){if(s.some(u=>u.label===p.label))return{label:"Routes must have unique labels across all configurations."};try{return De.validateSync(p,{abortEarly:!1}),{}}catch(u){return ie(u)}}}),d=()=>{r(),n.resetForm()};return e.jsx(ce,{onClose:d,open:l,title:"Edit Route",children:e.jsxs("form",{onSubmit:n.handleSubmit,children:[e.jsx(P,{errorText:n.errors.label,label:"Route Label",name:"label",onChange:n.handleChange,value:n.values.label}),e.jsx(K,{primaryButtonProps:{disabled:!n.dirty,label:"Save",type:"submit"},secondaryButtonProps:{label:"Cancel",onClick:d}})]})})},ro=k("div",{label:"StyledCircleIcon",shouldForwardProp:Ve(["activeStep","index"])})(({theme:t,...o})=>({alignItems:"center",backgroundColor:o.index===o.activeStep?t.palette.primary.main:o.index<o.activeStep?"#ADD8E6":t.bg.bgPaper,border:o.index<o.activeStep||o.index===o.activeStep?`2px solid ${t.palette.primary.main}`:`2px solid ${t.borderColors.borderTable}`,borderRadius:"50%",display:"flex",height:t.spacing(3),justifyContent:"center",width:t.spacing(3)})),ao=k(we,{label:"StyledCircleIcon"})(()=>({active:{},completed:{},root:{"&$completed":{display:"none"}}})),so=k(pe,{label:"StyledColorlibConnector"})(({theme:t})=>({"& .MuiStepConnector-line":{borderColor:"#eaeaf0",borderLeftWidth:"3px",minHeight:t.spacing(2)}})),lo=({steps:t})=>{const[o,r]=b.useState(0),l=He(),a=Ue(l.breakpoints.down("md")),i=()=>{r(s=>s+1)},c=()=>{r(s=>s-1)};return e.jsxs(W,{sx:s=>({backgroundColor:s.bg.bgPaper,display:"flex",flexDirection:a?"column":"row",p:a?`${s.spacing(2)}px 0px`:`${s.spacing(2)}`}),children:[e.jsx(W,{children:e.jsx(ve,{activeStep:o,connector:e.jsx(so,{}),orientation:"vertical",children:t.map((s,n)=>e.jsx(ge,{onClick:()=>r(n),children:e.jsx(wt,{icon:e.jsx(ao,{icon:e.jsx(ro,{activeStep:o,index:n})}),sx:{cursor:"pointer !important","& .MuiStepIcon-text":{display:"none"},p:0},children:s.label})},s.label))})}),e.jsx(W,{sx:{flex:2},children:e.jsx(ve,{connector:e.jsx(pe,{sx:{"& .MuiStepConnector-line":{display:"none"},"& .MuiStepConnector-vertical":{display:"none"}}}),activeStep:o,orientation:"vertical",children:t.map(({content:s,handler:n,label:d},p)=>{var u,h,m;return e.jsx(ge,{children:p===o?e.jsxs(Gt,{sx:{border:"none",marginLeft:a?"0px":void 0,paddingLeft:a?"0px":void 0,paddingTop:a?`${l.spacing(2)}`:void 0},children:[e.jsx(W,{sx:C=>({bgcolor:C.bg.app,p:C.spacing(2)}),children:s}),e.jsxs(W,{sx:{mt:1},children:[p!==0&&e.jsxs(V,{buttonType:"outlined",onClick:c,sx:{mr:1,mt:1},children:["Previous: ",(u=t[p-1])==null?void 0:u.label]}),p!==2&&e.jsxs(V,{buttonType:"primary","data-testid":ze((h=t[p+1])==null?void 0:h.label),onClick:()=>{i(),n==null||n()},sx:{mr:1,mt:1},children:["Next: ",(m=t[p+1])==null?void 0:m.label]})]})]}):null},d)})})})]})},io=({index:t})=>{var s,n,d,p,u,h,m,C,j,I;const{errors:o,handleBlur:r,handleChange:l,setFieldValue:a,touched:i,values:c}=_();return e.jsxs(te,{padding:1,children:[e.jsx(S,{variant:"h2",children:"Details"}),e.jsx(S,{sx:T=>({marginRight:T.spacing(1)}),children:"The port the load balancer listens on, and the protocol for routing incoming traffic to the targets."}),e.jsxs(Q,{spacing:2,children:[e.jsxs(Q,{direction:"row",spacing:2,children:[e.jsx(Y,{errorText:(n=(s=i.configurations)==null?void 0:s[t])!=null&&n.protocol?ae(o,`configurations[${t}].protocol`):"",onChange:(T,{value:L})=>a(`configurations[${t}].protocol`,L),textFieldProps:{labelTooltipText:Z.Protocol},value:he.find(T=>{var L,x;return T.value===((x=(L=c.configurations)==null?void 0:L[t])==null?void 0:x.protocol)}),disableClearable:!0,label:"Protocol",options:he}),e.jsx(P,{errorText:(p=(d=i.configurations)==null?void 0:d[t])!=null&&p.port?ae(o,`configurations[${t}].port`):"",inputId:`configuration-${t}-port`,label:"Port",labelTooltipText:Z.Port,name:`configurations[${t}].port`,onBlur:r,onChange:l,placeholder:"Enter Port",type:"number",value:(h=(u=c.configurations)==null?void 0:u[t])==null?void 0:h.port})]}),e.jsxs(Q,{children:[e.jsxs(S,{variant:"h3",children:["TLS Certificates",e.jsx(ee,{status:"help",text:Z.Certificates})]}),e.jsx(te,{sx:{alignItems:"center",display:"flex"},children:e.jsxs(S,{children:[e.jsx(Te,{sx:T=>({marginLeft:"0 !important",marginRight:T.spacing()}),component:"span"}),"After the load balancer is created, and if the protocol is HTTPS, upload TLS termination certificates."," ",e.jsx(Le,{to:Je,children:"Learn more."})]})})]})]}),e.jsx(P,{errorText:(C=(m=i.configurations)==null?void 0:m[t])!=null&&C.label?ae(o,`configurations[${t}].label`):"",inputId:`configuration-${t}-label`,label:"Configuration Label",labelTooltipText:Z.configuration,name:`configurations[${t}].label`,onBlur:r,onChange:l,placeholder:"Enter Configuration Label",value:(I=(j=c.configurations)==null?void 0:j[t])==null?void 0:I.label})]})},co=({configurationIndex:t,handlers:o})=>{var n;const{setFieldValue:r,values:l}=_(),[a,i]=b.useState(""),c=l.configurations[t],s=d=>{c.routes.splice(d,1),r(`configurations[${t}].routes`,c.routes)};return e.jsxs($,{padding:1,spacing:1,children:[e.jsx(S,{variant:"h2",children:"Routes"}),e.jsxs($,{spacing:2,children:[e.jsx(S,{children:"Load balancer uses traffic routing rules to select the service target for the incoming request."}),e.jsxs($,{direction:"row",gap:2,children:[e.jsx(V,{buttonType:"outlined",onClick:()=>o.handleAddRoute(t),children:"Add Route"}),e.jsx(P,{InputProps:{endAdornment:a&&e.jsx(D,{position:"end",children:e.jsx(ye,{"aria-label":"Clear",onClick:()=>i(""),size:"small",sx:{padding:"unset"},children:e.jsx(Re,{sx:{color:"#aaa !important"}})})})},hideLabel:!0,inputId:`configuration-${t}-route-filter`,label:"Filter",onChange:d=>i(d.target.value),placeholder:"Filter",value:a})]}),e.jsxs(Pe,{sx:{width:"99%"},children:[e.jsx(_e,{children:e.jsxs(oe,{children:[e.jsx(y,{children:"Route Label"}),e.jsx(y,{children:"Rules"}),e.jsx(y,{})]})}),e.jsxs($e,{children:[c.routes.length===0&&e.jsx(Ae,{colSpan:5}),(n=c.routes)==null?void 0:n.filter(d=>a?d.label.includes(a):!0).map((d,p)=>e.jsxs(oe,{children:[e.jsx(y,{children:d.label}),e.jsx(y,{children:d.rules.length}),e.jsx(y,{actionCell:!0,children:e.jsx(Ie,{actionsList:[{onClick:()=>o.handleEditRoute(p,t),title:"Edit Label"},{onClick:()=>s(p),title:"Remove"}],ariaLabel:`Action Menu for Route ${d.label}`})})]},d.label))]})]})]})]})},po=({configurationIndex:t,handlers:o})=>{const{setFieldValue:r,values:l}=_(),[a,i]=b.useState(""),c=l.configurations[t],s=n=>{c.service_targets.splice(n,1),r(`configuration[${t}].service_targets`,c.service_targets)};return e.jsxs($,{padding:1,spacing:1,children:[e.jsx(S,{variant:"h2",children:"Service Targets"}),e.jsxs($,{spacing:2,children:[e.jsx(S,{children:"Service targets are a collection of endpoints. The load balancer uses policies and routes to direct incoming requests to specific healthy endpoints. At least one service target is required to start serving requests."}),e.jsxs($,{direction:"row",gap:2,children:[e.jsx(V,{buttonType:"outlined",onClick:()=>o.handleAddServiceTarget(t),children:"Add Service Target"}),e.jsx(P,{InputProps:{endAdornment:a&&e.jsx(D,{position:"end",children:e.jsx(ye,{"aria-label":"Clear",onClick:()=>i(""),size:"small",sx:{padding:"unset"},children:e.jsx(Re,{sx:{color:"#aaa !important"}})})})},hideLabel:!0,inputId:`configuration-${t}-service-target-filter`,label:"Filter",onChange:n=>i(n.target.value),placeholder:"Filter",value:a})]}),e.jsxs(Pe,{sx:{width:"99%"},children:[e.jsx(_e,{children:e.jsxs(oe,{children:[e.jsx(y,{children:"Service Target Label"}),e.jsx(y,{children:"Endpoints"}),e.jsx(y,{children:"Algorithm"}),e.jsx(y,{children:"Health Checks"}),e.jsx(y,{})]})}),e.jsxs($e,{children:[c.service_targets.length===0&&e.jsx(Ae,{colSpan:5}),c.service_targets.filter(n=>a?n.label.includes(a):!0).map((n,d)=>e.jsxs(oe,{children:[e.jsx(y,{children:n.label}),e.jsx(y,{children:n.endpoints.length===0?0:e.jsx(nt,{tooltipText:e.jsx($,{children:n.endpoints.map(({ip:p,port:u},h)=>e.jsxs(S,{children:[p,":",u]},`${p}-${u}-${h}`))}),displayText:String(n.endpoints.length),minWidth:100})}),e.jsx(y,{sx:{textTransform:"capitalize"},children:n.load_balancing_policy.replace("_"," ")}),e.jsx(y,{children:n.healthcheck?"Yes":"No"}),e.jsx(y,{actionCell:!0,children:e.jsx(Ie,{actionsList:[{onClick:()=>o.handleEditServiceTarget(d,t),title:"Edit"},{onClick:()=>s(d),title:"Remove"}],ariaLabel:`Action Menu for Service Target ${n.label}`})})]},n.label))]})]})]})]})},uo=({handlers:t,index:o})=>{var a,i;const r=[{content:e.jsx(io,{handlers:t,index:o}),label:"Details"},{content:e.jsx(po,{configurationIndex:o,handlers:t}),label:"Service Targets"},{content:e.jsx(co,{configurationIndex:o,handlers:t}),label:"Routes"}],{values:l}=_();return e.jsxs(ke,{children:[e.jsxs(S,{sx:c=>({marginBottom:c.spacing(2)}),variant:"h2",children:["Configuration - ",(i=(a=l.configurations)==null?void 0:a[o])==null?void 0:i.label]}),e.jsxs(Q,{spacing:1,children:[e.jsx(S,{children:"The load balancer configuration for processing incoming requests, the service targets it directs requests to and routing rules."}),e.jsx(lo,{steps:r})]})]})},ho=t=>{var h,m,C,j,I,T,L;const{configurationIndex:o,onClose:r,serviceTargetIndex:l}=t,a=l!==void 0,{setFieldValue:i,values:c}=_(),s=c.configurations[o],n=X({enableReinitialize:!0,initialValues:a?s.service_targets[l]:rt,async onSubmit(x){a?(s.service_targets[l]=x,i(`configurations[${o}]service_targets`,s.service_targets)):i(`configurations[${o}]service_targets`,[...s.service_targets,x]),d()},validate(x){if(c.configurations.reduce((g,R,w)=>{const F=R.service_targets.filter((E,Ee)=>!(a&&w===o&&Ee===l));return[...g,...F]},[]).some(g=>g.label===x.label))return{label:"Label must be unique across all configurations."};try{return Oe.validateSync(x,{abortEarly:!1}),{}}catch(g){return ie(g)}}}),d=()=>{n.resetForm(),r()},p=x=>{n.setFieldValue("endpoints",[...n.values.endpoints,x])},u=x=>{n.setFieldValue("endpoints",n.values.endpoints.filter((f,g)=>g!==x))};return e.jsxs("form",{onSubmit:n.handleSubmit,children:[e.jsx(P,{errorText:n.errors.label,label:"Service Target Label",name:"label",noMarginTop:!a,onChange:n.handleChange,value:n.values.label}),e.jsx(Y,{textFieldProps:{labelTooltipText:A.Tooltips.Protocol},value:xe.find(x=>x.value===n.values.protocol),disableClearable:!0,errorText:n.errors.protocol,label:"Service Target Protocol",onChange:(x,{value:f})=>n.setFieldValue("protocol",f),options:xe}),e.jsx(Y,{onChange:(x,f)=>n.setFieldValue("load_balancing_policy",f.value),renderOption:(x,f,g)=>e.jsxs("li",{...x,children:[e.jsxs($,{flexGrow:1,children:[e.jsx(S,{color:"inherit",children:e.jsx("b",{children:f.label})}),e.jsx(S,{color:"inherit",children:f.description})]}),e.jsx(tt,{visible:g.selected})]}),textFieldProps:{labelTooltipText:A.Tooltips.Algorithm},value:be.find(x=>x.value===n.values.load_balancing_policy),disableClearable:!0,errorText:n.errors.load_balancing_policy,label:"Algorithm",options:be}),e.jsx(re,{spacingBottom:24,spacingTop:24}),e.jsx(S,{sx:{marginBottom:2},variant:"h3",children:"Endpoints"}),e.jsx(at,{endpoints:n.values.endpoints,onRemove:u}),e.jsx(st,{onAdd:p}),n.values.protocol==="https"&&e.jsxs(e.Fragment,{children:[e.jsx(re,{spacingBottom:12,spacingTop:24}),e.jsxs($,{alignItems:"center",direction:"row",children:[e.jsx(S,{variant:"h3",children:"Service Target CA Certificate"}),e.jsx(ee,{status:"help",text:A.Tooltips.Certificate})]}),e.jsxs(S,{children:[e.jsx(Te,{component:"span",sx:{marginLeft:"0 !important",marginRight:"4px"}}),"Upload service target endpoint CA certificates after the load balancer is created and the protocol is HTTPS."," ",e.jsx(Le,{to:Ze.Certificates,children:"Learn more."})]})]}),e.jsx(re,{spacingBottom:12,spacingTop:24}),e.jsxs($,{alignItems:"center",direction:"row",children:[e.jsx(S,{variant:"h3",children:"Health Checks"}),e.jsx(ee,{status:"help",text:A.Tooltips.Healthcheck.Description})]}),e.jsx(B,{control:e.jsx(it,{onChange:(x,f)=>n.setFieldValue("healthcheck.interval",f?10:0),checked:n.values.healthcheck.interval!==0}),label:"Use Health Checks"}),n.values.healthcheck.interval!==0&&e.jsxs(te,{"data-qa-healthcheck-options":!0,children:[e.jsxs(de,{onChange:(x,f)=>n.setFieldValue("healthcheck.protocol",f),sx:{marginBottom:"0px !important"},value:n.values.healthcheck.protocol,children:[e.jsxs(lt,{children:["Protocol",e.jsx(ee,{status:"help",sxTooltipIcon:{marginLeft:1.5,padding:0},text:A.Tooltips.Healthcheck.Protocol})]}),e.jsx(B,{control:e.jsx(H,{}),label:"HTTP",value:"http"}),e.jsx(B,{control:e.jsx(H,{}),label:"TCP",value:"tcp"}),e.jsx(qe,{children:(h=n.errors.healthcheck)==null?void 0:h.protocol})]}),e.jsxs($,{direction:"row",spacing:2,children:[e.jsx(P,{InputProps:{endAdornment:e.jsx(D,{position:"start",children:"seconds"})},labelTooltipText:A.Tooltips.Healthcheck.Interval,errorText:(m=n.errors.healthcheck)==null?void 0:m.interval,label:"Interval",name:"healthcheck.interval",onChange:n.handleChange,type:"number",value:n.values.healthcheck.interval}),e.jsx(P,{InputProps:{endAdornment:e.jsx(D,{position:"start",children:"checks"})},labelTooltipText:A.Tooltips.Healthcheck.Healthy,errorText:(C=n.errors.healthcheck)==null?void 0:C.healthy_threshold,label:"Healthy Threshold",name:"healthcheck.healthy_threshold",onChange:n.handleChange,type:"number",value:n.values.healthcheck.healthy_threshold})]}),e.jsxs($,{direction:"row",spacing:2,children:[e.jsx(P,{InputProps:{endAdornment:e.jsx(D,{position:"start",children:"seconds"})},labelTooltipText:A.Tooltips.Healthcheck.Timeout,errorText:(j=n.errors.healthcheck)==null?void 0:j.timeout,label:"Timeout",name:"healthcheck.timeout",onChange:n.handleChange,type:"number",value:n.values.healthcheck.timeout}),e.jsx(P,{InputProps:{endAdornment:e.jsx(D,{position:"start",children:"checks"})},labelTooltipText:A.Tooltips.Healthcheck.Unhealthy,errorText:(I=n.errors.healthcheck)==null?void 0:I.unhealthy_threshold,label:"Unhealthy Threshold",name:"healthcheck.unhealthy_threshold",onChange:n.handleChange,type:"number",value:n.values.healthcheck.unhealthy_threshold})]}),n.values.healthcheck.protocol==="http"&&e.jsxs(e.Fragment,{children:[e.jsx(P,{labelTooltipText:A.Tooltips.Healthcheck.Path,errorText:(T=n.errors.healthcheck)==null?void 0:T.path,label:"Health Check Path",name:"healthcheck.path",onChange:n.handleChange,optional:!0,value:n.values.healthcheck.path}),e.jsx(P,{labelTooltipText:A.Tooltips.Healthcheck.Host,errorText:(L=n.errors.healthcheck)==null?void 0:L.host,label:"Health Check Host",name:"healthcheck.host",onChange:n.handleChange,optional:!0,value:n.values.healthcheck.host})]})]}),e.jsx(K,{primaryButtonProps:{disabled:a&&!n.dirty,label:a?"Save":"Add Service Target",type:"submit"},secondaryButtonProps:{label:"Cancel",onClick:d}})]})},xo=t=>{const{configurationIndex:o,onClose:r,open:l,serviceTargetIndex:a}=t,[i,c]=b.useState("new"),s=a!==void 0;return e.jsxs(ce,{onClose:r,open:l,title:s?"Edit Service Target":"Add a Service Target",children:[e.jsx(S,{children:A.Description}),!s&&e.jsxs(de,{onChange:(n,d)=>c(d),value:i,children:[e.jsx(B,{control:e.jsx(H,{}),label:"Create New Service Target",value:"new"}),e.jsx(B,{control:e.jsx(H,{}),label:"Add Existing Service Target",value:"existing"})]}),(s||i==="new")&&e.jsx(ho,{configurationIndex:o,onClose:r,serviceTargetIndex:a}),!s&&i==="existing"&&e.jsx(bo,{configurationIndex:o,onClose:r})]})},bo=t=>{const{configurationIndex:o,onClose:r}=t,{setFieldValue:l,values:a}=_(),i=a.configurations.reduce((s,n)=>[...s,...n.service_targets],[]),c=X({initialValues:{serviceTarget:null},onSubmit({serviceTarget:s}){if(!s)throw new Error("No service target selected");l(`configurations[${o}]service_targets`,[...a.configurations[o].service_targets,{...s,label:Se(s,i)}]),r()},validate(s){return s.serviceTarget?{}:{serviceTarget:"Please select an existing service target."}}});return e.jsxs("form",{onSubmit:c.handleSubmit,children:[e.jsx(Y,{errorText:c.errors.serviceTarget,label:"Service Target",noMarginTop:!0,onChange:(s,n)=>c.setFieldValue("serviceTarget",n),options:i}),e.jsx(K,{primaryButtonProps:{label:"Add Service Target",type:"submit"},secondaryButtonProps:{label:"Cancel",onClick:r}})]})},go=()=>{var x,f;const{values:t}=_(),[o,r]=b.useState(!1),[l,a]=b.useState(!1),[i,c]=b.useState(!1),[s,n]=b.useState(),[d,p]=b.useState(),[u,h]=b.useState(0),L={handleAddRoute:g=>{a(!0),h(g)},handleAddServiceTarget:g=>{h(g),r(!0)},handleCloseServiceTargetDrawer:()=>{n(void 0),r(!1)},handleEditRoute:(g,R)=>{h(R),p(g),c(!0)},handleEditServiceTarget:(g,R)=>{h(R),n(g),r(!0)}};return e.jsxs(e.Fragment,{children:[(x=t.configurations)==null?void 0:x.map((g,R)=>e.jsx(uo,{handlers:L,index:R},R)),e.jsx(xo,{onClose:()=>{r(!1),n(void 0)},configurationIndex:u,open:o,serviceTargetIndex:s}),e.jsx(eo,{protocol:((f=t.configurations)==null?void 0:f[u].protocol)??"tcp",configurationIndex:u,onClose:()=>a(!1),open:l}),e.jsx(no,{configurationIndex:u,onClose:()=>c(!1),open:i,routeIndex:d})]})},mo=()=>{const{errors:t,handleBlur:o,handleChange:r,touched:l,values:a}=_();return e.jsx(ke,{sx:{flexGrow:1,width:"100%"},"data-qa-label-header":!0,children:e.jsx(P,{disabled:!1,errorText:l.label&&t.label?t.label:void 0,label:"Load Balancer Label",name:"label",noMarginTop:!0,onBlur:o,onChange:r,placeholder:"Enter a label",value:a==null?void 0:a.label})})},Me={configurations:[{certificates:[],label:"",port:443,protocol:"https",routes:[],service_targets:[]}],label:"",regions:[]},Ho=()=>{const t=o=>{};return e.jsxs(e.Fragment,{children:[e.jsx(Ge,{segment:"Create a Load Balancer"}),e.jsx(Xe,{breadcrumbProps:{crumbOverrides:[{label:"Global Load Balancers",position:1}],pathname:location.pathname},betaFeedbackLink:et,title:"Create"}),e.jsx(Ye,{initialValues:Me,onSubmit:t,validationSchema:We,children:e.jsx(Ke,{children:e.jsxs(Q,{spacing:3,children:[e.jsx(mo,{}),e.jsx(ct,{}),e.jsx(go,{}),e.jsx(Zt,{})]})})})]})};export{Ho as LoadBalancerCreate,Me as initialValues};
