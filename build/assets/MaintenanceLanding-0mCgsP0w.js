import{ao as M,a2 as R,j as e,a1 as $,ap as z,W as d,Z as P,aq as y,da as E,a3 as u,m as N,r as L,B as f,T as B,Q as I}from"./index-Eksrs3uK.js";import{D as F}from"./DownloadCSV-HnOVCNZX.js";import{P as O}from"./PaginationFooter-NHWf7fW2.js";import{T,a as r,b as A,c as V}from"./TableRow-phXfWUGW.js";import{T as W}from"./TableRowEmpty-aXmC67-Z.js";import{T as H}from"./TableRowError-8gKmGX7P.js";import{T as Q}from"./TableRowLoading-iP7zIRHG.js";import{T as p}from"./TableSortCell-hcsagFzN.js";import{u as _}from"./useFormattedDate-CkANZUWG.js";import{u as q}from"./useOrder-rsUMHEuj.js";import{u as K}from"./usePagination-Sxr0Tlb7.js";import{u as Z,a as G}from"./accountMaintenance-hC6-dGbb.js";import{S as J}from"./StatusIcon-RuV8PvAV.js";import{T as U}from"./TableHead-Si_pzkLK.js";import"./lke-download-Hz_dthl6.js";import"./Skeleton-iwmO4Yae.js";import"./OrderBy-H-bWJCPy.js";import"./splitAt-pbTnq2Oi.js";const X={completed:"Completed",pending:"Scheduled",started:"In Progress"},Y={completed:"inactive",pending:"active",started:"other"},ee=a=>{const{entity:n,reason:t,status:s,type:m,when:c}=a,{data:i}=M(),l=R(t,93),x=t!==l;return e.jsxs(T,{children:[e.jsx(r,{style:{textTransform:"capitalize"},children:n.type}),e.jsx(r,{children:e.jsx($,{to:n.type==="linode"?`/${n.type}s/${n.id}`:`/${n.type}s`,tabIndex:0,children:n.label})}),e.jsx(r,{noWrap:!0,children:z(c,{timezone:i==null?void 0:i.timezone})}),e.jsx(d,{mdDown:!0,children:e.jsx(r,{"data-testid":"relative-date",children:P(c).toRelative()})}),e.jsx(d,{smDown:!0,children:e.jsx(r,{noWrap:!0,children:y(m.replace("_"," "))})}),e.jsxs(r,{statusCell:!0,children:[e.jsx(J,{status:Y[s]??"other"}),X[s]??y(s)]}),e.jsx(d,{lgDown:!0,children:e.jsx(r,{children:x?e.jsx(E,{title:e.jsx(u,{textOrMarkdown:t}),children:e.jsx("div",{children:e.jsx(u,{textOrMarkdown:l})})}):e.jsx(u,{textOrMarkdown:l})})})]},n.id)},b="account-maintenance",ae=[{key:"entity.label",label:"Entity Label"},{key:"entity.type",label:"Entity Type"},{key:"entity.id",label:"Entity ID"},{key:"when",label:"Date"},{key:"type",label:"Type"},{key:"status",label:"Status"},{key:"reason",label:"Reason"}],te=N()(a=>({cell:{width:"12%"},headingContainer:{marginBottom:a.spacing(1),marginTop:a.spacing(1.5),[a.breakpoints.down("md")]:{paddingLeft:a.spacing(),paddingRight:a.spacing()}}})),w=({type:a})=>{const n=L.useRef(),{classes:t}=te(),s=K(1,`${b}-${a}`,a),m=_(),{handleOrderChange:c,order:i,orderBy:l}=q({order:"desc",orderBy:"status"},`${b}-order-${a}`,a),g={"+order":i,"+order_by":l,status:{completed:"completed",pending:{"+or":["pending, started"]}}[a]},{data:C,refetch:k}=Z({},g,!1),{data:o,error:j,isLoading:D}=G({page:s.page,page_size:s.pageSize},g),S=()=>D?e.jsx(Q,{responsive:{2:{smDown:!0},3:{xsDown:!0},5:{mdDown:!0}},columns:7,rows:1}):j?e.jsx(H,{colSpan:7,message:j[0].reason}):(o==null?void 0:o.results)===0?e.jsx(W,{colSpan:7,message:`No ${a} maintenance.`}):o?o.data.map(h=>e.jsx(ee,{...h},`${h.entity.id}-${h.type}`)):null,v=async()=>{await k(),n.current.link.click()};return e.jsxs(e.Fragment,{children:[e.jsxs(f,{className:t.headingContainer,display:"flex",justifyContent:"space-between",children:[e.jsx(B,{style:{textTransform:"capitalize"},variant:"h3",children:a}),e.jsx(f,{children:e.jsx(F,{csvRef:n,data:C||[],filename:`${a}-maintenance-${m}.csv`,headers:ae,onClick:v})})]}),e.jsxs(A,{children:[e.jsx(U,{children:e.jsxs(T,{children:[e.jsx(r,{className:t.cell,children:"Entity"}),e.jsx(r,{className:t.cell,children:"Label"}),e.jsx(p,{active:l==="when",className:t.cell,direction:i,handleClick:c,label:"when",children:"Date"}),e.jsx(d,{mdDown:!0,children:e.jsx(p,{active:l==="when",className:t.cell,direction:i,handleClick:c,label:"when",children:"When"})}),e.jsx(d,{smDown:!0,children:e.jsx(p,{active:l==="type",className:t.cell,direction:i,handleClick:c,label:"type",children:"Type"})}),e.jsx(p,{active:l==="status",className:t.cell,direction:i,handleClick:c,label:"status",children:"Status"}),e.jsx(d,{lgDown:!0,children:e.jsx(r,{style:{width:"40%"},children:"Reason"})})]})}),e.jsx(V,{children:S()})]}),e.jsx(O,{count:(o==null?void 0:o.results)||0,eventCategory:`${a} Maintenance Table`,handlePageChange:s.handlePageChange,handleSizeChange:s.handlePageSizeChange,page:s.page,pageSize:s.pageSize})]})},we=()=>e.jsxs(e.Fragment,{children:[e.jsx(I,{segment:"Maintenance"}),e.jsx(w,{type:"pending"}),e.jsx(w,{type:"completed"})]});export{we as default};
