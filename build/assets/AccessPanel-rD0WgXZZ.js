import{m as N,r as m,ao as E,eR as L,eS as z,j as e,T as A,f as I,cQ as P,eT as _,eU as U,_ as K,aa as O,K as B,$ as D}from"./index-Eksrs3uK.js";import{b as $,T as v,a as l,c as F}from"./TableRow-phXfWUGW.js";import{T as W}from"./TableRowEmpty-aXmC67-Z.js";import{T as Y}from"./TableRowError-8gKmGX7P.js";import{C as q}from"./CreateSSHKeyDrawer-NnwCGTeL.js";import{u as M}from"./usePagination-Sxr0Tlb7.js";import{P as Q}from"./PaginationFooter-NHWf7fW2.js";import{T as G}from"./TableRowLoading-iP7zIRHG.js";import{T as J}from"./TableHead-Si_pzkLK.js";const H=25,V=N()(r=>({cellCheckbox:{paddingLeft:r.spacing(1),paddingRight:r.spacing(1),width:50},cellUser:{width:"30%"},gravatar:{borderRadius:"50%",height:24,marginRight:r.spacing(1),width:24},title:{marginBottom:r.spacing(2)},userWrapper:{alignItems:"center",display:"inline-flex",marginTop:r.spacing(.5)}})),X=r=>{const{classes:a}=V(),{authorizedUsers:t,disabled:p,setAuthorizedUsers:h}=r,[b,u]=m.useState(!1),i=M(1),{data:n}=E(),c=(n==null?void 0:n.restricted)??!1,{data:d,error:T,isLoading:f}=L({page:i.page,page_size:i.pageSize}),{data:o,error:x,isLoading:y}=z({},{},c),g=(o==null?void 0:o.data.map(s=>s.label))??[],C=(o==null?void 0:o.results)??0,S=s=>{t.includes(s)?h(t.filter(R=>R!==s)):h([...t,s])},w=c?y:f,j=c?x:T,k=()=>j?e.jsx(Y,{colSpan:3,message:j==null?void 0:j[0].reason}):c&&(o==null?void 0:o.results)===0?e.jsx(W,{colSpan:3,message:"You don't have any SSH keys available."}):w?e.jsx(G,{columns:3,rows:1}):n&&c?e.jsxs(v,{children:[e.jsx(l,{className:a.cellCheckbox,children:e.jsx(P,{inputProps:{"aria-label":`Enable SSH for ${n.username}`},checked:t.includes(n.username),disabled:p,onChange:()=>S(n.username)})}),e.jsx(l,{className:a.cellUser,children:e.jsxs("div",{className:a.userWrapper,children:[e.jsx(_,{className:a.gravatar,email:n.email}),n.username]})}),e.jsx(l,{children:U(g,H,C)})]}):d==null?void 0:d.data.map(s=>e.jsxs(v,{children:[e.jsx(l,{className:a.cellCheckbox,children:e.jsx(P,{inputProps:{"aria-label":`Enable SSH for ${s.username}`},checked:t.includes(s.username),disabled:p||s.ssh_keys.length===0,onChange:()=>S(s.username)})}),e.jsx(l,{className:a.cellUser,children:e.jsxs("div",{className:a.userWrapper,children:[e.jsx(_,{className:a.gravatar,email:s.email}),s.username]})}),e.jsx(l,{children:s.ssh_keys.length===0?"None":U(s.ssh_keys,H)})]},s.username));return e.jsxs(m.Fragment,{children:[e.jsx(A,{className:a.title,variant:"h2",children:"SSH Keys"}),e.jsxs($,{spacingBottom:16,children:[e.jsx(J,{children:e.jsxs(v,{children:[e.jsx(l,{className:a.cellCheckbox}),e.jsx(l,{className:a.cellUser,children:"User"}),e.jsx(l,{children:"SSH Keys"})]})}),e.jsx(F,{children:k()})]}),!c&&e.jsx(Q,{count:(d==null?void 0:d.results)??0,eventCategory:"SSH Key Users Table",handlePageChange:i.handlePageChange,handleSizeChange:i.handlePageSizeChange,page:i.page,pageSize:i.pageSize}),e.jsx(I,{buttonType:"outlined",disabled:p,onClick:()=>u(!0),children:"Add an SSH Key"}),e.jsx(q,{onClose:()=>u(!1),open:b})]})},Z=m.memo(X),ee=m.lazy(()=>K(()=>import("./PasswordInput-0lxL15tw.js"),__vite__mapDeps([0,1,2,3]))),ae=N()((r,a,t)=>({isOptional:{[`& .${t.passwordInputOuter}`]:{marginTop:0}},passwordInputOuter:{},root:{marginTop:r.spacing(3)}})),pe=r=>{const{authorizedUsers:a,className:t,disabled:p,disabledReason:h,error:b,handleChange:u,hideStrengthLabel:i,isOptional:n,label:c,password:d,passwordHelperText:T,placeholder:f,required:o,setAuthorizedUsers:x,tooltipInteractive:y}=r,{classes:g,cx:C}=ae(),S=w=>u(w.target.value);return e.jsxs(O,{className:C({[g.isOptional]:n},g.root,t),children:[e.jsx(m.Suspense,{fallback:e.jsx(B,{}),children:e.jsx(ee,{autoComplete:"off",className:g.passwordInputOuter,"data-qa-password-input":!0,disabled:p,disabledReason:h||"",errorText:b,helperText:T,hideStrengthLabel:i,label:c||"Root Password",name:"password",noMarginTop:!0,onChange:S,placeholder:f||"Enter a password.",required:o,tooltipInteractive:y,value:d||""})}),x!==void 0&&a!==void 0?e.jsxs(e.Fragment,{children:[e.jsx(D,{spacingBottom:20,spacingTop:24}),e.jsx(Z,{authorizedUsers:a,disabled:p,setAuthorizedUsers:x})]}):null]})};export{pe as A};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/PasswordInput-0lxL15tw.js","assets/index-Eksrs3uK.js","assets/index-RL6WRErT.css","assets/main-SCnYvbUf.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}