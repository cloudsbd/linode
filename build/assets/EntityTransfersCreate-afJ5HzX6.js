import{s as i,ad as D,G as j,r as u,j as t,cQ as C,T,cR as P,aW as A,bD as B,bb as F,cS as G,ba as O,W as z,f as v,bC as H,cn as Q,u as N,av as $,cl as f,Q as M,an as q,cT as W}from"./index-Eksrs3uK.js";import{L as I}from"./LandingHeader-JXAVBhqg.js";import{u as _,c as U,q as V}from"./utilities-i5ZolZ8e.js";import{T as k,a as S,b as K,c as X}from"./TableRow-phXfWUGW.js";import{T as Y}from"./TableContentWrapper-56D5btVR.js";import{u as J}from"./usePagination-Sxr0Tlb7.js";import{D as Z}from"./DebouncedSearchTextField-EUZwzd3g.js";import{P as ee}from"./PaginationFooter-NHWf7fW2.js";import{T as te}from"./TableHead-Si_pzkLK.js";import{p as ne}from"./immer.esm--MpJ8fpr.js";import"./TableRowEmpty-aXmC67-Z.js";import"./TableRowError-8gKmGX7P.js";import"./TableRowLoading-iP7zIRHG.js";import"./Skeleton-iwmO4Yae.js";const ae=i(D,{label:"StyledNotice"})(({theme:e})=>({[e.breakpoints.down("lg")]:{marginLeft:e.spacing()}})),se=i(j,{label:"StyledRootGrid"})(({theme:e})=>({[e.breakpoints.down("lg")]:{justifyContent:"center",margin:0}})),oe=i(j,{label:"StyledSidebarGrid"})(({theme:e})=>({[e.breakpoints.down("lg")]:{"&.MuiGrid-item":{paddingLeft:0,paddingRight:0},padding:`0 ${e.spacing(1)}`}})),re=u.memo(e=>{const{handleToggleCheck:n,isChecked:c}=e;return t.jsxs(k,{sx:{"& td":{padding:"0px 15px"}},children:[t.jsx(le,{children:t.jsx(C,{inputProps:{"aria-label":"Select all entities on page"},checked:c,onChange:n})}),e.children]})}),le=i(S,{label:"StyledTableCell"})({"& svg":{height:20,width:20},paddingLeft:0,paddingRight:0,textAlign:"center",width:25}),ie=i(C,{label:"StyledCheckbox"})({"& svg":{height:20,width:20}}),de=i(C,{label:"StyledEmptyCheckbox"})({"& svg":{height:20,width:20}}),ce=i(ee,{label:"StyledPaginationFooter"})(({theme:e})=>({marginBottom:e.spacing(),padding:e.spacing()})),ge=i(T,{label:"StyledTypography"})(({theme:e})=>({marginBottom:e.spacing(),marginTop:e.spacing(2)})),he=i(Z,{label:"StyledDebouncedSearchTextField"})(({theme:e})=>({marginBottom:e.spacing(.5),maxWidth:556})),pe=i(K,{label:"StyledTable"})(({theme:e})=>({marginTop:e.spacing()})),ye=i(S,{label:"StyledCheckAllTableCell"})({"&&":{padding:0,textAlign:"center",width:"68px"}}),be=u.memo(e=>{const{count:n,handleSearch:c,hasSelectedAll:a,headers:r,page:d,pageSize:g,requestPage:o,toggleSelectAll:s}=e,m=l=>s(l.target.checked),y=a?ie:de;return t.jsxs(t.Fragment,{children:[t.jsx(ge,{variant:"h2",children:"Linodes"}),t.jsx(he,{debounceTime:400,hideLabel:!0,isSearching:!1,label:"Search by label",onSearch:c,placeholder:"Search by label"}),t.jsxs(pe,{children:[t.jsx(te,{children:t.jsxs(k,{children:[t.jsx(ye,{children:t.jsx(y,{inputProps:{"aria-label":"Select all services on page"},checked:a,onChange:m})}),r.map(l=>t.jsx(S,{children:l},`entity-table-header-${l}`))]})}),t.jsx(X,{children:e.children})]}),n>g?t.jsx(ce,{count:n,eventCategory:"Service Transfer Table",fixedSize:!0,handlePageChange:o,handleSizeChange:()=>null,page:d,pageSize:g}):null]})}),me=u.memo(e=>{const{handleRemove:n,handleSelect:c,handleToggle:a,selectedLinodes:r}=e,[d,g]=u.useState(""),o=J(),{data:s,dataUpdatedAt:m,error:y,isError:l,isLoading:h}=P({page:o.page,page_size:o.pageSize},Se(d)),b=(s==null?void 0:s.data)??[],x=b.every(p=>!!r[p.id])&&!h&&!l&&Object.keys(r).length>0,w=()=>{x?n(b.map(p=>String(p.id))):c(b)},E=p=>{g(p),o.handlePageChange(1)},R=A(),L=B(R.breakpoints.down("lg"))?["Label","Plan"]:["Label","Plan","Region"];return t.jsx(be,{count:(s==null?void 0:s.results)??0,handleSearch:E,hasSelectedAll:x,headers:L,page:o.page,pageSize:o.pageSize,requestPage:o.handlePageChange,toggleSelectAll:w,children:t.jsx(Y,{error:y??void 0,lastUpdated:m,length:(s==null?void 0:s.results)??0,loading:h,children:b.map(p=>t.jsx(ue,{handleToggleCheck:()=>a(p),isChecked:!!r[p.id],linode:p},p.id))})})}),ue=e=>{var y;const{handleToggleCheck:n,isChecked:c,linode:a}=e,r=F(a.type?[a.type]:[]),d=(y=r[0])!=null&&y.data?G(r[0].data):void 0,g=(d==null?void 0:d.formattedLabel)??a.type,{data:o}=O(),s=o==null?void 0:o.find(l=>l.id===a.region),m=(s==null?void 0:s.label)??a.region;return t.jsxs(re,{handleToggleCheck:n,isChecked:c,children:[t.jsx(S,{children:a.label}),t.jsx(S,{children:g}),t.jsx(z,{lgDown:!0,children:t.jsx(S,{children:m})})]})},Se=e=>e===""?{}:{label:{"+contains":e}},Te=i(v,{label:"StyledButton"})(({theme:e})=>({backgroundColor:"inherit",border:"none",minWidth:0,textDecoration:"none",[e.breakpoints.down("md")]:{visibility:"visible"},visibility:"hidden"})),xe=i(v,{label:"StyledSubmitButton"})(({theme:e})=>({marginLeft:0,marginRight:0,marginTop:e.spacing(3),width:"100%"})),fe=i(H,{label:"StyledClose"})(({theme:e})=>({"& svg":{height:11,width:11},color:e.color.grey1})),je=i(T,{label:"StyledTypography"})(({theme:e})=>({color:e.color.green,fontFamily:e.font.bold,fontSize:"1rem",marginTop:e.spacing(3)})),Ce=i(T,{label:"StyledHeaderTypography"})(({theme:e})=>({color:e.color.green,fontFamily:e.font.bold,fontSize:"1.25rem",lineHeight:"1.5rem"})),ve=i("div",{label:"StyledRowDiv"})(({theme:e})=>({"&:first-of-type":{borderTop:`solid 1px ${e.color.border2}`},"&:hover > button":{visibility:"visible"},alignItems:"center",borderBottom:`solid 1px ${e.color.border2}`,display:"flex",justifyContent:"space-between",padding:"2px 0px"})),ke=i("div",{label:"StyledRowBoxDiv"})(({theme:e})=>({marginTop:e.spacing(3),maxHeight:"75vh",overflowY:"auto"})),we=e=>({entities:Object.keys(e).reduce((c,a)=>({...c,[a]:Object.keys(e[a]).map(Number)}),{linodes:[]})}),Ee=u.memo(e=>{const{label:n,onClick:c}=e;return t.jsxs(ve,{children:[t.jsx(T,{children:t.jsx("strong",{children:n})}),t.jsx(Te,{onClick:c,children:t.jsx(fe,{})})]})}),Re=u.memo(e=>{const{handleSubmit:n,isCreating:c,removeEntities:a,selectedEntities:r}=e,d=()=>{const o=we(r);n(o)},g=Object.keys(r.linodes).length;return t.jsxs("div",{children:[t.jsx(Ce,{children:"Service Transfer Summary"}),t.jsx(ke,{children:Object.entries(r.linodes).map(([o,s])=>t.jsx(Ee,{label:s,onClick:()=>a("linodes",[String(o)])},`transfer-summary-linodes-${o}`))}),g>0?t.jsxs(je,{children:[Q("Linode","Linodes",g)," to be transferred"]}):t.jsx(T,{children:"No Linodes selected"}),t.jsx(xe,{buttonType:"primary",disabled:g===0,loading:c,onClick:d,children:"Generate Token"})]})}),Le=()=>t.jsx(T,{variant:"body1",children:"To transfer ownership of one or more Linodes make your selections below then click Generate Token."}),De=["linodes"],Pe=De.reduce((e,n)=>({...e,[n]:{}}),{}),Ae=ne((e,n)=>{switch(n.type){case"ADD":n.entitiesToAdd.forEach(d=>{e[n.entityType][d.id]=d.label});break;case"REMOVE":n.entitiesToRemove.forEach(d=>{delete e[n.entityType][d]});break;case"TOGGLE":const a=n.entity,r=e[n.entityType];r[a.id]?delete r[a.id]:r[a.id]=a.label;break;case"RESET":e[n.entityType]={};break}}),Ve=()=>{const{push:e}=N(),{error:n,isLoading:c,mutateAsync:a}=_(),r=$(),[d,g]=u.useReducer(Ae,Pe),o=f((l,h)=>{g({entitiesToAdd:h,entityType:l,type:"ADD"})}),s=f((l,h)=>{g({entitiesToRemove:h,entityType:l,type:"REMOVE"})}),m=f((l,h)=>{g({entity:h,entityType:l,type:"TOGGLE"})}),y=(l,h)=>{a(l,{onSuccess:b=>{const x=U(b.entities);W(x),h.invalidateQueries(V),e({pathname:"/account/service-transfers",state:{transfer:b}})}}).catch(b=>null)};return t.jsxs(t.Fragment,{children:[t.jsx(M,{segment:"Make a Service Transfer"}),t.jsx(I,{breadcrumbProps:{crumbOverrides:[{label:"Service Transfers",position:2}],labelOptions:{noCap:!0},pathname:location.pathname},title:"Make a Service Transfer"}),n?t.jsx(ae,{text:q(n)[0].reason,variant:"error"}):null,t.jsxs(se,{container:!0,direction:"row",spacing:3,wrap:"wrap",children:[t.jsxs(j,{lg:9,md:8,xs:12,children:[t.jsx(Le,{}),t.jsx(me,{handleRemove:s("linodes"),handleSelect:o("linodes"),handleToggle:m("linodes"),selectedLinodes:d.linodes})]}),t.jsx(oe,{lg:3,md:4,xs:12,children:t.jsx(Re,{handleSubmit:l=>y(l,r),isCreating:c,removeEntities:s,selectedEntities:d})})]})]})};export{Ve as EntityTransfersCreate};
