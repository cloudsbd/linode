import{ao as W,bp as K,j as e,j7 as de,V as ce,aq as me,r as y,b1 as ue,B as C,T as b,aW as S,ba as Y,G as h,s as T,ad as pe,C as J,er as fe,dr as xe,mx as ge,co as _,my as he,a8 as X,a9 as Z,q as be,J as z,an as je,a4 as q,mz as ye,E as ve,c as we,aa as Te,b as De}from"./index-Eksrs3uK.js";import{T as ee,a as j,b as Ie,c as Le}from"./TableRow-phXfWUGW.js";import{T as Se}from"./TableRowEmpty-aXmC67-Z.js";import{T as Ce}from"./TableRowError-8gKmGX7P.js";import{T as Be}from"./TableRowLoading-iP7zIRHG.js";import{R as Re}from"./RemoveDeviceDialog-748tKgS_.js";import{u as Pe}from"./firewalls-zJDfBkPC.js";import{S as ke}from"./StatusIcon-RuV8PvAV.js";import{n as Ge,g as Oe,a as Ue}from"./FirewallRow-Z-AJ-hg4.js";import{I as Ae}from"./InlineMenuAction-d5mRENST.js";import{c as _e}from"./shared-QcuPM2Px.js";import{T as Me}from"./TableHead-Si_pzkLK.js";import{L as Ne}from"./LinodeIPAddresses-BzUB11OC.js";import{g as $e}from"./linodes--kIa80QO.js";import{L as Ee}from"./LinodePermissionsError-htxzmi5m.js";import{u as Fe}from"./useAPIRequest-UcK5fafY.js";import{a as H,b as ze}from"./linodes-orSDvVk7.js";import{S as qe}from"./pending-Ji4jJt0E.js";import{A as He}from"./AreaChart-dNVOmZtQ.js";import{L as Qe}from"./LineGraph-UgU3EQj3.js";import{g as Ve,c as We,f as Ke}from"./utilities-JekaXHyt.js";import{a as Ye,c as Je,S as Q,b as Xe}from"./stats-RaLCUvLc.js";import"./Skeleton-iwmO4Yae.js";import"./ActionMenu-4CPisA_2.js";import"./AddNewLink-LwviGK8c.js";import"./OrderBy-H-bWJCPy.js";import"./splitAt-pbTnq2Oi.js";import"./TableSortCell-hcsagFzN.js";import"./configs-3PoBJaCX.js";import"./vpcs-qp5yIH1u.js";import"./Drawer-A9yKjC3Z.js";import"./Radio-HudVgwMW.js";import"./RadioGroup-zpRjMzXK.js";import"./formik.esm-Kap5lsIh.js";import"./ipaddr-jlottelM.js";import"./CopyTooltip-mIyzAQ7E.js";import"./index-Y5esPPk-.js";import"./PublicIpsUnassignedTooltip-A07mEsGp.js";import"./remove-KHZAQMPH.js";import"./uniq-xa8_MmzW.js";import"./_contains-91K6xqrF.js";import"./_isFunction-X3ooR5X_.js";import"./over-27tc0FF7.js";import"./assocPath-nNkv7F8U.js";import"./set-2Chj4B2I.js";import"./view-I-40yLKJ.js";import"./immer.esm--MpJ8fpr.js";import"./toInteger-N3RsDDMF.js";import"./visuallyHidden-DVicuktI.js";const Ze=n=>{const{firewallID:t,onUnassign:o}=n,{data:a}=W(),{data:s}=K(),r=_e(t,a,s)?{}:{disabled:!0,tooltip:Ge},l={onClick:()=>{o()},title:"Unassign",...r};return e.jsx(Ae,{actionText:l.title,"data-qa-linode-firewalls-action-menu":!0,disabled:l.disabled,onClick:l.onClick},l.title)},et=n=>{const{firewall:t,linodeID:o,onClickUnassign:a}=n,{id:s,label:i,rules:r,status:l}=t,{data:d}=de(s),m=d==null?void 0:d.find(c=>c.entity.type==="linode"&&c.entity.id===o),u=Oe(r);return e.jsxs(ee,{ariaLabel:`Firewall ${i}`,"data-qa-linode-firewall-row":!0,children:[e.jsx(j,{"data-qa-firewall-label":!0,children:e.jsx(ce,{tabIndex:0,to:`/firewalls/${s}`,children:i})}),e.jsxs(j,{"data-qa-firewall-status":!0,statusCell:!0,children:[e.jsx(ke,{status:l==="enabled"?"active":"inactive"}),me(l)]}),e.jsx(j,{"data-qa-firewall-rules":!0,children:Ue(u)}),e.jsx(j,{actionCell:!0,children:e.jsx(Ze,{firewallID:s,onUnassign:()=>a(m,t)})})]},`firewall-${s}`)},tt=n=>{const{linodeID:t}=n,{data:o,error:a,isLoading:s}=Pe(t),i=o==null?void 0:o.data,[r,l]=y.useState(),[d,m]=y.useState(),[u,c]=y.useState(!1),g=(x,f)=>{m(x),l(f),c(!0)},v=()=>{var x;return s?e.jsx(Be,{columns:4,rows:1}):a?e.jsx(Ce,{colSpan:5,message:(x=a==null?void 0:a[0])==null?void 0:x.reason}):(i==null?void 0:i.length)===0||i===void 0?e.jsx(Se,{colSpan:5,message:"No Firewalls are assigned."}):i.map(f=>e.jsx(et,{firewall:f,linodeID:t,onClickUnassign:g},`firewall-${f.id}`))};return e.jsxs(ue,{sx:{marginTop:"20px"},children:[e.jsx(C,{bgcolor:x=>x.color.white,display:"flex",children:e.jsx(b,{sx:x=>({lineHeight:"1.5rem",marginBottom:x.spacing(),marginLeft:"15px",marginTop:x.spacing()}),"data-testid":"linode-firewalls-table-header",variant:"h3",children:"Firewalls"})}),e.jsxs(Ie,{children:[e.jsx(Me,{children:e.jsxs(ee,{children:[e.jsx(j,{children:"Firewall"}),e.jsx(j,{children:"Status"}),e.jsx(j,{children:"Rules"}),e.jsx(j,{})]})}),e.jsx(Le,{children:v()})]}),e.jsx(Re,{device:d,firewallId:(r==null?void 0:r.id)??-1,firewallLabel:(r==null?void 0:r.label)??"",onClose:()=>c(!1),onService:!0,open:u})]})},nt=y.memo(n=>{var d,m;const{region:t}=n,o=S(),s=(Y().data??[]).find(u=>u.id===t),i=((d=s==null?void 0:s.resolvers)==null?void 0:d.ipv4.split(","))??[],r=((m=s==null?void 0:s.resolvers)==null?void 0:m.ipv6.split(","))??[],l=u=>u.map(c=>e.jsx(b,{sx:{lineHeight:1.43},children:c},`ip-resolver-item-${c}`));return e.jsxs(h,{sx:{display:"grid",gridTemplateAreas:`
            'one one'
            'two three'
          `,overflowX:"auto",[o.breakpoints.down("sm")]:{flex:1,paddingLeft:0,paddingRight:0}},container:!0,children:[e.jsx(h,{sx:{gridArea:"one",paddingBottom:0,paddingTop:0},xs:12,children:e.jsx(b,{children:e.jsx("strong",{children:"DNS Resolvers"})})}),e.jsx(h,{sx:{gridArea:"two",paddingRight:o.spacing(2)},xs:"auto",children:l(i)}),e.jsx(h,{sx:{gridArea:"three",paddingLeft:o.spacing(2)},xs:"auto",children:l(r)})]})}),rt={borderRadius:5,content:'""',height:20,marginRight:10,width:20},st={alignItems:"center",display:"flex",marginTop:10},M=n=>({...st,"&  span":{flex:1,lineHeight:1.1},"&:before":{...rt,backgroundColor:n}}),ot=T(b,{label:"StyledLinodeUsage "})({...M("#1CB35C")}),at=T(b,{label:"StyledPoolUsage"})(()=>({...M("#5ad865")})),it=T(b,{label:"StyledRemainingUsage"})(({theme:n})=>({...M(n.color.grey2)})),V=(n,t)=>t>n?100-(t-n)*100/t:100,lt=n=>{const{accountQuotaInGB:t,error:o,isDynamicPricingDC:a,linodeLabel:s,linodeUsedInGB:i,loading:r,regionName:l,totalUsedInGB:d}=n,m=S(),u=V(i,t),c=V(d,t),g=Math.max(t-d,0);return o?e.jsx(pe,{text:"Network transfer information for this Linode is currently unavailable.",important:!0,spacingBottom:0,variant:"error"}):r?e.jsx(h,{container:!0,justifyContent:"center",children:e.jsx(h,{children:e.jsx(J,{mini:!0})})}):e.jsxs("div",{children:[e.jsx(fe,{max:100,rounded:!0,sx:{marginBottom:`${m.spacing(.5)}px`},value:Math.ceil(u),valueBuffer:Math.ceil(c)}),e.jsxs(e.Fragment,{children:[e.jsx(ot,{children:e.jsxs("span",{children:[s," (",i," GB - ",Math.ceil(u),"%)"]})}),e.jsx(at,{children:e.jsx("span",{children:a?`${l} Transfer Used (${d} GB - ${Math.ceil(c)}%)`:`Global Pool Used (${d} GB - ${Math.ceil(c)}%)`})}),e.jsx(it,{children:e.jsx("span",{children:a?`${l} Transfer Remaining (${g} GB)`:`Global Pool Remaining (${g} GB)`})})]})]})},dt=y.memo(n=>{var w;const{linodeId:t,linodeLabel:o,linodeRegionId:a,linodeType:s}=n,i=S(),r=Fe(()=>he(t),{billable:0,quota:0,region_transfers:[],used:0},[t]),l=Y(),{data:d}=xe(s||"",!!s),{data:m,error:u,isLoading:c}=ge(),g=(w=l.data)==null?void 0:w.find(k=>k.id===a),v=H({networkTransferData:r.data,regionId:a}),x=_(v.used,{unit:"GB"}).value,f=H({networkTransferData:m,regionId:a}),B=f.used,R=f.quota,D=!!(r.error||u),P=r.loading||c,I=ze(a,d);return e.jsxs("div",{children:[e.jsxs(b,{marginBottom:i.spacing(),children:[e.jsx("strong",{children:"Monthly Network Transfer"})," "]}),e.jsx(lt,{accountBillableInGB:(m==null?void 0:m.billable)||0,accountQuotaInGB:R,error:D,isDynamicPricingDC:I,linodeLabel:o,linodeUsedInGB:x,loading:P,regionName:(g==null?void 0:g.label)||"",totalUsedInGB:B})]})});var N={},ct=Z;Object.defineProperty(N,"__esModule",{value:!0});var te=N.default=void 0,mt=ct(X()),ut=e,pt=(0,mt.default)((0,ut.jsx)("path",{d:"M11.67 3.87 9.9 2.1 0 12l9.9 9.9 1.77-1.77L3.54 12z"}),"ArrowBackIos");te=N.default=pt;var $={},ft=Z;Object.defineProperty($,"__esModule",{value:!0});var ne=$.default=void 0,xt=ft(X()),gt=e,ht=(0,xt.default)((0,gt.jsx)("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"}),"ArrowForwardIos");ne=$.default=ht;const bt=y.memo(n=>{const{linodeCreated:t,linodeID:o}=n,a=S(),s=be(),{data:i}=W(),[r,l]=y.useState(0),d=z.utc(),{humanizedDate:m,month:u,year:c}=A(r,d),{data:g,error:v,isLoading:x}=Ye(o,c,u,!0,t),{data:f}=Je(o,c,u,r<0),B=_((f==null?void 0:f.bytes_in)??0),R=_((f==null?void 0:f.bytes_out)??0),D=g?yt(g):[],P=D.reduce((p,L)=>(L[1]>p&&(p=L[1]),p),0),I=Ve(P),w=p=>We(p,I),k=p=>Ke(p/8),E=vt(d,z.fromISO(t,{zone:"utc"})),F=0,re=()=>l(p=>Math.max(p-1,E)),se=A(r-1,d).longHumanizedDate,oe=()=>l(p=>Math.min(p+1,F)),ae=A(r+1,d).longHumanizedDate,ie=r<0,G=v?je(v,"Unable to load stats.")[0].reason:null,O=`Network Transfer History Graph for ${m}`,le=()=>{if(x)return e.jsx(jt,{children:e.jsx(J,{mini:!0})});if(G){const p=[Xe,Q].includes(G);return e.jsx(ve,{errorText:p?Q:G,CustomIcon:p?qe:void 0,compact:!0})}if(s!=null&&s.recharts){const p=D.reduce((L,U)=>(L.push({"Public Outbound Traffic":w?w(U[1]):U[1],t:U[0]}),L),[]);return e.jsx(C,{marginLeft:-5,children:e.jsx(He,{areas:[{color:"#1CB35C",dataKey:"Public Outbound Traffic"}],xAxis:{tickFormat:"LLL dd",tickGap:15},"aria-label":O,data:p,height:190,timezone:(i==null?void 0:i.timezone)??"UTC",unit:I})})}return e.jsx(Qe,{data:[{backgroundColor:"#1CB35C",borderColor:"transparent",data:D,label:"Public Outbound Traffic"}],accessibleDataTable:{unit:"Kb/s"},ariaLabel:O,chartHeight:190,formatData:w,formatTooltip:k,showToday:!0,tabIndex:-1,timezone:(i==null?void 0:i.timezone)??"UTC",unit:"/s"})};return e.jsxs("div",{"aria-label":O,role:"graphics-document",tabIndex:0,children:[e.jsxs(C,{alignItems:"center",borderBottom:`1px solid ${a.color.grey6}`,display:"flex",flexDirection:"row",justifyContent:"space-between",marginBottom:"8px",paddingBottom:"6px",children:[e.jsx(b,{children:e.jsxs("strong",{children:["Network Transfer History (",I,"/s)"]})}),ie&&f?e.jsxs(b,{children:[B.formatted," In/",R.formatted," Out"]}):null,e.jsxs(C,{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"space-between",children:[e.jsx(q,{"aria-label":`Show Network Transfer History for ${se}`,color:"primary",disableRipple:!0,disabled:r===E,onClick:re,sx:{padding:0},children:e.jsx(te,{sx:{fontSize:"1rem"}})}),e.jsx("span",{style:{minWidth:80,textAlign:"center"},children:e.jsx(b,{children:m})}),e.jsx(q,{"aria-label":`Show Network Transfer History for ${ae}`,color:"primary",disableRipple:!0,disabled:r===F,onClick:oe,sx:{padding:0},children:e.jsx(ne,{sx:{fontSize:"1rem"}})})]})]}),le()]})}),jt=T("div",{label:"StyledDiv"})({alignItems:"center",display:"flex",height:100,justifyContent:"center"}),yt=n=>{const t=n.data.netv4.out,o=n.data.netv6.out,a=[];return t.forEach((s,i)=>{var u,c;const[r,l]=s,d=((u=o[i])==null?void 0:u[0])??0,m=((c=o[i])==null?void 0:c[1])??0;r===d&&a.push([r,l+m])}),a},A=(n,t)=>{const o=t.plus({months:n}),a=String(o.year),s=String(o.month).padStart(2,"0"),i=n===0?"Last 30 Days":o.toFormat("LLL y"),r=n===0?"Last 30 Days":o.toFormat("LLLL y");return{humanizedDate:i,longHumanizedDate:r,month:s,year:a}},vt=(n,t)=>{const a=ye.fromDateTimes(t,n).count("month")-1;return a===0?0:-a},wt=y.memo(n=>{const{data:t}=we(n.linodeId),o=S(),{data:a}=K(),s=$e(a,n.linodeId)==="read_only";return t?e.jsxs(e.Fragment,{children:[s&&e.jsx(Ee,{}),e.jsx(Dt,{children:e.jsxs(h,{container:!0,spacing:4,sx:{flexGrow:1},children:[e.jsx(h,{md:2.5,sm:6,xs:12,children:e.jsx(dt,{linodeId:t.id,linodeLabel:t.label,linodeRegionId:t.region,linodeType:t.type})}),e.jsx(h,{sx:{[o.breakpoints.down("md")]:{order:3}},md:!0,sm:!0,xs:12,children:e.jsx(bt,{linodeCreated:t.created,linodeID:t.id})}),e.jsx(Tt,{sx:{paddingBottom:0},md:3.5,sm:6,xs:12,children:e.jsx(nt,{region:t.region})})]})})]}):null}),Tt=T(h,{label:"StyledDnsResolverGrid"})(({theme:n})=>({display:"flex",[n.breakpoints.down("md")]:{order:2},[n.breakpoints.down("sm")]:{justifyContent:"flex-start"}})),Dt=T(Te,{label:"StyledPaper"})(({theme:n})=>({display:"flex",flexFlow:"row nowrap",justifyContent:"space-between",padding:n.spacing(3),paddingBottom:n.spacing(2.5),[n.breakpoints.down("sm")]:{flexDirection:"column"}})),vn=()=>{const{linodeId:n}=De(),t=Number(n);return e.jsxs(e.Fragment,{children:[e.jsx(wt,{linodeId:t}),e.jsx(tt,{linodeID:t}),e.jsx(Ne,{linodeID:t})]})};export{vn as LinodeStorage,vn as default};
